
================
DOM DEBUG OUTPUT
================

PAR Elektronische Gesundheitskarte und Telematikinfrastruktur
PAR Spezifikation Fachmodul ePA


TABLE(rows=6,cols=0+0)->
TR-> TD(0,0/1/1)->PAR Version TD(0,1/1/1)->PAR 1.2.0
TR-> TD(1,0/1/1)->PAR Revision TD(1,1/1/1)->PAR 548770
TR-> TD(2,0/1/1)->PAR Stand TD(2,1/1/1)->PAR 28.06.2019
TR-> TD(3,0/1/1)->PAR Status TD(3,1/1/1)->PAR freigegeben
TR-> TD(4,0/1/1)->PAR Klassifizierung TD(4,1/1/1)->PAR öffentlich
TR-> TD(5,0/1/1)->PAR Referenzierung TD(5,1/1/1)->PAR gemSpec_FM_ePA



METADATA: 
  Version: 1.2.0
  Revision: 548770
  Stand: 28.06.2019
  Status: freigegeben
  Klassifizierung: öffentlich
  Referenzierung: gemSpec_FM_ePA

PAR -HEADING(ids=Dokumentinformationen)Dokumentinformationen
PAR Änderungen zur Vorversion
PAR Anpassungen des vorliegenden Dokumentes im Vergleich zur Vorversion können Sie der nachfolgenden Tabelle entnehmen.
PAR Dokumentenhistorie

TABLE(rows=5,cols=58+82+63+392+98)->
TR-> TH(0,0/1/1)->PAR Version TH(0,1/1/1)->PAR Stand TH(0,2/1/1)->PAR Kap./ Seite TH(0,3/1/1)->PAR Grund der Änderung, besondere Hinweise TH(0,4/1/1)->PAR Bearbeitung
TR-> TD(1,0/1/1)->PAR 1.0.0 TD(1,1/1/1)->PAR 18.12.18 TD(1,2/1/1)-> TD(1,3/1/1)->PAR freigegeben TD(1,4/1/1)->PAR gematik
TR-> TD(2,0/1/1)->PAR 1.1.0 TD(2,1/1/1)->PAR 15.05.19 TD(2,2/1/1)-> TD(2,3/1/1)->PAR Einarbeitung P18.1 TD(2,4/1/1)->PAR gematik
TR-> TD(3,0/1/1)-> TD(3,1/1/1)-> TD(3,2/1/1)-> TD(3,3/1/1)->PAR Einarbeitung P19.1 TD(3,4/1/1)->PAR gematik
TR-> TD(4,0/1/1)->PAR 1.2.0 TD(4,1/1/1)->PAR 28.06.19 TD(4,2/1/1)-> TD(4,3/1/1)->PAR freigegeben TD(4,4/1/1)->PAR gematik
PAR -HEADING(ids=Inhaltsverzeichnis)Inhaltsverzeichnis

<PLACEHOLDER>

PAR -HEADING(ids=1)1 Einordnung des Dokumentes
PAR -HEADING(ids=1.1)1.1 Zielsetzung
PAR Das Fachmodul ePA ist Teil der Fachanwendung ePA, die im Systemkonzept [gemSysL_ePA] beschrieben wird. Als Teil des Konnektors kommt das Fachmodul ePA in der Leistungserbringerumgebung zum Einsatz und ist damit Bestandteil der dezentralen TI. Es bietet Primärsystemen Schnittstellen an, um medizinische Dokumente für Versicherte in einem ePA-Aktensystem zu verwalten.
PAR Die vom Fachmodul ePA bereitzustellenden Schnittstellen basieren zu großen Teilen auf den Spezifikationen der IHE-Initiative. Insbesondere kommen IHE-Integrationsprofile aus der Familie XDS.b (Cross-Enterprise Document Sharing) zum Einsatz. Neben den Primärsystemen kommuniziert das Fachmodul ePA auch mit ePA-Aktensystemen, welche die Dokumente der Versicherten verwalteten. ePA-Aktensysteme können von mehreren Anbietern zur Verfügung gestellt werden, wobei die Dokumente eines einzelnen Versicherten immer genau bei einem Anbieter ePA-Aktensystem hinterlegt werden.
PAR Diese Spezifikation beschreibt Anforderungen an die Schnittstellen, die vom Fachmodul ePA selbst angeboten werden müssen und an die daraus resultierende Funktionalität. Dazu nutzt das Fachmodul ePA die Schnittstellen des ePA-Aktensystems und weiterer zentraler TI-Komponenten.
PAR -HEADING(ids=1.2)1.2 Zielgruppe
PAR Das Dokument richtet sich an Hersteller des Produkttyps Konnektor sowie Hersteller und Anbieter von Produkttypen, die hierzu eine Schnittstelle besitzen.
PAR -HEADING(ids=1.3)1.3 Geltungsbereich
PAR Dieses Dokument enthält normative Festlegungen zur Telematikinfrastruktur des deutschen Gesundheitswesens. Der Gültigkeitszeitraum der vorliegenden Version und deren Anwendung in Zulassungs- oder Abnahmeverfahren wird durch die gematik GmbH in gesonderten Dokumenten (z. B. Dokumentenlandkarte, Produkttypsteckbrief, Leistungsbeschreibung) festgelegt und bekannt gegeben.
PAR Schutzrechts-/Patentrechtshinweis
PAR Die nachfolgende Spezifikation ist von der gematik allein unter technischen Gesichtspunkten erstellt worden. Im Einzelfall kann nicht ausgeschlossen werden, dass die Implementierung der Spezifikation in technische Schutzrechte Dritter eingreift. Es ist allein Sache des Anbieters oder Herstellers, durch geeignete Maßnahmen dafür Sorge zu tragen, dass von ihm aufgrund der Spezifikation angebotene Produkte und/oder Leistungen nicht gegen Schutzrechte Dritter verstoßen und sich ggf. die erforderlichen Erlaubnisse/Lizenzen von den betroffenen Schutzrechtsinhabern einzuholen. Die gematik GmbH übernimmt insofern keinerlei Gewährleistungen.
PAR -HEADING(ids=1.4)1.4 Abgrenzungen
PAR Spezifiziert werden in dem Dokument die von dem Fachmodul ePA bereitgestellten Schnittstellen. Benutzte Schnittstellen werden hingegen in der Spezifikation desjenigen Produkttypen beschrieben, der diese Schnittstelle bereitstellt. Auf die entsprechenden Dokumente wird referenziert (siehe auch Anhang 8.5).
PAR Die vollständige Anforderungslage für den Konnektor ergibt sich aus weiteren Spezifikationsdokumenten, die im Produkttypsteckbrief verzeichnet sind.
PAR -HEADING(ids=1.5)1.5 Methodik
PAR Anforderungen als Ausdruck normativer Festlegungen werden durch eine eindeutige ID sowie die dem RFC 2119 [RFC2119] entsprechenden, in Großbuchstaben geschriebenen deutschen Schlüsselworte MUSS, DARF NICHT, SOLL, SOLL NICHT, KANN gekennzeichnet.
PAR Da in dem Beispielsatz „Eine leere Liste DARF NICHT ein Element besitzen.“ die Phrase „DARF NICHT“ semantisch irreführend wäre (wenn nicht ein, dann vielleicht zwei?), wird in diesem Dokument stattdessen „Eine leere Liste DARF KEIN Element besitzen.“ verwendet. Die Schlüsselworte werden außerdem um Pronomen in Großbuchstaben ergänzt, wenn dies den Sprachfluss verbessert oder die Semantik verdeutlicht.
PAR Anforderungen werden im Dokument wie folgt dargestellt:<br><AFO-ID> - <Titel der Afo><br>Text / Beschreibung<br>[<=]
PAR Dabei umfasst die Anforderung sämtliche zwischen Afo-ID und Textmarke [<=]  angeführten Inhalte.
PAR -HEADING(ids=2)2 Systemüberblick
PAR Die Fachanwendung ePA setzt im Rahmen der TI-Plattform eine elektronische Patientenakte (ePA), ein Aktenkonto des Versicherten um, in die Berechtigte wie der Versicherte oder autorisierte Leistungserbringer patientenbezogene Dokumentation aus verschiedenen Einrichtungen einstellen und verwalten können. Die Fachanwendung erlaubt das Einstellen, Suchen, Abrufen und Löschen von Dokumenten sowie die Aktualisierung von Metadaten bestehender Dokumente.
PAR Die Fachanwendung ePA besteht aus Sicht dieser Spezifikation aus zwei Teilen: Einerseits dem dezentralen Fachmodul, das Teil des Konnektors ist und nach außen eine Schnittstelle für die Verwaltung der Dokumente bietet und anderseits dem zentralen Fachdienst ePA-Aktensystem, der die Dokumente innerhalb der TI-Plattform speichert, Berechtigungen verwaltet und durchsetzt usw. und den beiden Schlüsselgenerierungsdiensten (SGD). Das außerdem zur Fachanwendung gehörende „ePA-Modul Frontend des Versicherten“ ist für dieses Dokument nicht relevant und wird deshalb nicht weiter behandelt.
PAR Diese Spezifikation beschreibt das Fachmodul ePA und dessen Außenschnittstelle, die von Primärsystemen (z. B. KIS und PVS) genutzt wird, um Dokumente zu verwalten. Um beim Leistungserbringer „ad hoc“ Zugriffsberechtigungen zu Dokumenten vom Patienten einzuholen, findet zudem bei Bedarf eine Kommunikation mit dem Kartenterminal statt. Zusätzlich beschreibt diese Spezifikation die Nutzung der Schnittstelle des ePA-Aktensystems, welches die eigentliche Dokumentenverwaltung, Autorisierung und weitere Details umsetzt.
PAR Ein ePA-Aktensystem kann durch mehr als einen Anbieter angeboten werden. Die Akte des Versicherten wird zu einem Zeitpunkt jedoch immer nur exklusiv von einem einzigen Anbieter ePA-Aktensystem geführt, der alle Dokumente des Versicherten verwaltet und über das ePA-Aktensystem bereitstellt.
PAR Über das ePA-Aktensystem hinaus interagiert das Fachmodul ePA unter Verwendung der Basisdienste des Konnektors mit dem Verzeichnisdienst der TI-Plattform, um Details zu Leistungserbringern und -institutionen abzurufen sowie anderen zentralen TI-Diensten (Zeitdienst, Namensdienst).
PAR ePA-Aktensysteme speichern aus Datenschutzgründen alle Dokumente in verschlüsselter Form. Die Verschlüsselung beim Einstellen und die Entschlüsselung beim Herunterladen erfolgt immer im Fachmodul (nicht in den Primärsystemen). Um eine im ePA-Aktensystem eingehende Suchanfrage nach Dokumenten im ePA-Aktensystem trotz verschlüsselter Daten durchführen zu können, wird für jedes Dokument zusätzlich ein Satz an unverschlüsselten Metadaten gespeichert. Dazu gehören das Dokumentenformat (z. B. PDF), der Dokumententyp (z. B. Notfalldatensatz), Erstellungsdatum und -uhrzeit und der Autor des Dokuments.
PAR Für den Zugriff auf Metadaten und Dokumente muss ein Nutzer (in diesem Dokument Leistungserbringerinstitutionen) sich über das Fachmodul ePA authentisieren und vom ePA-Aktensystem autorisiert werden. Um den Zugriff des Anbieters ePA-Aktensystem auf die im Klartext vorliegenden Metadaten zu verhindern, werden diese zusätzlich über eine vertrauenswürdige Ausführungsumgebung (VAU) geschützt.
PAR -HEADING(ids=3)3 Systemkontext
PAR Das Fachmodul ePA ist eingebettet in den Produkttyp Konnektor. Die Beschreibung aller direkt mit dem Fachmodul kommunizierenden Akteure ist im vorgehenden Kapitel beschrieben. Eine weitere Beschreibung des Systemkontexts ist nicht erforderlich.
PAR -HEADING(ids=4)4 Zerlegung des Produkttyps
PAR Eine weitere Untergliederung des Fachmoduls ePA in Komponenten ist nicht erforderlich.
PAR -HEADING(ids=5)5 Technologien und Standards
PAR Die Schnittstellen und die Verarbeitungslogik der Fachmoduls basiert auf Transaktionen des IHE ITI Technical Frameworks [IHE-ITI-TF]. Es werden soweit wie möglich Cross-Community Access-Profile angewendet.
PAR Der Profilierung von IHE ITI-Transaktionen als Umsetzungsvorgabe für die Außenschnittstellen der Dokumentenverwaltung des ePA-Aktensystems liegt die folgende Herangehensweise zugrunde:

ORDERED-LIST->
LITEM->PAR Auswahl relevanter IHE ITI-IntegrationsprofileLITEM->PAR Logische Gruppierung zwischen IHE ITI-Akteuren mit Auswahl relevanter IHE ITI-Transaktionen.LITEM->PAR Übergreifende Einschränkung von IHE ITI-TransaktionenLITEM->PAR Festlegung spezieller Umsetzungsvorgaben bzgl. einzelner Transaktionen
PAR -HEADING(ids=5.1)5.1 Webservices
REQ(ids=A_15575)<b>A_15575 - FM ePA: Übergreifende Anforderung - SOAP für Webservices</b>
PAR Das Fachmodul ePA MUSS für die Webservices PHRService und PHRManagementService den Standard [SOAP1.2] verwenden.
PAR <b>[<=]</b>

PAR -HEADING(ids=5.2)5.2 Integrating the Healthcare Enterprise (IHE)
PAR -HEADING(ids=5.2.1)5.2.1 Relevante IHE-Integrationsprofile
PAR Für die Umsetzung des Fachmoduls sind die folgenden Integrationsprofile relevant:

LIST->
LITEM->PAR Cross-Enterprise Document Sharing (XDS.b) ProfileLITEM->PAR Cross-Community Access (XCA) ProfileLITEM->PAR Cross-Community Document Reliable Interchange  (XCDR) ProfileLITEM->PAR Cross-Enterprise Document Reliable Interchange (XDR) ProfileLITEM->PAR Remove Metadata and Documents (RMD) ProfileLITEM->PAR Restricted Metadata Update (RMU) ProfileLITEM->PAR Cross-Enterprise User Assertion (XUA) ProfileLITEM->PAR Advanced Patient Privacy Consents (APPC) Profile
PAR Ihre Verwendung im Fachmodul wird im Folgenden kurz erläutert:
PAR XDS.b (Cross-Enterprise Document Sharing) Profile
PAR XDS.b [IHE-ITI-TF], im Weiteren nur als XDS bezeichnet, stellt die Grundlage für die Umsetzung von IHE-Patientenakten dar. Die mit dem Fachmodul verbundenen Primärsysteme bei den Leistungserbringern operieren als Akteure Document Source und Document Consumer, während das ePA-Aktensystem die Akteure Document Repository und Document Registry bereitstellt.
PAR Das Fachmodul ePA selbst muss zwischen Primärsystem und ePA-Aktensystem vermitteln, also die XDS-basierten Primärsystemnachrichten entgegennehmen, verarbeiten und an das ePA-Aktensystem weiterleiten; das Fachmodul ePA übernimmt also eine Art Proxyfunktionalität, nimmt die Anfragen von Primärsystemen (Document Source/Consumer) entgegen und leitet sie an den Anbieter ePA-Aktensystem mit der Akte des Patienten bzw. dessen Document Repository und Registry weiter. Aus diesem Grund wird auch eine Spezialisierung des XDS-Profils verwendet: XCA (siehe unten).
PAR XCA (Cross-Community Access) Profile
PAR XCA [IHE-ITI-TF] wird im engeren Sinne bei IHE dafür verwendet, um verschiedene „Home Communities“ miteinander zu vernetzen. Das Profil nimmt dazu geringe Änderungen an den bei XDS.b vorgesehenen Nachrichten und Akteuren zum Suchen und Herunterladen von Dokumenten vor.
PAR Im Fachmodul ePA kommt es zum Einsatz, da XCA (zusammen mit dem XCDR-Profil, siehe unten) am besten die Proxy-artige Funktionalität des Fachmoduls darstellt, das zwischen Primärsystem und ePA-Aktensystem vermittelt und es ermöglicht, die unterschiedlichen Anbieter ePA-Aktensystem jeweils als eigene Home Community zu modellieren. Das Fachmodul ePA tritt dabei als IHE-Akteur „Initiating Gateway“ auf.
PAR XCDR (Cross-Community Document Reliable Interchange) Profile
PAR XCDR [IHE-ITI-XCDR] wird für das Einstellen von Dokumenten verwendet, wenn der XCA-Ansatz (siehe oben) Anwendung findet und spezialisiert vor diesem Hintergrund die in XDS dafür vorgesehene Akteure und Transaktionen. Das Fachmodul ePA arbeitet auch hier als IHE-Akteur „Initiating Gateway“, der Anbieter ePA-Aktensystem als „Responding Gateway".
PAR XDR (Cross-Enterprise Document Reliable Interchange) Profile
PAR Die Verwendung des Profils XCDR erzwingt auch den gleichzeitigen Gebrauch des Profils XDR, welches leicht veränderte Anforderungen beim Einstellen von Dokumenten (bezüglich Metadaten) mit sich bringt.
PAR RMD (Remove Metadata and Documents) Profile
PAR Gemäß [gemSysL_ePA] muss die Akte auch das Löschen von Dokumenten ermöglichen. Da dies über die Möglichkeiten der oben genannten Integrationsprofile hinausgeht, greift die Fachanwendung zusätzlich auf das Profil RMD [IHE-ITI-RMD] zurück. Das Fachmodul ePA (als IHE-Akteur „Document Repository“) empfängt und verarbeitet dazu die entsprechenden Nachrichten des Primärsystems und leitet diese (als IHE-Akteur Document Administrator) an das ePA-Aktensystem weiter.
PAR Restricted Metadata Update (RMU) Profile
PAR ePA unterstützt keine Versionierung von Dokumenten. Müssen ein Dokument oder seine Metadaten geändert werden, muss es gelöscht (RMD-Profil, s.o.) und neu eingestellt werden (XCDR-Profil, s.o.). Die einzige Ausnahme dieser Regel wird genutzt, um den Status eines Dokuments von einem reinen „Versichertendokument" auf ein „leistungserbringeräquivalentes Dokument" zu ändern, ohne das Dokument neu einstellen zu müssen.
PAR XUA (Cross-Enterprise User Assertion) Profile
PAR Das XUA-Profil [IHE-ITI-TF] wird vom Fachmodul verwendet, um sich einerseits bei der Komponente Autorisierung des Anbieters ePA-Aktensystem und andererseits beim Zugriff auf die Akte eines Versicherten bei der Dokumentenverwaltung mit Authentifizierungsinformationen des anfragenden Nutzers auszuweisen.
PAR APPC (Advanced Patient Privacy Consents)
PAR Das APPC-Profil [IHE-ITI-APPC] dient der Durchsetzung von Zugriffsregeln (Autorisierung) in der Fachanwendung. Das Fachmodul ePA erzeugt bei Bedarf das technische Dokument (gemäß APPC) und hinterlegt es in der Akte des Versicherten. Das ePA-Aktensystem verwendet die hinterlegten Zugriffsregeln dann, um zu entscheiden, ob der anfragende Nutzer (gemäß mitgelieferter XUA-Zusicherung) die entsprechende Operation (z. B. Herunterladen eines bestimmten Dokuments) unter Berücksichtigung der Dokumentenmetadaten durchführen darf oder die Anfrage abgelehnt werden muss.
PAR -HEADING(ids=5.2.2)5.2.2 Überblick über IHE-Akteure und assoziierte Transaktionen
PAR Die Abbildung in Abschnitt [gemSpec_DM_ePA#2.1.3] zeigt, welche IHE ITI-Akteure insgesamt in der Fachanwendung ePA wie gruppiert sind und welche zugehörigen Transaktionen angewendet werden.
PAR Die folgenden Schilderungen beschreiben beispielhaft die drei häufigsten Anwendungsfälle, das Einstellen, Suchen und Herunterladen von Dokumenten aus Sicht des Fachmoduls ePA.
PAR Gemäß der Nutzung von Cross-Community-Profilen, ist die IHE-basierte Nachrichtenübermittlung durch Transaktionen gekennzeichnet, um ein Dokument durch den Mitarbeiter einer Leistungserbringerinstitution in die elektronische Patientenakte eines Versicherten zu speichern. Ein Primärsystem in der Consumer Zone erzeugt ein Dokument, das vom System als XDR-Akteur „Document Source" in die Akte eines Versicherten gespeichert werden soll. Beim Einstellen kommen anschließend die folgenden IHE ITI-Transaktionen zum Tragen:

ORDERED-LIST->
LITEM->PAR Provide & Register Document Set-b [ITI-41]: Das Primärsystem bzw. der XDR-Akteur „Document Source" sendet eine Nachricht zum Speichern ein oder mehrerer Dokumente an den XDR-Akteur „Document Recipient" bzw. den gruppierten XCDR-Akteur „Initiating Gateway", welcher durch das Fachmodul ePA umgesetzt wird.LITEM->PAR Cross-Gateway Document Provide [ITI-80]: das Fachmodul ePA nimmt einige Transformationen an der Nachricht vor (z. B. Verschlüsselung des Dokuments) und leitet sie als XCDR „Initiating Gateway" an das XCDR „Responding Gateway" des Anbieters ePA-Aktensystem weiter.LITEM->PAR Es erfolgt das akteninterne Registrieren und Speichern der Dokumente. Die Umsetzungsdetails werden zu großen Teilen den Anbietern ePA-Aktensystem überlassen.
PAR Für das Suchen von Dokumenten werden die folgenden IHE-Transaktionen eingesetzt:

ORDERED-LIST->
LITEM->PAR Registry Stored Query [ITI-18]: Das Primärsystem bzw. der XDS-Akteur „Document Consumer" sucht Dokumente anhand gewünschter Suchkriterien, in dem es eine entsprechende Nachricht an den XCA-Akteur „Initiating Gateway" sendet, der vom Fachmodul repräsentiert wird.LITEM->PAR Cross-Gateway Query [ITI-38]: das Fachmodul ePA bzw. der XCA-Akteur „Initiating Gateway" leitet die Suchanfrage an den Anbieter ePA-Aktensystem weiter, der den XCA-Akteur „Responding Gateway" umsetzt.LITEM->PAR Die Suche innerhalb der Akte wird vom Anbieter ePA-Aktensystem durchgeführt und Suchergebnisse über „Responding Gateway" und „Initiating Gateway" an das Primärsystem zurückgeliefert.
PAR Das Herunterladen von Dokumenten wird über die folgenden Transaktionen umgesetzt:

ORDERED-LIST->
LITEM->PAR Retrieve Document Set [ITI-43]: Das Primärsystem stößt als XDS-Akteur „Document Consumer" den Download eines oder mehrerer Dokumente an.LITEM->PAR Cross-Gateway Retrieve [ITI-39]: das Fachmodul ePA als XCA-Akteur „Initiating Gateway" nimmt die Anfrage entgegen und leitet sie an den Anbieter ePA-Aktensystem (XCA-Akteur „Responding Gateway") weiter.LITEM->PAR Die angefragten Dokumente werden vom Anbieter ePA-Aktensystem über XCA „Responding Gateway" und „Initiating Gateway" an das Primärsystem zurückgeliefert.
PAR Das Fachmodul ePA muss alle Anfragen an denjenigen Anbieter ePA-Aktensystem weiterleiten, der die Akte für den jeweiligen Versicherten führt. Dazu nutzt es die vom Primärsystem bei jeder Anfrage mit bereitgestellte HomeCommunityID, die den Anbieter ePA-Aktensystem eindeutig identifiziert. Um die HomeCommunityID verlässlich verwenden zu können, geht die Fachmodulspezifikation an einigen Stellen über die Anforderungen von IHE hinaus (z.B. Ermittlung der HomeCommunityID über den Namensdienst der TI).
PAR -HEADING(ids=6)6 Übergreifende Festlegungen
PAR -HEADING(ids=6.1)6.1 Allgemein
PAR Die folgenden Anforderungen gelten für das gesamte Fachmodul. Im Gegensatz dazu gibt es auf der Ebene der Webservices Festlegungen, die dann jeweils nur für dessen Operationen greifen.
PAR Übergreifende Festlegung für die Kommunikation mit ePA-Aktensystemen
REQ(ids=A_14400)<b>A_14400 - FM ePA: Übergreifende Anforderung - Server nicht erreichbar - Fehler</b>
PAR Falls jeweils alle zur Durchführung einer Operation benötigten Komponenten und Diensten

LIST->
LITEM->PAR Zugangsgateway des Versicherten oderLITEM->PAR Autorisierung,LITEM->PAR Dokumentenverwaltung,<br>SGD 1 und<br>SGD 2
PAR für die Zeitdauer von EPA_SERVER_TIMEOUT nicht erreichbar sind, MUSS das Fachmodul ePA die Operation mit den Code 7220 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

PAR Eine Operation, die nur mit einem ePA-Aktensystem kommunizieren muss, bricht demnach ab, falls eine der genannten Komponenten zwingend benötigt wird und nicht zur Verfügung steht. Eine Operation, die mit mehreren ePA-Aktensystemen kommunizieren muss, bricht erst ab wenn eine der Komponenten zwingend benötigt wird und in allen ePA-Aktensystemen nicht zur Verfügung steht. Sonderfälle, falls z.B. ein ePA-Aktensystem komplett ausfällt, werden in den Operationen unterschiedlich behandelt (vgl. auch Kapitel 6.11).
REQ(ids=A_15647)<b>A_15647 - FM ePA: Übergreifende Anforderung - Konfigurationsparameter des Fachmoduls ePA</b>
PAR Das Fachmodul ePA MUSS es einem Administrator ermöglichen, Konfigurationsänderungen gemäß Tabelle Tab_FM_ePA_008 vorzunehmen:
PAR (ids=Tabelle-1)Tabelle 1: Tab_FM_ePA_008 Konfigurationswerte des Fachmoduls ePA

TABLE(rows=4,cols=152+65+323)->
TR-> TH(0,0/1/1)->PAR ReferenzID TH(0,1/1/1)->PAR Belegung TH(0,2/1/1)->PAR Bedeutung und Administrator-Interaktion
TR-> TD(1,0/1/1)->PAR EPA_TLS_HS_TIMEOUT TD(1,1/1/1)->PAR X Sekunden TD(1,2/1/1)->PAR Der Administrator MUSS die Anzahl Sekunden eingeben können, die der Konnektor auf den TLS-Verbindungsaufbau zum Aktensystem wartet (Handshake-Timeout).<br><br>Wertebereich:5-30<br>Default-Wert=10
TR-> TD(2,0/1/1)->PAR EPA_KEEP_ALIVE_TRY_COUNT TD(2,1/1/1)->PAR Anzahl der Versuche TD(2,2/1/1)->PAR Anzahl von aufeinander folgenden, nicht beantworteten Keep-Alive-Nachrichten, nach denen ein Timeout der TLS-Verbindung festgestellt wird.<br><br>Wertebereich:3-10<br>Default-Wert=3
TR-> TD(3,0/1/1)->PAR EPA_SERVER_TIMEOUT TD(3,1/1/1)->PAR X Sekunden TD(3,2/1/1)->PAR Der Administrator MUSS die Anzahl Sekunden eingeben können, die der Konnektor maximal auf den TCP-Verbindungsaufbau zum Aktensystem/SGD wartet.<br><br>Wertebereich:5-30<br>Default-Wert=10
PAR <b>[<=]</b>

REQ(ids=A_15648)<b>A_15648 - FM ePA: Übergreifende Anforderung - Timeout bei TLS-Verbindungsaufbau - Fehler</b>
PAR Falls beim TLS-Verbindungsaufbau zu jeweils allen zur Durchführung einer Operation benötigten Komponenten und Diensten

LIST->
LITEM->PAR Zugangsgateway des Versicherten oderLITEM->PAR Autorisierung oderLITEM->PAR Dokumentenverwaltung oderLITEM->PAR SGD 1 oderLITEM->PAR SGD 2
PAR der Wert von EPA_TLS_HS_TIMEOUT überschritten wird, MUSS das Fachmodul ePA den TLS-Verbindungsaufbau abbrechen und die vom Primärsystem aufgerufene Operation mit dem Code 7202 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

REQ(ids=A_15649)<b>A_15649 - FM ePA: Übergreifende Anforderung - Aktensystem antwortet nicht - Fehler</b>
PAR Falls beim TLS-Verbindungsaufbau zu jeweils allen zur Durchführung einer Operation benötigten Komponenten und Diensten

LIST->
LITEM->PAR Zugangsgateway des Versicherten oderLITEM->PAR Autorisierung oderLITEM->PAR Dokumentenverwaltung oderLITEM->PAR SGD 1 oderLITEM->PAR SGD 2
PAR die Antworten nach der Anzahl von EPA_KEEP_ALIVE_TRY_COUNT Versuchen ausbleibt, MUSS das Fachmodul ePA die Netzwerkverbindungen beenden und die vom Primärsystem aufgerufene Operation mit dem Code 7220 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

REQ(ids=A_17948)<b>A_17948 - FM ePA: Authentisierung mit eGK - TLS-Verbindung - Fehler</b>
PAR Falls beim Aufbau der TLS-Verbindung zu jeweils allen zur Durchführung einer Operation benötigten Komponenten und Diensten

LIST->
LITEM->PAR Zugangsgateway des Versicherten oderLITEM->PAR Autorisierung oderLITEM->PAR Dokumentenverwaltung oderLITEM->PAR SGD 1 oderLITEM->PAR SGD 2
PAR ein Fehler auftritt, MUSS das Fachmodul ePA die Operation mit dem Code 7202 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

PAR Für Operationen, die mit genau einem Aktensystem kommunizieren, wird die Operation mit dem Fehler abgebrochen, wenn die Fehlersituation beim Zugangsgateway des Versicherten oder bei der Komponente Autorisierung oder bei der Komponente Dokumentenverwaltung auftritt.<br>Für Operationen, die mit mehr als einem Aktensystem kommunizieren, wird die Operation nur dann mit dem Fehler abgebrochen, wenn die Fehlersituation zu allen Zugangsgateways des Versicherten oder bei allen Komponenten Autorisierung oder bei allen Komponenten Dokumentenverwaltung auftritt. Treten Fehler an verschiedenen Komponenten auf, so wird im Kontext der Operation entschieden, ob mit einem Fehler (und mit welchem Code) abgebrochen wird (vgl. auch Kapitel 6.11).
PAR Status des Aktenkontos
REQ(ids=A_17744)<b>A_17744 - FM ePA: Übergreifende Anforderung - Status des Aktenkontos - Fehlerbehandlung</b>
PAR Das Fachmodul ePA MUSS in Abhängigkeit des Status des Aktenkontos und der ausgeführten Operation mit den nachfolgend zugeordneten Codes als Fehler oder Warnung abbrechen:
PAR (ids=Tabelle-2)Tabelle 2: Tab_FM_ePA_053 - Übersicht der Fehlerfälle nach Status des Status eines AktenkontosTabelle #: Tab_FM_ePA_053 - Übersicht der Fehlerfälle nach Status des Status eines Aktenkontos

TABLE(rows=13,cols=203+203+343)->
TR-> TH(0,0/1/1)->PAR Operation TH(0,1/1/1)->PAR Status des Aktenkontos TH(0,2/1/1)->PAR Abbruch oder Warnung mit Fehlercode gemäß Tab_FM_ePA_011
TR-> TD(1,0/3/1)->PAR Alle Operationen des Webservices PHRService TD(1,1/1/1)->PAR UNKNOWN TD(1,2/1/1)->PAR 7404
TR-> TD(2,1/1/1)->PAR REGISTERED_MIGRATION TD(2,2/1/1)->PAR 7403
TR-> TD(3,1/1/1)->PAR REGISTERED TD(3,2/1/1)->PAR 7403
TR-> TD(4,0/1/1)->PAR Operationen putDocuments, removeDocuments und updateDocumentSet des Webservices PHRService TD(4,1/1/1)->PAR SUSPENDED TD(4,2/1/1)->PAR 7406
TR-> TD(5,0/5/1)->PAR ActivateAccount TD(5,1/1/1)->PAR UNKNOWN TD(5,2/1/1)->PAR 7404
TR-> TD(6,1/1/1)->PAR REGISTERED_MIGRATION TD(6,2/1/1)->PAR 7403
TR-> TD(7,1/1/1)->PAR ACTIVATED TD(7,2/1/1)->PAR 7402
TR-> TD(8,1/1/1)->PAR DISMISSED TD(8,2/1/1)->PAR 7405
TR-> TD(9,1/1/1)->PAR SUSPENDED TD(9,2/1/1)->PAR 7406
TR-> TD(10,0/3/1)->PAR RequestFacilityAuthorization TD(10,1/1/1)->PAR UNKNOWN TD(10,2/1/1)->PAR 7404
TR-> TD(11,1/1/1)->PAR REGISTERED_MIGRATION TD(11,2/1/1)->PAR 7403
TR-> TD(12,1/1/1)->PAR SUSPENDED TD(12,2/1/1)->PAR 7406
PAR <b>[<=]</b>

PAR Hinweise:

LIST->
LITEM->PAR Eine Auflistung und Erläuterung aller Status befindet sich in [gemSpec_Aktensystem].LITEM->PAR Ein Aktenkonto kann nur aktiviert werden, falls es sich im Status REGISTERED befindet.LITEM->PAR Alternative Versichertenidentitäten und Berechtigungen für LEI können auch bei einem Aktenkonto hinzugefügt werden, das sich im Status DISMISSED befindet.LITEM->PAR Falls RequestFacilityAuthorization mit einem Aktenkonto aufgerufen wird, das sich im Status REGISTERED befindet, führt das Fachmodul vorher implizit die Operation ActivateAccount durch, um das Aktenkonto zu aktivieren.
PAR Da die Operationen GetHomeCommunityID und GetAuthorizationList mit mehreren ePA-Aktensystemen kommunizieren müssen, findet die Behandlung der Status in den jeweiligen Unterkapiteln statt.
PAR Der Status und die Existenz eines Aktenkontos kann mit Hilfe der Operation I_Authorization_Management::checkRecordExists der Komponente Autorisierung eines ePA-Aktensystems ermittelt werden. Für manche Operationen müssen alle bekannten ePA-Aktensysteme angefragt werden, die jeweils mit verschiedenen Fehlern antworten können. Das Fachmodul zeigt mit dem Fehlercode 7215 eindeutig ein Problem auf Seite der Aktensysteme an, Fehlercode 7400 hingegen deutet auf ein Problem im Konnektor hin, bedarf aber einer genaueren Analyse der Log-Dateien.
REQ(ids=A_17133)<b>A_17133 - FM ePA: PHRManagementService - Statusprüfung Aktenkonto - Fehler</b>
PAR Falls alle zur Durchführung einer Operation benötigten Statusprüfungen von Aktenkonten mittels I_Authorization_Management::checkRecordExists den Fehler TECHNICAL_ERROR zurückgeben, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen.<br><b>[<=]</b>

PAR Übergreifende Festlegungen für beteiligte Smartcards
REQ(ids=A_14241)<b>A_14241 - FM ePA: Übergreifende Anforderung - Unterstützte Generationen der eGK</b>
PAR Das Fachmodul ePA MUSS alle Versionen der eGK der Generationen G2 und höher unterstützen. <b>[<=]</b>

REQ(ids=A_14412)<b>A_14412 - FM ePA: Übergreifende Anforderung - Unterstützung unbekannter Generationen der eGK</b>
PAR Falls  die Version einer eGK der Generation G2 oder höher entspricht, dem Fachmodul ePA aber unbekannt ist, MUSS das Fachmodul ePA die unbekannte Version als die aktuellste ihm bekannte Version interpretieren und versuchen, die Anfrage zu bearbeiten.
PAR <b>[<=]</b>

REQ(ids=A_14221)<b>A_14221 - FM ePA: Übergreifende Anforderung - Unterstützte Generationen der eGK - Fehler</b>
PAR Falls zur Durchführung einer Operation eine eGK kleiner der Generation G2 verwendet wird, MUSS das Fachmodul ePA mit dem Code 115 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

REQ(ids=A_14414)<b>A_14414 - FM ePA: Übergreifende Anforderung - Fehlende Smartcard</b>
PAR Falls auf eine zur Durchführung einer Operation benötigte Smartcard nicht zugegriffen werden kann, MUSS das Fachmodul ePA die Operation mit dem Code 4008 gemäß Tab_FM_ePA_050 abbrechen. <b>[<=]</b>

REQ(ids=A_14759)<b>A_14759 - FM ePA: Übergreifende Anforderung - Gesperrter Ordner DF.HCA auf der eGK</b>
PAR Falls der Ordner DF.HCA einer beteiligten eGK nicht aktiv ist, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 114 gemäß Tab_FM_ePA_051 abbrechen. <b>[<=]</b>

REQ(ids=A_15137)<b>A_15137 - FM ePA: Übergreifende Anforderung - Unterbindung paralleler Zugriffe auf die eGK</b>
PAR Falls der Zugriffsversuch auf eine exklusiv verwendete eGK erfolgt, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 4093 gemäß Tab_FM_ePA_050 abbrechen.
PAR <b>[<=]</b>

REQ(ids=A_14767)<b>A_14767 - FM ePA: Übergreifende Anforderung - Gesperrtes Zertifikat auf der eGK</b>
PAR Falls das Zertifikat C.CH.AUT einer beteiligten eGK gesperrt ist, MUSS das Fachmodul ePA die aufgerufene Operationen mit dem Code 106 gemäß Tab_FM_ePA_051 abbrechen. <b>[<=]</b>

REQ(ids=A_16211)<b>A_16211 - FM ePA: Übergreifende Anforderung - Zertifikat auf der eGK nicht prüfbar</b>
PAR Falls der Sperrstatus des Zertifikats C.CH.AUT einer beteiligten eGK nicht ermittelt werden konnte, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 7213 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

REQ(ids=A_15215)<b>A_15215 - FM ePA: Übergreifende Anforderung - Prüfung von Authentizität und Echtheit der beteiligten Smartcards (C2C)</b>
PAR Falls das Fachmodul ePA zum Zugriff auf einen Bereich der eGK gemäß [gemSpec_eGK_ObjSys*] ein C2C gegen eine SM-B benötigt, so MUSS es das per gegenseitigem C2C durchführen. <b>[<=]</b>

REQ(ids=A_15216)<b>A_15216 - FM ePA: Übergreifende Anforderung - Fehlerbehandlung bei nicht erfolgreicher C2C-Prüfung</b>
PAR Falls eine C2C-Prüfung fehlschlägt, MUSS das Fachmodul ePA die Operation mit dem Code 7203 gemäß Tabelle Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR Übergreifende Festlegungen zur Verwendung von kryptographischen Verfahren
REQ(ids=A_17483)<b>A_17483 - FM ePA: Übergreifende Anforderung - Kryptographische Verfahren für Smartcards der Generation 2</b>
PAR Das Fachmodul ePA MUSS bei Smartcards der Generation 2 für alle kryptographischen Operationen RSA-basiertes Schlüsselmaterial verwenden.<br>​​
PAR <b>[<=]</b>

PAR Die Authentisierungsbestätigungen mittels einer eGK der Generation 2 wird z.B. mit C.CH.AUT.R2048 erstellt, vgl [gemSpec_Kon#TAB_KON_858].
REQ(ids=A_17484)<b>A_17484 - FM ePA: Übergreifende Anforderung - Kryptographische Verfahren für Smartcards ab Generation 2.1</b>
PAR Das Fachmodul ePA MUSS bei Smartcards ab  Generation 2.1 für alle kryptographischen Operationen ECC-basiertes Schlüsselmaterial verwenden.<br>​​
PAR <b>[<=]</b>

PAR Die Authentisierungsbestätigungen mittels einer eGK ab Generation 2.1 wird z.B. mit C.CH.AUT.E256 erstellt, vgl [gemSpec_Kon#TAB_KON_858].
PAR Übergreifende Festlegungen zur Verwendung von Schlüsseln
REQ(ids=A_16193)<b>A_16193 - FM ePA: Übergreifende Anforderung - Vorgaben Aktenschlüssel und Kontextschlüssel - Fehler</b>
PAR Falls die Vorgaben aus A_15705#1 hinsichtlich der geforderten Schlüssellänge nicht erfüllt werden, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 7214 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

PAR Übergreifende Festlegungen zur Performanz
PAR Die für das Fachmodul ePA relevanten Vorgaben zur Performanz befinden sich in dem Dokument [gemSpec_Perf#4.1.2.1].
PAR Übergreifende Festlegung zur Nutzung der Basisfunktionalität des Konnektors
REQ(ids=A_15867)<b>A_15867 - FM ePA: Übergreifende Anforderung - Verwendung der Basisfunktionalität des Konnektors zur Schlüsselerzeugung</b>
PAR Das Fachmodul ePA MUSS zur Erzeugung von Schlüsseln die Basisfunktionalität des Konnektors verwenden. <b>[<=]</b>

PAR Zur Erzeugung von Schlüsseln kann TUC_KON_072 „Daten symmetrisch verschlüsseln“ verwendet werden, welcher als Rückgabewert einen symmetrischen Schlüssel liefert.
REQ(ids=A_18165)<b>A_18165 - FM ePA: Übergreifende Anforderung - Verwendung der Basisfunktionalität des Konnektors zur Kommunikation mit einem SGD</b>
PAR Das Fachmodul ePA MUSS bei der Kommunikation mit einem SGD für die Schlüsselableitung gemäß A_17777 die Basisfunktionalität des Konnektors verwenden. <b>[<=]</b>

REQ(ids=A_15894)<b>A_15894 - FM ePA: Übergreifende Anforderung - Verwendung der Basisfunktionalität des Konnektors zur Kommunikation mit der VAU bei Schlüsselaushandlung</b>
PAR Das Fachmodul ePA MUSS bei der Kommunikation mit der VAU für die Schlüsselaushandlung gemäß  die Basisfunktionalität des Konnektors verwenden.
PAR <b>[<=]</b>

REQ(ids=A_15895)<b>A_15895 - FM ePA: Übergreifende Anforderung - Verwendung der Basisfunktionalität des Konnektors zur Kommunikation mit der VAU bei Schlüsselableitung</b>
PAR Das Fachmodul ePA MUSS zur Kommunikation mit der VAU bei der Schlüsselableitung gemäß  die Basisfunktionalität des Konnektors verwenden.
PAR <b>[<=]</b>

REQ(ids=A_14748)<b>A_14748 - FM ePA: Übergreifende Anforderung - Verwendung des Verschlüsselungsdienstes</b>
PAR Das Fachmodul ePA MUSS zur Ver- und Entschlüsselung von Dokumenten und Dokumenten-, Akten- und Kontextschlüssel den Verschlüsselungsdienst des Konnektors nutzen. <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des Verschlüsselungsdienstes im Konnektor sind in [gemSpec_Kon#4.1.7] beschrieben.
REQ(ids=A_15891)<b>A_15891 - FM ePA: Übergreifende Anforderung - Verwendung des Zertifikatsdienstes</b>
PAR Das Fachmodul ePA MUSS zur Prüfung von Zertifikaten den Zertifikatsdienst des Konnektors verwenden. <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des Zertifikatsdienstes im Konnektor sind in [gemSpec_Kon#4.1.9] beschrieben.
REQ(ids=A_15892)<b>A_15892 - FM ePA: Übergreifende Anforderung - Verwendung des Signaturdienstes</b>
PAR Das Fachmodul ePA MUSS zur Erstellung und Prüfung von Signaturen den Signaturdienst des Konnektors verwenden. <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des Signaturdienstes im Konnektor sind in [gemSpec_Kon#4.1.8] beschrieben.
REQ(ids=A_15135)<b>A_15135 - FM ePA: Übergreifende Anforderung - Verwendung des Namensdienstes</b>
PAR Das Fachmodul ePA MUSS für DNS-Abfragen den Namensdienst des Konnektors nutzen. <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des Namensdienstes im Konnektor sind in [gemSpec_Kon#4.2.6] beschrieben.
REQ(ids=A_15136)<b>A_15136 - FM ePA: Übergreifende Anforderung - Verwendung des Zugriffsberechtigungsdienstes</b>
PAR Das Fachmodul ePA MUSS zur Prüfung der Berechtigungen zum Zugriff auf vom Konnektor verwaltete Ressourcen den Zugriffsberechtigungsdienst des Konnektors nutzen. <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des Zugriffsberechtigungsdienstes im Konnektor sind in [gemSpec_Kon#4.1.1] beschrieben.
REQ(ids=A_14710)<b>A_14710 - FM ePA: Übergreifende Anforderung - Verwendung des Protokollierungsdienstes</b>
PAR Das Fachmodul ePA MUSS für Log-Einträge den Protokollierungsdienst des Konnektors nutzen. <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des Protokollierungsdienstes im Konnektor sind in [gemSpec_Kon#4.1.10] beschrieben.
REQ(ids=A_15194)<b>A_15194 - FM ePA: Übergreifende Anforderung - Verwendung des Kartendienstes</b>
PAR Das Fachmodul ePA MUSS für Interaktion mit Smartcards den Kartendienst des Konnektors nutzen. <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des Kartendienstes im Konnektor sind in [gemSpec_Kon#4.1.5] beschrieben.
REQ(ids=A_15535)<b>A_15535 - FM ePA: Übergreifende Anforderung - Verwendung des TLS-Dienstes des Konnektors</b>
PAR Das Fachmodul ePA MUSS zum Aufbau und Abbau einer TLS-Verbindung den TLS-Dienst des Konnektors nutzen.
PAR <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des TLS-Dienstes sind in [gemSpec_Kon#4.1.11] beschrieben.
REQ(ids=A_15677)<b>A_15677 - FM ePA: Übergreifende Anforderung - Verwendung des Zeitdienstes des Konnektors</b>
PAR Das Fachmodul ePA MUSS zur Ermittlung der Systemzeit den Zeitdienst des Konnektors nutzen. <b>[<=]</b>

PAR Die fachlichen Schnittstellen zur Nutzung des Zeitdienstes sind in [gemSpec_Kon#4.2.5] beschrieben.
PAR -HEADING(ids=6.2)6.2 IHE
PAR Das Aktensystem, mit dem die Operationen des Fachmoduls kommunizieren, wird durch die HomeCommunityID festgelegt. Diese wird als Teil des RecordIdentifier entweder über Aufrufparameter oder SOAP-Header übertragen. Kapitel 6.2  beschreibt alle IHE-Akteure der Fachanwendung ePA.
REQ(ids=A_14374)<b>A_14374 - FM ePA: Übergreifende Anforderung IHE - Profile, Akteure und Optionen</b>
PAR Das Fachmodul ePA MUSS die in der folgenden Tabelle gelisteten Profile, Akteure und Optionen unterstützen:
PAR Tabelle 3: Tab_FM_ePA_002 Profile, Akteure und Optionen des Webservices PHRService

TABLE(rows=10,cols=71+65+62+329)->
TR-> TH(0,0/1/1)->PAR Profil TH(0,1/1/1)->PAR Akteur TH(0,2/1/1)->PAR IHE-Option TH(0,3/1/1)->PAR Erläuterung
TR-> TD(1,0/1/1)->PAR XCA gemäß [IHE-ITI-TF] TD(1,1/1/1)->PAR Initiating Gateway TD(1,2/1/1)->PAR XDS Affinity Domain Option TD(1,3/1/1)->PAR Die Option wird benötigt, um IHE-konformes Suchen [ITI-18] und Herunterladen von Dokumenten [ITI-43] zu ermöglichen.
TR-> TD(2,0/2/1)->PAR RMD gemäß [IHE-ITI-RMD] TD(2,1/1/1)->PAR Document Repository TD(2,2/1/1)->PAR Keine TD(2,3/1/1)->PAR Keine Optionen benötigt.
TR-> TD(3,1/1/1)->PAR Document Administrator* (ggü. ePA-Aktensystem) TD(3,2/1/1)->PAR Remote Repository Option TD(3,3/1/1)->PAR Option wird benötigt, damit das Fachmodul ePA die Löschanfrage an das ePA-Aktensystem weiterreichen kann.
TR-> TD(4,0/2/1)->PAR RMU gemäß [IHE-ITI-RMU] TD(4,1/1/1)->PAR Update Responder TD(4,2/1/1)->PAR Forward Update TD(4,3/1/1)->PAR Option wird benötigt, um Update-Nachricht weiterzuleiten an XCA Responding Gateway der Dokumentenverwaltung. Die Option erzwingt eine Gruppierung mit einem RMU Update Initiator.
TR-> TD(5,1/1/1)->PAR Update Initiator TD(5,2/1/1)->PAR Keine TD(5,3/1/1)->PAR Keine Optionen benötigt.
TR-> TD(6,0/1/1)->PAR APPC gemäß [IHE-ITI-APPC] TD(6,1/1/1)->PAR Content Creator* TD(6,2/1/1)->PAR Keine TD(6,3/1/1)->PAR Keine Optionen benötigt.
TR-> TD(7,0/1/1)->PAR XCDR gemäß [IHE-ITI-XCDR] TD(7,1/1/1)->PAR XCDR Initiating Gateway TD(7,2/1/1)->PAR Keine TD(7,3/1/1)->PAR Keine Option benötigt.
TR-> TD(8,0/1/1)->PAR XDR gemäß<br>[IHE-ITI-TF] TD(8,1/1/1)->PAR Document Recipient TD(8,2/1/1)->PAR Keine TD(8,3/1/1)->PAR Keine Optionen benötigt.
TR-> TD(9,0/1/1)->PAR XUA gemäß [IHE-ITI-TF] TD(9,1/1/1)->PAR X-Service User (ggü. ePA-Aktensystem)* TD(9,2/1/1)->PAR Keine TD(9,3/1/1)->PAR Keine IHE Optionen benötigt.<br>Erweiterung um die SAML-Attribute Subject-ID, Organization-ID, Organization
PAR Legende: Mit "*" gekennzeichnete Akteure haben keine Auswirkungen auf die Außenschnittstelle zu Primärsystemen, sondern nur auf Umsetzung der einzelnen Operationen durch das Fachmodul<br>​​
PAR <b>[<=]</b>

PAR Hinweis: Alle spezifizierten Anforderungen der IHE ITI-Akteure in Abschnitt 6.2. definieren das zu implementierende Verhalten an den Außenschnittstellen PHRService sowie PHRManagementService. Dies schließt keine zusätzlichen implementierten IHE-Funktionalitäten innerhalb des ePA-Fachmoduls aus. Um die Anforderungen an den Datenschutz zu gewährleisten, dürfen auch bei der Verwendung weiterer IHE-Funktionalitäten weder medizinische noch personenbezogene Daten geloggt werden, d.h. es gilt A_14155
REQ(ids=A_17879)<b>A_17879 - FM ePA: Übergreifende Anforderung IHE - Außenverhalten der IHE ITI-Implementierung</b>
PAR Falls über die in Tab_FM_ePA_002 genannten IHE ITI-Akteure und Optionen zusätzliche IHE ITI-Akteure und Optionen implementiert werden, DARF das Fachmodul ePA NICHT von der Definition des Außenverhaltens von PHRService und PHRManagementService abweichen oder anderweitig Nachrichten an Komponenten außerhalb des Fachmoduls ePA kommunizieren.<br>​​
PAR <b>[<=]</b>

PAR Hinweis: Sofern zusätzliche Funktionalität im Fachmodul ePA implementiert ist, muss diese vollständig dokumentiert werden (inkl. Begründung, warum sie nicht ausführbar ist), um eine Prüfung nach der Technischen Richtlinie zu ermöglichen.
REQ(ids=A_14354)<b>A_14354 - FM ePA: Übergreifende Anforderung IHE - Keine Prüfung der Metadaten-Profilierung</b>
PAR Das Fachmodul ePA DARF die Metadaten von IHE-Transaktionen nach [gemSpec_DM_ePA#2.1.4] über das XML-Schema ihrer zugehörigen WSDL-Datei hinaus NICHT prüfen.
PAR <b>[<=]</b>

PAR Eine Schemaprüfung der Metadaten als übergebenen Parameter findet nur im Rahmen der Schemaprüfung der Nachricht durch den zugehörigen Webservice PHRService statt. Die darüberhinausgehende, Prüfung der Metadaten gemäß der IHE-Profilierung in [gemSpec_DM_ePA#2.1.4] erfolgt im ePA-Aktensystem.
REQ(ids=A_16220)<b>A_16220 - FM ePA: Übergreifende Anforderung IHE - Dokumenten-Codierung</b>
PAR Das Fachmodul ePA MUSS gemäß den Anforderungen von [IHE-ITI-TF2x#V.3.6] zur Übertragung von Dokumenten eine Kodierung mittels MTOM/XOP [MTOM] verwenden. <br>​​
PAR <b>[<=]</b>

PAR -HEADING(ids=6.3)6.3 Lokalisierung von ePA-Aktensystemen
PAR Die Versicherten haben das Recht, sich ihr Aktensystem frei unter den am Markt bestehenden Anbietern ePA-Aktensystem auszuwählen und zu wechseln. Dies bedeutet, dass vor dem Zugriff auf eine Akte immer der passende Anbieter inklusive der URL des Aktendienstes und der Endpunkte über den Namensdienst der zentralen TI abgefragt werden muss.
PAR Das ePA-Aktensystem wird durch die HomeCommunityID adressiert, welche Bestandteil des RecordIdentifier (siehe [gemSpec_DM_ePA#2.2]) ist.
REQ(ids=A_13839)<b>A_13839 - FM ePA: Lokalisierung - ePA-Aktensystem und Komponenten</b>
PAR Das Fachmodul ePA MUSS die zur Kommunikation mit den Komponenten

LIST->
LITEM->PAR Zugangsgateway des Versicherten,LITEM->PAR Autorisierung ,LITEM->PAR Dokumentenverwaltung,LITEM->PAR SGD 1 undLITEM->PAR SGD 2
PAR eines ePA-Aktensystems notwendigen Lokalisierungsinformationen per DNS-Abfrage nach den in [gemSpec_Aktensystem#Tab_ePA_Service Discovery] und [gemSpec_Aktensystem#Tab_ePA_FQDN] dargestellten Parametern ermitteln.<br>​​
PAR <b>[<=]</b>

REQ(ids=A_14025)<b>A_14025 - FM ePA: Lokalisierung - ePA-Aktensystem und Komponenten - Fehler</b>
PAR Falls alle zur Durchführung einer Operation benötigten Lokalisierungsinformationen nicht vorliegen, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 7200 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR Das Fachmodul ePA kann die Lokalisierungsinformationen unabhängig von der Nutzung seiner Schnittstellen abrufen, zwischenspeichern und wiederverwenden. Es ist z.B. denkbar, dass das Fachmodul ePA die Lokalisierungsinformationen in der Bootup-Phase des Konnektors abruft.
PAR -HEADING(ids=6.4)6.4 Aufrufkontext und Auswahl eines SM-B
PAR Die Operationen des Fachmoduls ePA werden von Mandanten mit unterschiedlichen Berechtigungen aufgerufen und benötigen Zugriff auf vom Konnektor verwaltete Ressourcen, wie z.B. Kartenterminals und SM-Bs. Daher muss bei jedem Aufruf vom Clientsystem ein Aufrufkontext übergeben werden, anhand dessen der Konnektor die Zugriffsberechtigung gegen das vom Administrator konfigurierte Informationsmodell prüfen kann. Falls die Operation einen Login im ePA-Aktensystem mittels SM-B erfordert, wird diese durch den Mandanten, den der Aufrufkontext bestimmt, ebenfalls über das Informationsmodell ermittelt.
PAR Der Aufrufkontext wird üblicherweise im Request als Parameter übertragen (vgl. [PHRManagementService.wsdl]). Um die Verwendung bereits vorhandener IHE-Funktionalität in Primärsystemen zu erleichtern bzw. sogar ohne Anpassungen zu unterstützen, bietet das Fachmodul folgende Möglichkeiten:

LIST->
LITEM->PAR In weniger komplexen Einsatzumgebungen kann bei der Nutzung des Webservices PHRService auf die Übertragung des Aufrufkontexts verzichtet und stattdessen ein Default-Aufrufkontext verwendet werden. Dieser wird vorab auf dem Konnektor eingerichtet und bezieht sich immer genau auf einen Mandanten, ein Clientsystem und einen Arbeitsplatz.LITEM->PAR In Einsatzumgebungen, welche verschiedene Aufrufkontexte benötigen, wird der zu verwendende Aufrufkontext als SAML-Token im SOAP-Header unter Nutzung des IHE-Profils "XUA" als SAML-Token übertragen.
REQ(ids=A_14947)<b>A_14947 - FM ePA: Login - Ermittlung des Aufrufkontexts via Aufrufparameter</b>
PAR Der Webservice PHRManagementService MUSS den Aufrufkontext gemäß [ConnectorContext.xsd] anhand des im Aufruf übergebenen Parameters Context bestimmen. <b>[<=]</b>

REQ(ids=A_15142)<b>A_15142 - FM ePA: Login - Ermittlung des Aufrufkontexts via SOAP-Header</b>
PAR Der Webservice PHRService MUSS den Aufrufkontext gemäß [ConnectorContext.xsd] anhand der nach Tab_FM_ePA_005 übertragenen SOAP-Header bestimmen.
PAR <b>[<=]</b>

PAR Default-Aufrufkontext
REQ(ids=A_14084)<b>A_14084 - FM ePA: Login - Bereitstellung Default-Aufrufkontext</b>
PAR Das Fachmodul ePA MUSS im Informationsmodell des Konnektors einen Default-Aufrufkontext für die Nutzung des Webservices PHRService bereitstellen mit:

LIST->
LITEM->PAR MandantId = "Mandant_ePA_Default"LITEM->PAR ClientsystemId = "Clientsystem_ePA_Default"LITEM->PAR WorkplaceId = "Workplace_ePA_Default
PAR <b>[<=]</b>

REQ(ids=A_14103)<b>A_14103 - FM ePA: Login - Konfiguration Default-Aufrufkontext</b>
PAR Der Hersteller des Fachmoduls ePA MUSS im Handbuch die Konfiguration des Default-Aufrufkontexts durch den Administrator beschreiben. <b>[<=]</b>

REQ(ids=A_14948)<b>A_14948 - FM ePA: Login - Verwendung des Default-Aufrufkontexts bei fehlenden SOAP-Headern</b>
PAR Falls keine SOAP-Header übergeben wurden, MUSS der Webservice PHRService als Aufrufkontext den Default-Aufrufkontext aus dem Informationsmodell des Konnektors auswählen. <b>[<=]</b>

PAR Für die IHE-Schnittstelle (PHRService) wird die Komfortfunktion eines Default-Aufrufkontexts angeboten, um die Verwendung bereits vorhandener IHE-Funktionalität in Primärsystemen zu erleichtern bzw. sogar ohne Anpassungen zu unterstützen. Der Webservice PHRManagement hingegen folgt der in den anderen Fachmodulen des Konnektors üblichen Vorgehensweise zur Übertragung des Aufrufkontexts durch die Primärsysteme via Aufrufparameter.
PAR Prüfung der Zugriffsberechtigung auf vom Konnektor verwaltete Ressourcen
REQ(ids=A_13941)<b>A_13941 - FM ePA: Login - Zugriffsberechtigung auf vom Konnektor verwaltete Ressourcen</b>
PAR Das Fachmodul ePA MUSS vor Durchführung einer fachlichen Operation  die Zugriffsberechtigung des aufrufenden Primärsystems anhand des Aufrufkontexts prüfen.
PAR <b>[<=]</b>

REQ(ids=A_14107)<b>A_14107 - FM ePA: Login - Zugriffsberechtigung auf vom Konnektor verwaltete Ressourcen - Fehler</b>
PAR Falls bei der Prüfung der Zugriffsberechtigung auf das ausgewählte SM-B ein Fehler zurückgegeben wird, MUSS das Fachmodul ePA die Operation mit dem Code 7206 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR Auswahl eines SM-B
PAR Alle Operationen, außer GetHomeCommunityID, benötigen in ihrem Ablauf ein oder auch mehrere SM-Bs für die folgende Funktionalität:
PAR (ids=Tabelle-4)Tabelle 4: Tab_FM_ePA_034 Übersicht der Funktionen, die ein SM-B benötigen, mit Zuordnung zu den aufrufenden Operationen und ob die SM-B eine Berechtigung zum Zugriff haben muss

TABLE(rows=5,cols=212+176)->
TR-> TH(0,0/1/1)->PAR Funktion<br>(Wofür wird ein SM-B benötigt?) TH(0,1/1/1)->PAR Operation<br>(Welche Operationen benötigen die Funktionalität?)
TR-> TD(1,0/1/1)->PAR Authentisierung am ePA-Aktensystem<br>Zur Erstellung (Signatur) einer AuthenticationAssertion benötigt das Fachmodul ePA ein gültiges SM-B. TD(1,1/1/1)->PAR Alle Operationen des Webservices PHRService und die Operation  GetAuthorizationList
TR-> TD(2,0/1/1)->PAR Autorisierung am ePA-Aktensystem<br>Zum Abruf des Chiffrats, welches Akten- und Kontextschlüssel enthält, benötigt das Fachmodul ePA eine AuthenticationAssertion für ein gültiges SM-B, dessen Telematik-ID zuvor zum Zugriff auf die Patientenakte berechtigt wurde.<br>Zum Abruf der Schlüssel gemäß [gemSpec_SGD_ePA], mit denen das Chiffrat entschlüsselt werden kann, benötigt das Fachmodul ePA ein gültiges SM-B, dessen Telematik-ID zuvor zum Zugriff auf die Patientenakte berechtigt wurde. TD(2,1/1/1)->PAR Alle Operationen des Webservices PHRService
TR-> TD(3,0/1/1)->PAR C2C mit eGK<br>Zur Freischaltung von PrK.CH.AUT (eGK) bei der Authentisierung wird ein beliebiges SM-B benötigt. TD(3,1/1/1)->PAR ActivateAccount, RequestFacilityAuthorization
TR-> TD(4,0/1/1)->PAR Berechtigungsvergabe<br>Die Berechtigungsvergabe an eine LEI erfolgt für  die Telematik-ID des ausgewählten SM-B. TD(4,1/1/1)->PAR RequestFacilityAuthorization
PAR Die folgenden Anforderungen beziehen sich auf die Auswahl eines SM-B zur Authentisierung, zur Berechtigungsvergabe und zur Durchführung eines C2C mit einer eGK. Die Auswahl eines SM-B zur Autorisierung wird im Kapitel 6.5.4 behandelt.
REQ(ids=A_15614)<b>A_15614 - FM ePA: Übergreifende Anforderung - Ermittlung eines SM-B</b>
PAR Das Fachmodul ePA MUSS zu jedem Aufrufkontext ein im Informationsmodell des Konnektors konfiguriertes, freigeschaltetes SM-B des Mandanten ermitteln.
PAR <b>[<=]</b>

REQ(ids=A_17928)<b>A_17928 - FM ePA: Übergreifende Anforderung - Ermittlung eines SM-B - Prüfung OID</b>
PAR Das Fachmodul ePA MUSS eine SM-B ermitteln, welche im Zertifikat C.HCI.OSIG im Feld ProfessionOID der ZertifikatsExtension Admission mindestens eine der zulässigen Autorisierungsempfänger-Rollen gemäß [gemSpec_OID#Tab_PKI_402] und [gemSpec_OID#Tab_PKI_403]

LIST->
LITEM->PAR oid_praxis_arztLITEM->PAR oid_zahnarztpraxisLITEM->PAR oid_praxis_psychotherapeutLITEM->PAR oid_krankenhausLITEM->PAR oid_oeffentliche_apothekeLITEM->PAR oid_krankenhausapothekeLITEM->PAR oid_bundeswehrapothekeLITEM->PAR oid_mobile_einrichtung_rettungsdienst
PAR enthalten ist.
PAR <b>[<=]</b>

REQ(ids=A_15615)<b>A_15615 - FM ePA: Übergreifende Anforderung - Ermittlung eines SM-B - Fehler</b>
PAR Falls bei der Ermittlung eines SM-B ein Fehler auftritt, MUSS das Fachmodul ePA die Operation mit dem Code 7205 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

PAR Ein SM-B wird als freigeschaltet betrachtet, wenn sich das Objekt PIN.SMC im erhöhten Sicherheitszustand befindet.
PAR -HEADING(ids=6.5)6.5 Login
PAR Der Login nach [gemSysL_ePA#3.4.2] in ein ePA-Aktensystem erfolgt bei Bedarf durch das Fachmodul ePA und beinhaltet die Vorbereitungen zur Durchführung von Fachoperationen. Dazu gehören das Abrufen der Authentifizierungs- und Autorisierungsbestätigungen sowie das Initialisieren und Öffnen des Aktenkontextes. Für den aufrufenden Akteur ist die Login-Funktionalität nicht explizit nutzbar, sondern wird implizit innerhalb anderer Operationsaufrufe ausgeführt. Dies bedeutet, dass eventuelle Fehlersituationen beim Login in den Rückgabewerten der jeweiligen Fachoperationen sichtbar werden.
PAR Das Ergebnis eines vollständigen Logins ist

ORDERED-LIST->
LITEM->PAR das Anlegen einer neuen oder die Nutzung einer vorhandenen Aktensession,LITEM->PAR die Authentisierung des Nutzers (LEI oder Versicherter/Vertreter) gegenüber dem ePA-Aktensystem,LITEM->PAR die Autorisierung des Nutzers gegenüber dem ePA-Aktensystem undLITEM->PAR das Starten und die Initialisierung einer vertrauenswürdigen Ausführungsumgebung (VAU) im ePA-Aktensystem.
PAR Punkt 4 ist insofern optional, als dass die Verbindung zur Dokumentenverwaltung nicht zur Durchführung aller Operationen erforderlich ist.
PAR -HEADING(ids=6.5.1)6.5.1 Aktensession
PAR Eine Aktensession umfasst die zur Kommunikation mit dem ePA-Aktensystem notwendigen Daten eines Operationsaufrufes (Abläufe, Parameter, Rückgabewerte, interne Variablen und Zustände, Referenzen auf Smartcards, Schlüsselmaterialien, Token, etc.). Je nach Komponenten und Art der Authentisierung des Nutzers (via SM-B oder eGK) werden die folgenden Daten benötigt:
PAR (ids=Tabelle-5)Tabelle 5: Tab_FM_ePA_001 Daten zur Kommunikation mit den Komponenten des ePA-Aktensystems (abhängig vom Nutzer)

TABLE(rows=12,cols=192+259+255)->
TR-> TH(0,0/1/1)->PAR Datenfeld TH(0,1/1/1)->PAR Herkunft TH(0,2/1/1)->PAR Beschreibung
TR-> TD(1,0/1/1)->PAR RecordIdentifier TD(1,1/1/1)->PAR Primärsystem (als Parameter übergeben) TD(1,2/1/1)->PAR Kennung der Akte des Versicherten beim jeweiligen Anbieter ePA-Aktensystem im Format von RecordIdentifier gemäß [gemSpec_DM_ePA#2.2]
TR-> TD(2,0/1/1)->PAR Aufrufkontext TD(2,1/1/1)->PAR Primärsystem (als Parameter übergeben) TD(2,2/1/1)->PAR MandantId, CsId, WorkplaceId, UserId (optional)
TR-> TD(3,0/1/1)->PAR Telematik-ID TD(3,1/1/1)->PAR Informationsmodell des Konnektors TD(3,2/1/1)->PAR Identität einer LEI in einem SM-B
TR-> TD(4,0/1/1)->PAR SM-B<br>(falls Authentisierung via SM-B) TD(4,1/1/1)->PAR Informationsmodell des Konnektors TD(4,2/1/1)->PAR SM-B, die zur Authentifizierung gegenüber dem ePA-Aktensystem verwendet wird
TR-> TD(5,0/1/1)->PAR eGK<br>(falls Authentisierung via eGK) TD(5,1/1/1)->PAR Primärsystem (als Parameter übergeben) TD(5,2/1/1)->PAR eGK, die zur Authentifizierung gegenüber dem ePA-Aktensystem verwendet wird
TR-> TD(6,0/1/1)->PAR AuthenticationAssertion TD(6,1/1/1)->PAR Authentisierung via<br>        SM-B: Fachmodul       eGK: Komponente Zugangsgateway für Versicherte des ePA-Aktensystems TD(6,2/1/1)->PAR Authentifizierungsbestätigung<br>als Voraussetzung für die Autorisierung
TR-> TD(7,0/1/1)->PAR AuthorizationAssertion TD(7,1/1/1)->PAR Komponente Autorisierung des ePA-Aktensystems<br>(I_Authorization::getAuthorizationKey) TD(7,2/1/1)->PAR Die AuthorizationAssertion ist eine signierte Autorisierungsbestätigung für einen Nutzer und enthält Informationen über die Art und den Umfang der in der Komponente Autorisierung hinterlegten Autorisierung. Sie ist Base64-codiert und wird innerhalb des Fachmoduls nicht ausgewertet.
TR-> TD(8,0/1/1)->PAR RecordKey TD(8,1/1/1)->PAR Komponente Autorisierung des ePA-Aktensystems<br>(I_Authorization::getAuthorizationKey) TD(8,2/1/1)->PAR entschlüsselter Aktenschlüssel
TR-> TD(9,0/1/1)->PAR ContextKey TD(9,1/1/1)->PAR Komponente Autorisierung des ePA-Aktensystems<br>(I_Authorization::getAuthorizationKey) TD(9,2/1/1)->PAR entschlüsselter Kontextschlüssel
TR-> TD(10,0/1/1)->PAR VAU-Assets TD(10,1/1/1)->PAR Kryptographische Geheimnisse (z.B. Ableitungsschlüssel, Authentisierungstoken), die beim Aufbau der sicheren Verbindung zur VAU () erzeugt bzw. ausgetauscht werden.  TD(10,2/1/1)->PAR z.B. Ableitungsschlüssel, Authentisierungstoken
TR-> TD(11,0/1/1)->PAR SGD-Assets TD(11,1/1/1)->PAR Kryptographische Geheimnisse, die beim Aufbau der sicheren Verbindung zu einem SGD () erzeugt bzw. ausgetauscht werden.  TD(11,2/1/1)->PAR z.B. kurzlebige ECIES-Schlüssel
REQ(ids=A_13677)<b>A_13677 - FM ePA: Aktensession - Trennung von Operation</b>
PAR Das Fachmodul ePA MUSS alle Operationsaufrufe sowie die den Operationen zugehörige Aktensession voneinander trennen. <b>[<=]</b>

REQ(ids=A_15143)<b>A_15143 - FM ePA: Aktensession - Temporäre Speicherung und Wiederverwendung (SM-B)</b>
PAR Das Fachmodul ePA KANN auf Basis des Tupels (Telematik-ID der zur Authentisierung verwendeten SM-B, RecordIdentifier) eine Aktensession temporär speichern und wiederverwenden. <b>[<=]</b>

REQ(ids=A_15144)<b>A_15144 - FM ePA: Aktensession - Temporäre Speicherung und Wiederverwendung (eGK)</b>
PAR Das Fachmodul ePA KANN auf Basis des Tupels (Versicherten-ID einer zur Authentisierung verwendeten eGK, RecordIdentifier) eine Aktensession temporär speichern und wiederverwenden.<br>​​
PAR <b>[<=]</b>

REQ(ids=A_17949)<b>A_17949 - FM ePA: Aktensession - Löschen der Aktensession bei Entfernen der eGK</b>
PAR Falls die eGK aus dem Kartenterminal entfernt wird, MUSS das Fachmodul ePA die Aktensession der eGK beenden und alle dazugehörigen Daten löschen. <b>[<=]</b>

PAR Sowohl der Aufruf der Operation EjectCard als auch das Ziehen der Karte aus dem Kartenterminal führt zum Entfernen der eGK aus dem Kartenterminal.
PAR -HEADING(ids=6.5.2)6.5.2 Authentisierung mittels SM-B
PAR Die Authentisierung mittels SM-B findet für die folgenden Operationen statt:

LIST->
LITEM->PAR PHRService
LIST->
LITEM->PAR putDocumentsLITEM->PAR findLITEM->PAR getDocumentsLITEM->PAR removeDocumentsLITEM->PAR updateDocumentSetLITEM->PAR PHRManagementService
LIST->
LITEM->PAR GetAuthorizationList
PAR Die Authentisierung LEI mit dem ausgewählten SM-B erfolgt durch das Fachmodul ePA. Hierzu erzeugt das Fachmodul ePA ein SAML-Token, welches dem IHE-Profil "XUA" [IHE-ITI-TF] genügt und als AuthenticationAssertion bezeichnet wird. Das Token wird mit dem für LEI ausgewählten SM-B signiert.
PAR Die Authentisierung LEI im Fachmodul ePA muss nur einmalig erfolgen, auch wenn die LEI auf verschiedene Akten zugreifen möchte. Aus diesem Grunde kann die AuthenticationAssertion außerhalb einer Aktensession gespeichert und wiederverwendet werden.
PAR Ermittlung der Karte für die Authentisierung
PAR Die Ermittlung der SM-B für die Authentisierung wird in Kapitel 6.4 beschrieben.
PAR Erstellung der AuthenticationAssertion
REQ(ids=A_14927)<b>A_14927 - FM ePA: Authentisierung mit SM-B - Erstellung des SAML-Token</b>
PAR Das Fachmodul ePA MUSS für die Authentisierung mit einem SM-B als Authentifizierungsbestätigung eine SAML2-Assertion gemäß dem IHE-Profil "XUA" [IHE-ITI-TF] und [gemSpec_TBAuth#TAB_TBAuth_03] erstellen und dabei folgende Vorgaben beachten:

LIST->
LITEM->PAR das Issuer Element muss als Aussteller des Token den Wert "urn:epa:telematik:fmePA" enthaltenLITEM->PAR die eingebettete Signatur ds:Signature wird mit dem C.HCI.OSIG Zertifikat der ausgewählten SM-B unter Verwendung des Signaturdienstes des Konnektors erstellt. Die Signatur enthält im ds:KeyInfo Element das verwendete Signaturzertifikat.LITEM->PAR das Element saml2:Subject/saml2:NameID muss auf Basis des C.HCI.OSIG Zertifikats gebildet werdenLITEM->PAR das Attribut saml2:Subject/saml2:SubjectConfirmation/@Method muss auf den Wert "urn:oasis:names:tc:SAML:2.0:cm:bearer" gesetzt werdenLITEM->PAR das Attribut saml2:Conditions/@NotBefore muss auf die Systemzeit gesetzt werdenLITEM->PAR das Attribut saml2:Conditions/@NotOnOrAfter muss auf (Systemzeit+24 Stunden) gesetzt werdenLITEM->PAR das Element saml2:Conditions/saml2:AudienceRestriction/saml2:Audience muss auf die FQDN des Anbieters des Aktensystems gesetzt werdenLITEM->PAR das Element saml2:AuthnStatement/saml2: AuthnContext/saml2:AuthnContextClassRef muss auf den Wert "urn:oasis:names:tc:SAML:2.0:ac:classes:Smartcard" gesetzt werden
PAR <b>[<=]</b>

REQ(ids=A_15638)<b>A_15638 - FM ePA: Authentisierung mit SM-B - Behauptungen im SAML-Token</b>
PAR Das Fachmodul ePA MUSS die für die Authentisierung mit einem SM-B als Authentifizierungsbestätigung erstellte SAML2-Assertion im Element AttributeStatement mit den Behauptungen gemäß [gemSpec_TBAuth#TAB_TBAuth_02_1] befüllen und dabei folgende Vorgaben beachten:

LIST->
LITEM->PAR die Behauptungen müssen auf Basis des C.HCI.OSIG Zertifikats gebildet werdenLITEM->PAR die in der Tabelle angegebenen Behauptungen müssen enthalten sein, sofern sie aus dem zugrundeliegenden Zertifikat entnommen werden könnenLITEM->PAR die Behauptung "urn:gematik : subject:organization-id" muss enthalten sein und basierend auf der RegistrationNumber (Telematik-ID) gebildet werden. Das AttributAttribute/@NameFormat muss dabei den Wert "urn:oasis:names:tc:SAML:2.0:attrname-format:uri" haben.
PAR <b>[<=]</b>

PAR Die SAML2-Assertion gemäß A_14927 wird auch zur Kommunikation mit der Komponente Dokumentenverwaltung verwendet.
REQ(ids=A_15202)<b>A_15202 - FM ePA: Authentisierung mit SM-B - Wiederverwendung der AuthenticationAssertion</b>
PAR Das Fachmodul ePA KANN die AuthenticationAssertion zur Authentisierung einer LEI über ihre gesamte Gültigkeitsdauer hinweg auch außerhalb einer Aktensession zwischenspeichern und wiederverwenden. <b>[<=]</b>

REQ(ids=A_15203)<b>A_15203 - FM ePA: Authentisierung mit SM-B - Löschen der AuthenticationAssertion</b>
PAR Das Fachmodul ePA MUSS die AuthenticationAssertion zur Authentisierung einer LEI spätestens nach Ablauf ihrer Gültigkeitsdauer löschen. <b>[<=]</b>

PAR -HEADING(ids=6.5.3)6.5.3 Authentisierung mittels eGK
PAR Die Authentisierung mittels eGK findet für die folgenden Operationen statt:

LIST->
LITEM->PAR PHRManagementService
LIST->
LITEM->PAR ActivateAccountLITEM->PAR RequestFacilityAuthorization
PAR Für die Anmeldung des Versicherten oder seines berechtigten Vertreters mit seiner eGK wird eine 2-Faktor-Authentisierung (eGK + PIN) verwendet. Das Fachmodul ePA baut anschließend eine TLS-Verbindung zur Komponente Zugangsgateway für Versicherte auf. Durch Nutzung des Interfaces I_Authentication_Insurant::login an der Komponente wird eine Authentifizierungsbestätigung (AuthenticationAssertion) angefordert. Bei dieser Form der Authentisierung wird kryptographisches Material der eGK verwendet. Hierfür ist eine Freischaltung der eGK durch PIN-Eingabe erforderlich.
PAR Freischaltung der eGK
REQ(ids=A_14928)<b>A_14928 - FM ePA: Authentisierung mit eGK - PIN-Eingabe</b>
PAR Falls für die Authentisierung mittels eGK die PIN.CH nicht freigeschaltet ist, MUSS das Fachmodul ePA die PIN-Verifikation der durch EhcHandle adressierten eGK durchführen. <b>[<=]</b>

REQ(ids=A_14945)<b>A_14945 - FM ePA: Authentisierung mit eGK - PIN-Eingabe - Fehler</b>
PAR Falls die Verifikation von PIN.CH fehlschlägt, MUSS das Fachmodul ePA die aufgerufene Operation mit einem Fehlercode gemäß Tab_FM_ePA_033 abbrechen.
PAR (ids=Tabelle-6)Tabelle 6: Tab_FM_ePA_033 Fehlermeldungen bei der Authentisierung mittels eGK

TABLE(rows=4,cols=33+174+334)->
TR-> TH(0,0/1/1)->PAR Code TH(0,1/1/1)->PAR Bedeutung (informativ)  TH(0,2/1/1)->PAR Ursache/Auslöser nach [gemSpec_Kon#TAB_KON_089]
TR-> TD(1,0/1/1)->PAR 7207 TD(1,1/1/1)->PAR PIN-Verifikation gescheitert TD(1,2/1/1)->PAR pinResult = REJECTED für falsche PIN<br>(pinResult als Ergebnis Perform Verification)<br>          4043, 4049<br>          Alle weiteren Fehlercodes, die der Kartendienst zurückgibt
TR-> TD(2,0/1/1)->PAR 4063 TD(2,1/1/1)->PAR PIN gesperrt TD(2,2/1/1)->PAR 4063
TR-> TD(3,0/1/1)->PAR 4065 TD(3,1/1/1)->PAR PIN transportgeschützt TD(3,2/1/1)->PAR 4065
PAR Die vollständige Definition des Fehlers bezeichnet durch Code ist in Tab_FM_ePA_011 und Tab_FM_ePA_050 beschrieben.
PAR <b>[<=]</b>

PAR Aufbau der TLS-Verbindung zur Komponente Zugangsgateway für Versicherte
REQ(ids=A_14929)<b>A_14929 - FM ePA: Authentisierung mit eGK - TLS-Verbindung zur Komponente Zugangsgateway aufbauen</b>
PAR Das Fachmodul ePA MUSS zur Kommunikation mit der Komponente Zugangsgateway für Versicherte eine TLS-Verbindung aufbauen bzw. eine bestehende TLS-Verbindung nutzen. <b>[<=]</b>

REQ(ids=A_16951)<b>A_16951 - FM ePA: Authentisierung mit eGK- Verwendung der lokalisierten URI</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der TLS-Verbindung zur Komponente Zugangsgateway für Versicherte deren lokalisierte Adresse verwenden. <b>[<=]</b>

REQ(ids=A_14930)<b>A_14930 - FM ePA: Authentisierung mit eGK - TLS mit Zertifikats- und Rollenprüfung</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der TLS-Verbindung zur Komponente Zugangsgateway für Versicherte eine Zertifikats- und Rollenprüfung für das Zertifikatsprofil C.FD.TLS-S gemäß [gemSpec_PKI] mit der Rolle oid_epa_authn gemäß [gemSpec_OID#] durchführen.
PAR <b>[<=]</b>

PAR Authentifizierungsbestätigung erstellen
PAR Das Fachmodul erstellt eine Authentifizierungsbestätigung für einen Versicherten auf der Basis des Zertifikats C.CH.AUT der eGK. Das Vorgehen und die Schnittstelle hierzu ist in [gemSpec_Authentisierung_Vers] beschrieben.
REQ(ids=A_14838)<b>A_14838 - FM ePA: Authentisierung mit eGK - Authentifizierungsbestätigung erstellen</b>
PAR Das Fachmodul ePA MUSS die Erstellung einer AuthenticationAssertion gemäß Tab_FM_ePA_030 umsetzen.
PAR (ids=Tabelle-7)Tabelle 7: Tab_FM_ePA_030 Authentifizierungsbestätigung erstellen

TABLE(rows=4,cols=557)->
TR-> TH(0,0/1/1)->PAR Schritt
TR-> TD(1,0/1/1)->PAR 1. Aufruf der Operation AuthInsurantService::LoginCreateChallenge der Komponente Zugangsgateway des Aktensystems ePA gemäß [gemSpec_Authentisierung_Vers#5.1.1.1.1 Operation login]
TR-> TD(2,0/1/1)->PAR 2. Signatur des Versicherten bzw. Vertreters (eGK) über die von der Komponente "Authentisierung Versicherter" erstellte Challenge
TR-> TD(3,0/1/1)->PAR 3. Aufruf von AuthInsurantService::LoginCreateToken der Komponente Zugangsgateway des Aktensystems ePA gemäß [gemSpec_Authentisierung_Vers#5.1.1.1.1 Operation login]
PAR <b>[<=]</b>

PAR Das Interface I_Authentication_Insurant::login ist in [gemSpec_Authentisierung_Vers#6.1 beschrieben].
REQ(ids=A_14935)<b>A_14935 - FM ePA: Authentisierung mit eGK - Fehler im Aktensystem</b>
PAR Falls bei der Kommunikation mit der Komponente Zugangsgateway zur Authentisierung des Versicherten der Fehler "wst:RequestFailed" auftritt, MUSS das Fachmodul ePA die Operation mit dem Code 7215 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

REQ(ids=A_17123)<b>A_17123 - FM ePA: Authentisierung mit eGK - Fehler beim Aufruf Aktensystem</b>
PAR Falls bei der Kommunikation mit der Komponente Zugangsgateway zur Authentisierung des Versicherten ein anderer Fehler als "wst:RequestFailed" auftritt, MUSS das Fachmodul ePA die Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR Weitere Fehlerrückgaben der Operationen AuthInsurantService::LoginCreateChallenge und AuthInsurantService::LoginCreateToken werden in [gemSpec_Authentisierung_Vers] spezifiziert.
PAR -HEADING(ids=6.5.4)6.5.4 Autorisierung
PAR Die Komponente Autorisierung des lokalisierten ePA-Aktensystems prüft, ob der Zugriff auf die mit dem RecordIdentifier referenzierte Akte erlaubt ist. Dazu schickt das Fachmodul ePA die im Rahmen der Authentisierung (s.o.) ausgestellte AuthenticationAssertion an die Komponente Autorisierung und erhält nach erfolgreicher Prüfung ein Chiffrat mit Akten- und Kontextschlüssel sowie eine Autorisierungsbestätigung (AuthorizationAssertion) zur Kommunikation mit der Dokumentenverwaltung ausgehändigt. Das Chiffrat wird mit zwei gemäß [gemSpec_SGD_ePA] abgeleiteten Schlüsseln der SGDs entschlüsselt. Der Ablauf gliedert sich in die folgenden Schritte:

ORDERED-LIST->
LITEM->PAR TLS-Verbindung zur Komponente Autorisierung aufbauenLITEM->PAR Aufruf der Operation I_Authorization::getAuthorizationKey der Komponente Autorisierung, Übergabe der AuthenticationAssertion und entsprechender Signatur im SOAP-Header gemäß [WSS-SAML]LITEM->PAR Verbindungsaufbau zu zwei SGDs und Abruf jeweils eines AES-SchlüsselsLITEM->PAR Entschlüsselung von Akten- und Kontextschlüssel zur Nutzung in der Aktensession
PAR Verbindungsaufbau zur Komponente Autorisierung
PAR Im Konnektor baut das Fachmodul ePA mit Hilfe von TUC_KON_110 „Kartenbasierte TLS-Verbindung aufbauen" gemäß [gemSpec_Kon#4.1.11.4.1] die TLS-Verbindung ohne Clientauthentisierung und mit Rollenprüfung auf.
REQ(ids=A_14105)<b>A_14105 - FM ePA: Autorisierung - TLS-Verbindung zur Komponente Autorisierung aufbauen</b>
PAR Das Fachmodul ePA MUSS zur Kommunikation mit der Komponente Autorisierung eine TLS-Verbindung aufbauen bzw. eine bestehende TLS-Verbindung nutzen. <b>[<=]</b>

REQ(ids=A_14223)<b>A_14223 - FM ePA: Autorisierung - Verbindung mit Zertifikats- und Rollenprüfung</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der TLS-Verbindung zur Komponente Autorisierung eine Zertifikats- und Rollenprüfung für das Zertifikatsprofil C.FD.TLS-S gemäß [gemSpec_PKI] mit der Rolle oid_epa_authz gemäß [gemSpec_OID#] durchführen.
PAR <b>[<=]</b>

REQ(ids=A_14222)<b>A_14222 - FM ePA: Autorisierung - Verwendung der lokalisierten URI</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der TLS-Verbindung zur Komponente Autorisierung deren lokalisierte Adresse verwenden. <b>[<=]</b>

PAR Abruf des Chiffrats für den authentisierten Nutzer (LEI oder Versicherter / Vertreter)
REQ(ids=A_14014)<b>A_14014 - FM ePA: Autorisierung Aktensession - Request SAML</b>
PAR Das Fachmodul ePA MUSS zur Autorisierung der Aktensession die Operation I_Authorization::getAuthorizationKey gemäß [gemSpec_Autorisierung] mit folgenden Parametern aufrufen:
PAR (ids=Tabelle-8)Tabelle 8: Tab_FM_ePA_026 Aufrufparameter der Operation I_Authorization::getAuthorizationKey

TABLE(rows=3,cols=120+239+182)->
TR-> TH(0,0/1/1)->PAR Parameter TH(0,1/1/1)->PAR Inhalt TH(0,2/1/1)->PAR Beschreibung
TR-> TD(1,0/1/1)->PAR RecordIdentifier TD(1,1/1/1)->PAR [RecordIdentifier der Aktensession] TD(1,2/1/1)->PAR Kennung der Versichertenakte, auf die zugegriffen werden soll
TR-> TD(2,0/1/1)->PAR SAML:Assertion TD(2,1/1/1)->PAR [AuthenticationAssertion der Aktensession] TD(2,2/1/1)->PAR SAML2-Token zur Authentifizierung des Nutzers (LEI oder Versicherter) beim ePA-Aktensystem
PAR <b>[<=]</b>

PAR Legende:

LIST->
LITEM->PAR Inhalte in eckigen Klammern ([...]) sind ihrer Beschreibung nach zu ersetzen.LITEM->PAR Die Parameter sind der Spezifikation [gemSpec_Autorisierung] entnommen.
REQ(ids=A_14243)<b>A_14243 - FM ePA: Autorisierung Aktensession - Fehler - keine Autorisierung vorhanden</b>
PAR Falls beim Aufruf der Operation I_Authorization::getAuthorizationKey eines Aktendienstes des Versicherten keine Berechtigung für den Nutzer im Aktenkonto hinterlegt ist (ACCESS_DENIED, KEY_ERROR), MUSS das Fachmodul ePA die Operation mit dem Code 7209 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

REQ(ids=A_14024)<b>A_14024 - FM ePA: Autorisierung Aktensession - Fehler</b>
PAR Wurde die Operation I_Authorization::getAuthorizationKey eines Aktendienstes des Versicherten mit einem anderen Fehler als ACCESS_DENIED, oder KEY_ERROR beendet, dann MUSS das Fachmodul ePA die Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR Weitere Fehlerrückgaben der Operation I_Authorization_Management::getAuthorizationKey werden in [gemSpec_Autorisierung] spezifiziert.
PAR Schlüsselableitung und Entschlüsselung von Akten- und Kontextschlüssel
PAR Die Schlüsselableitung und Entschlüsselung von Akten- und Kontextschlüssel ist in Kap. 6.5.6- Schlüsselableitung beschrieben.
PAR Benachrichtigung des Primärsystem über bestehende Berechtigungen zum Zugriff auf ein Aktenkonto
REQ(ids=A_15134)<b>A_15134 - FM ePA: Autorisierung Aktensession - Benachrichtigung an das Primärsystem</b>
PAR Wurde die Operation I_Authorization::getAuthorizationKey zur Autorisierung der LEI erfolgreich aufgerufen MUSS das Fachmodul ePA unter Verwendung des Systeminformationsdienstes des Konnektors ein Event mit folgendem Inhalt erzeugen:

TABLE(rows=7,cols=135+413)->
TR-> TH(0,0/1/1)->PAR Parameter TH(0,1/1/1)->PAR Inhalt
TR-> TD(1,0/1/1)->PAR Topic TD(1,1/1/1)->PAR FM_EPA/POLICY_LEI
TR-> TD(2,0/1/1)->PAR Type TD(2,1/1/1)->PAR Operation
TR-> TD(3,0/1/1)->PAR Severity TD(3,1/1/1)->PAR Info
TR-> TD(4,0/1/1)->PAR TelematikID TD(4,1/1/1)->PAR [Telematik-ID der Aktensession]
TR-> TD(5,0/1/1)->PAR RecordID TD(5,1/1/1)->PAR [RecordIdentifier der Aktensession]
TR-> TD(6,0/1/1)->PAR ValidTo TD(6,1/1/1)->PAR [Inhalt aus Attribut validTo von AuthorizationKey.<br>Die Zeit wird mit dem Datentyp DateTime in folgendem Format angegeben:<br> yyyy-mm-ddThh:mm:ss+hh:mm<br> Es ist – gemäß ISO 8601 [ISO8601] – die lokale Zeit und die Differenz zur UTC anzugeben.]
PAR <b>[<=]</b>

PAR Das Element validTo macht eine Aussage über die zeitliche Gültigkeit der übertragenen Schlüssel. Somit kann das Event bei einer Abonnierung durch ein Primärsystem verwendet werden, um Informationen über die zeitliche Gültigkeit der Berechtigung der LEI durch den Versicherten zu erhalten.
PAR -HEADING(ids=6.5.5)6.5.5 Verbindung zur Dokumentenverwaltung
PAR Alle Operationen des Webservices PHRService sowie die Operatione RequestFacilityAuthorization benötigen einen initialisierten Aktenkontext in der Dokumentenverwaltung, d.h. eine Verbindung zum Verarbeitungskontext der Vertrauenswürdigen Ausführungsumgebung (VAU) des Versicherten wie in [gemSpec_Dokumentenverwaltung#4.4] beschrieben. Das Fachmodul ePA muss dafür eine TLS-Verbindung zur Komponente Dokumentenverwaltung des Aktensystems, in welchem das Aktenkonto des Versicherten liegt, aufbauen. Die Dokumente des Aktenkontos werden zwischen dem Fachmodul ePA und dem Verarbeitungskontext der VAU in einem sicheren Kanal auf HTTP-Anwendungsschicht gemäß [gemSpec_Krypt#6.1] übertragen.
PAR Die Schnittstelle der Dokumentenverwaltung wird in [gemSpec_Dokumentenverwaltung#5.4] spezifiziert.
PAR Aufbau der TLS-Verbindung
REQ(ids=A_15531)<b>A_15531 - FM ePA: Dokumentenverwaltung - TLS-Verbindung zur Komponente Dokumentenverwaltung aufbauen</b>
PAR Das Fachmodul ePA MUSS zur Kommunikation mit der Komponente Dokumentenverwaltung eine TLS-Verbindung aufbauen bzw. eine bestehende TLS-Verbindung nutzen. <b>[<=]</b>

REQ(ids=A_15532)<b>A_15532 - FM ePA: Dokumentenverwaltung - TLS mit Zertifikats- und Rollenprüfung</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der TLS-Verbindung zur Komponente Dokumentenverwaltung eine Zertifikats- und Rollenprüfung für das Zertifikatsprofil C.FD.TLS-S gemäß [gemSpec_PKI] mit der Rolle oid_epa_dvw gemäß [gemSpec_OID#] durchführen. <b>[<=]</b>

REQ(ids=A_15533)<b>A_15533 - FM ePA: Dokumentenverwaltung - Verwendung der lokalisierten URI</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der TLS-Verbindung zur Komponente Dokumentenverwaltung deren lokalisierte Adresse verwenden. <b>[<=]</b>

PAR Aufbau eines sicheren Kanals auf HTTP-Anwendungsschicht zum Verarbeitungskontext der VAU
REQ(ids=A_15199)<b>A_15199 - FM ePA: Dokumentenverwaltung - sichere Verbindung zur VAU - Verfahren</b>
PAR Das Fachmodul ePA MUSS für die Kommunikation mit der Schnittstelle I_Document_Management_Connect der Komponente Dokumentenverwaltung eine sichere Verbindung zum Verarbeitungskontext der VAU aufbauen, gemäß den Vorgaben aus [gemSpec_Krypt#3.15 und #6.1]. <b>[<=]</b>

REQ(ids=A_15200)<b>A_15200 - FM ePA: Dokumentenverwaltung - sichere Verbindung zur VAU - Aufrufparameter</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der sicheren Verbindung zum Verarbeitungskontext der VAU die AuthorizationAssertion aus der Aktensession der vom Primärsystem aufgerufenen Operation als Parameter gemäß  übergeben.
PAR <b>[<=]</b>

REQ(ids=A_15210)<b>A_15210 - FM ePA: Dokumentenverwaltung - sichere Verbindung zur VAU mit Zertifikats- und Rollenprüfung</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der sicheren Verbindung zum Verarbeitungskontext der VAU eine Zertifikats- und Rollenprüfung für das vom Verarbeitungskontext empfangene Zertifikat C.FD.AUT gemäß [gemSpec_PKI] mit der Rolle oid_epa_vau gemäß [gemSpec_OID#] durchführen.
PAR <b>[<=]</b>

REQ(ids=A_15211)<b>A_15211 - FM ePA: Dokumentenverwaltung - sichere Verbindung zur VAU - Fehler</b>
PAR Falls beim Aufbau der sicheren Verbindung zum Verarbeitungskontext der VAU ein Fehler auftritt, MUSS das Fachmodul ePA die Operation mit dem Code 7202 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR Wie der Aufbau der sicheren Verbindung zum Verarbeitungskontext der VAU erfolgt, ist in [gemSpec_Krypt#3.15] beschrieben.
REQ(ids=A_14647)<b>A_14647 - FM ePA: Dokumentenverwaltung - Initialisierung des Aktenkontexts</b>
PAR Das Fachmodul ePA MUSS vor Nutzung der Schnittstelle I_Document_Management der Komponente Dokumentenverwaltung sicherstellen, dass der entsprechende Aktenkontext mittels der Operation I_Document_Management_Connect::OpenContext initialisiert wurde.
PAR <b>[<=]</b>

REQ(ids=A_14649)<b>A_14649 - FM ePA: Dokumentenverwaltung - Verwendung des Kontextschlüssels</b>
PAR Das Fachmodul ePA MUSS beim Aufruf der Operation I_Document_Management_Connect::OpenContext der Komponente Dokumentenverwaltung den entschlüsselten Kontextschlüssel aus der Aktensession der vom Primärsystem aufgerufenen Operation als Parameter übergeben. <b>[<=]</b>

PAR Nach dem erfolgreichen Aufruf der Operation OpenContext für ein Aktenkonto, kann das Fachmodul mittels IHE-Transaktionen auf Dokumente im ePA-Aktensystem zugreifen. Im Falle einer Aktivierung des Aktenkontos (Aufruf der Operation ActivateAccount) sind Akten- und Kontextschlüssel noch nicht vorhanden und müssen vor der Initialisierung erzeugt werden (vgl. Operation ActivateAccount im Webservice PHRManagementService).
REQ(ids=A_14650)<b>A_14650 - FM ePA: Dokumentenverwaltung - Initialisierung des Aktenkontexts - Fehler in der Dokumentenverwaltung</b>
PAR Falls bei der Kommunikation mit der Komponente Dokumentenverwaltung zur Initialisierung des Aktenkontexts ein Fehler TECHNICAL_ERROR auftritt, MUSS das Fachmodul ePA die Operation mit dem Code 7215 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

REQ(ids=A_17119)<b>A_17119 - FM ePA: Dokumentenverwaltung - Initialisierung des Aktenkontexts - Fehler</b>
PAR Falls bei der Kommunikation mit der Komponente Dokumentenverwaltung zur Initialisierung des Aktenkontexts ein anderer Fehler als TECHNICAL_ERROR auftritt, MUSS das Fachmodul ePA die Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen.<br><b>[<=]</b>

PAR Weitere Fehlerrückgaben der Operation I_Document_Management_Connect::OpenContext werden in [gemSpec_Autorisierung] spezifiziert.
PAR Dies trifft auch zu, falls kein Schlüsselmaterial vorhanden ist.
PAR -HEADING(ids=6.5.6)6.5.6 Schlüsselableitung
PAR Akten- und Kontextschlüssel werden doppelt symmetrisch verschlüsselt in der Komponente Autorisierung des Aktensystems hinterlegt. Die symmetrischen Schlüssel zur Ver- und Entschlüsselung von Akten- und Kontextschlüssel werden über die Schlüsselableitungsfunktion der SGDs 1 und 2 ermittelt. Die Funktionsweise der Schlüsselgenerierung, die die Basis für die Ver- und Entschlüsselung von Akten- und Kontextschlüssel ist, wird in [gemSpec_SGD_ePA] beschrieben.
PAR Das Element phrs:AuthorizationKey/phrs:EncryptedKeyContainer enthält das Chiffrat mit dem doppelt verschlüsselten Akten- und Kontextschlüssel sowie AssociatedData.<br>Die Datenstruktur für EncryptedKeyContainer und die Klartextpräsentation für Akten- und Kontextschlüssel ist in [gemSpec_SGD_ePA#8 - Interoperables Austauschformat] beschrieben.
PAR Aufbau der TLS-Verbindung
REQ(ids=A_18011)<b>A_18011 - FM ePA: Schlüsselableitung - TLS-Verbindung zu SGD 1 und 2 aufbauen</b>
PAR Das Fachmodul ePA MUSS zur Kommunikation mit SGD 1 und 2 jeweils eine TLS-Verbindung aufbauen bzw. eine bestehende TLS-Verbindung nutzen.
PAR <b>[<=]</b>

REQ(ids=A_18012)<b>A_18012 - FM ePA: Schlüsselableitung- TLS mit Zertifikats- und Rollenprüfung</b>
PAR Das Fachmodul ePA MUSS beim Aufbau der TLS-Verbindung zu SGD 1 und 2 eine Zertifikats- und Rollenprüfung für das Zertifikatsprofil C.FD.TLS-S gemäß [gemSpec_PKI] mit der Rolle oid_sgd gemäß [gemSpec_OID#GS-A_4446] durchführen.<br><b>[<=]</b>

REQ(ids=A_17966)<b>A_17966 - FM ePA: Schlüsselableitung - Ablauf</b>
PAR Zur Schlüsselableitung MUSS das Fachmodul ePA den in [gemSpec_SGD_ePA#2.3] festgelegten Ablauf durchführen.<br><b>[<=]</b>

PAR In den Schritten 12 und 18 des Basisablaufs erfolgt der Aufruf für KeyDerivation abhängig vom Anwendungsfall.
REQ(ids=A_17870)<b>A_17870 - FM ePA:Schlüsselableitung - Fehler im Schlüsselgenerierungsdienst</b>
PAR Falls beim Abruf der AES-Schlüssel von SGD 1 bzw. 2 gemäß [gemSpec_SGD_ePA] einer der Fehler "certificate not valid" oder "signature not valid" auftritt, MUSS das Fachmodul ePA die aufgerufene Operation in Abhängigkeit der beim Login verwendeten Karte mit folgendem Code abbrechen:

LIST->
LITEM->PAR Login (Authentisierung) mit eGK: Code 106 gemäß Tab_FM_ePA_051LITEM->PAR Login (Authentisierung) mit SM-B: Code 7221 gemäß Tab_FM_ePA_011.
PAR <b>[<=]</b>

REQ(ids=A_17871)<b>A_17871 - FM ePA: Schlüsselableitung - Fehler an der Schnittstelle zum Schlüsselgenerierungsdienst</b>
PAR Falls beim Abruf der AES-Schlüssel gemäß [gemSpec_SGD_ePA] ein anderer Fehler als "certificate not valid" oder "signature not valid" auftritt, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 7215 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR Als Ergebnis bei einer erfolgreichen Schlüsselableitung zum Verschlüsseln erhält das Fachmodul ePA von jedem der beiden SGD eine Antwortnachricht für KeyDerivation im Format: "OK-KeyDerivation "+Key+" "+a.<br>Key ist der für die Verschlüsselung zu verwendende symmetrische Schlüssel und a entspricht AssociatedData für den entsprechenden SGD.
PAR Festlegungen zur Verschlüsselung von Akten- und Kontextschlüssel
REQ(ids=A_17992)<b>A_17992 - FM ePA: Schlüsselableitung - Ermittlung von AssociatedData</b>
PAR Falls bei der Erteilung einer Berechtigung (Operation ActivateAccount, Operation RequestFacilityAuthorization) der Aufruf der Operation KeyDerivation beim SGD zur Schlüsselableitung erfolgreich war MUSS das Fachmodul ePA den Wert phrs:AuthorizationKey/phrs:EncryptedKeyContainer/phrs:AssociatedData gemäß [gemSpec_SGD_ePA#8 ] mit dem Inhalt aus 'a' der Antwortnachrichten befüllen.<br><b>[<=]</b>

PAR Zur Erteilung einer Berechtigung unter Verwendung der Operation ActivateAccount wird der Anwendungsfall gemSpec_SGD_ePA#2.4 betrachtet.<br>Zur Erteilung einer Berechtigung unter Verwendung der Operation RequestFacilityAuthorization werden die Anwendungsfälle gemSpec_SGD_ePA#2.6 und gemSpec_SGD_ePA#2.8 betrachtet.
PAR Die konkrete Verwendung der Schlüsselableitung zur Verschlüsselung von Akten- und Kontextschlüssel ist in den Kapiteln zur Umsetzung der Operationen ActivateAccount und RequestFacilityAuthorization beschrieben.
REQ(ids=A_18007)<b>A_18007 - Schlüsselableitung bei Verschlüsselung - Verschlüsselung mit Verschlüsselungsdienst</b>
PAR Das Fachmodul ePA MUSS beim Erstellen eines AuthorizationKeys den Akten- und Kontextschlüssel mit den von der Schlüsselableitung mit SGD 1 und SGD 2 erhaltenen symmetrischen Schlüssel unter Berücksichtigung der Strukturen in [gemSpec_SGD_ePA#8 ] unter Berücksichtigung der Reihenfolge wie folgt verschlüsseln:<br> <b>[<=]</b>

PAR Festlegungen zur Entschlüsselung von Akten- und Kontextschlüssel
PAR I_Authorization::getAuthorizationKey liefert abhängig von der Telematik-ID bzw. KVNR der übertragenen AuthenticationAssertion das Chiffrat für einen berechtigten Nutzer mit Akten- und Kontextschlüssel, die Information durch wen die Berechtigung erfolgte und eine dazu passende AuthorizationAssertion. Das Fachmodul ePA kann im nächsten Schritt das Chiffrat entschlüsseln und Akten- und Kontextschlüssel liegen im Klartext vor und können verwendet werden.
REQ(ids=A_17869)<b>A_17869 - FM ePA: Schlüsselableitung bei Entschlüsselung - Entschlüsselung mit Verschlüsselungsdienst</b>
PAR Falls AuthorizationKey für den authentisierten Nutzer von der Komponente Autorisierung abgerufen werden konnte, MUSS das Fachmodul ePA die AES-Schlüssel von den beiden SGDs abrufen und damit Akten- und Kontextschlüssel unter Berücksichtigung der Strukturen in [gemSpec_SGD_ePA#8] wie folgt unter Berücksichtigung der Reihenfolge entschlüsseln:<br><br><b>[<=]</b>

REQ(ids=A_17986)<b>A_17986 - FM ePA: Schlüsselableitung bei Entschlüsselung- Abhängigkeit von der Rolle</b>
PAR Bei der Entschlüsselung von Akten- und Kontextschlüssel MUSS das Fachmodul ePA bei Durchführung der Schlüsselableitung die Operation KeyDerivation gemäß Anwendungsfall gemSpec_SGD_ePA#2.5,2.7,2.9 aufrufen.<br><b>[<=]</b>

REQ(ids=A_17993)<b>A_17993 - FM ePA: Schlüsselableitung bei Entschlüsselung - Verwendung von AssociatedData</b>
PAR Bei der Entschlüsselung von Akten- und Kontextschlüssel MUSS das Fachmodul ePA das Element phrs:AuthorizationKey/phrs:EncryptedKeyContainer/phrs:AssociatedData des ermittelten AuthorizationKey für den Aufruf der Operation KeyDerivation beim SGD wie folgt verwenden:<br>KeyDerivation <Teilstring aus AssociatedData als Ableitungsinformationen für den entsprechenden SGD><br><b>[<=]</b>

PAR Die Ermittlung der Ableitungsinformation für SGD1 und SGD2 ist in [gemSpec_SGD_ePA#8 ] beschrieben.
PAR Zur Optimierung der Performance muss das Fachmodul die Schlüsselableitung für SGD 1 (Basisablauf Schritt 1) und SGD 2 (Basisablauf Schritt 3) und das Erzeugen eines ephemeren ECDH-Schlüsselpaares (Basisablauf Schritt 5) parallel ausführen. Der Request an SGD 1 und der Request an SGD 2 in Basisablauf Schritt 7 können ebenfalls parallelisiert werden (siehe [gemSpec_SGD_ePA#A_17925 ]) . Die bei einer Schlüsselableitung für eine Entschlüsselung im Request für KeyDerivation zu übermittelnden Informationen werden sowohl für SGD 1 als auch SGD 2 dem Element phrs:AuthorizationKey/phrs:EncryptedKeyContainer/phrs:AssociatedData entnommen.
REQ(ids=A_17736)<b>A_17736 - FM ePA: Schlüsselableitung bei Entschlüsselung - Fehler bei der Entschlüsselung</b>
PAR Falls der Basiskonnektor bei der Entschlüsselung von Akten- und Kontextschlüssel einen Fehler zurückgibt, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

PAR -HEADING(ids=6.6)6.6 Logout
PAR Das Fachmodul ePA stellt einen impliziten Logout für die Aktensession bereit, welcher nach einem Timeout bei Inaktivität bzgl. der Nutzung einer Aktensession ausgeführt wird. Es veranlasst die Löschung der zur Aktensession gehörenden Verbindungsdaten in der VAU und löscht anschließend die Aktensession. Falls noch weitere Verbindungen anderer Aktensessions in die VAU bestehen, bleiben diese aktiv (vgl. I_Document_Management_Connect::CloseContext gemäß [gemSpec_Dokumentenverwaltung]).
REQ(ids=A_14169)<b>A_14169 - FM ePA: Logout Aktensession - Löschung der Verbindung zur VAU</b>
PAR Falls auf eine Aktensession länger als 20 Minuten nicht zugegriffen wird, MUSS das Fachmodul ePA die Operation I_Document_Management_Connect::CloseContext gemäß [I_Document_Management_Connect_Service.wsdl] des zugehörigen ePA-Aktensystems aufrufen. <b>[<=]</b>

REQ(ids=A_14651)<b>A_14651 - FM ePA: Logout Aktensession - Löschung der Aktensession</b>
PAR Falls auf eine Aktensession länger als 20 Minuten nicht zugegriffen wird, MUSS das Fachmodul ePA die Aktensession beenden und alle dazugehörigen Daten löschen. <b>[<=]</b>

PAR Das Fachmodul hat die Option, eine vom Zugangsgateway abgerufene AuthenticationAssertion zu erneuern und muss daher, falls ein Logout erfolgt, als zusätzliche Sicherheitsmaßnahme die Möglichkeit zur Erneuerung der aktuellen AuthenticationAssertion mittels der Operation AuthInsurantService::LogoutToken verhindern.
REQ(ids=A_17450)<b>A_17450 - FM ePA: Logout Aktensession - Unterbindung der Erneuerung der AuthenticationAssertion</b>
PAR Falls eine Aktensession beendet wird, MUSS das Fachmodul ePA die Operation AuthInsurantService::LogoutToken der Komponenten Zugangsgateway aufrufen.
PAR <b>[<=]</b>

PAR Da die Löschung der Aktensession nicht innerhalb einer vom Clientsystem aufgerufenen Operation ausgeführt wird, kann ein aufgetretener Fehler auch nicht an das Clientsystem zurückgegeben werden. Der Fehler muss dennoch protokolliert werden.
REQ(ids=A_17451)<b>A_17451 - FM ePA: Logout Aktensession - Unterbindung der Erneuerung der AuthenticationAssertion - Fehler</b>
PAR Falls die Operation AuthInsurantService::LogoutToken gemäß [gemSpec_Authentisierung_Vers] einen Fehler zurückgibt, MUSS das Fachmodul ePA diesen Fehler im Sicherheitsprotokoll eintragen. <br>​​
PAR <b>[<=]</b>

REQ(ids=A_17142)<b>A_17142 - FM ePA: Logout Aktensession - Löschung der Verbindung zur VAU - Fehler</b>
PAR Falls die Operation I_Document_Management_Connect::CloseContext einen Fehler zurückgibt, MUSS das Fachmodul ePA diesen Fehler im Sicherheitsprotokoll eintragen.
PAR <b>[<=]</b>

PAR -HEADING(ids=6.7)6.7 Datenschutz und Sicherheitsaspekte
REQ(ids=A_14173)<b>A_14173 - FM ePA: Sicherheit - Keine persistente Speicherung von personenbezogenen Daten</b>
PAR Das Fachmodul ePA DARF personenbezogene Daten NICHT persistent speichern. <b>[<=]</b>

REQ(ids=A_14722)<b>A_14722 - FM ePA: Sicherheit - Keine persistente Speicherung von Dokumenten und Metadaten</b>
PAR Das Fachmodul ePA DARF Dokumente und Metadaten der Patientenakte NICHT persistent speichern. <b>[<=]</b>

REQ(ids=A_14174)<b>A_14174 - FM ePA: Sicherheit - Keine Speicherung von privaten Schlüsseln</b>
PAR Das Fachmodul ePA DARF symmetrische und private asymmetrische Schlüssel (z.B. Dokumentenschlüssel, Aktenschlüssel) NICHT persistent speichern. <b>[<=]</b>

REQ(ids=A_14175)<b>A_14175 - FM ePA: Sicherheit - Keine Weitergabe vertraulicher Informationsobjekte an das PS</b>
PAR Das Fachmodul ePA DARF Schlüsselmaterial und Daten der Aktensession NICHT an das PS weitergegeben. <b>[<=]</b>

PAR Regelungen aus [gemSpec_Krypt]
PAR Für die Erzeugung von Schlüsselmaterial gilt übergreifend [gemSpec_Krypt#GS-A_4368].
PAR Regelungen für TLS-Verbindungen
PAR Für TLS-Verbindungen gelten die Regelungen aus [gemSpec_Krypt#3.3.2].
PAR -HEADING(ids=6.8)6.8 Verwendung des Dienstverzeichnisdienstes
REQ(ids=A_13828)<b>A_13828 - FM ePA: Service-Informationen für Dienstverzeichnisdienste</b>
PAR Während der Bootup-Phase des Konnektors MUSS das Fachmodul ePA die in Tab_FM_ePA_007 gemäß dem XML-Schema [ServiceInformation.xsd] definierten Services in den Dienstverzeichnisdienst des Konnektors [gemSpec_Kon#4.1.3] einbringen.
PAR Tabelle 9: Tab_FM_ePA_007 Service-Informationen der Services des Fachmoduls ePA

TABLE(rows=9,cols=185+171+184)->
TR-> TH(0,0/1/1)->PAR Element/Attribut TH(0,1/1/1)->PAR PHRService TH(0,2/1/1)->PAR PHRManagementService
TR-> TD(1,0/1/1)->PAR ServiceInformation/Service  <br>/@Name TD(1,1/1/1)->PAR PHRService TD(1,2/1/1)->PAR PHRManagementService
TR-> TD(2,0/1/1)->PAR ServiceInformation/Service  <br>/Abstract TD(2,1/1/1)->PAR IHE-Schnittstelle zur Dokumentenverwaltung TD(2,2/1/1)->PAR Schnittstelle zur Administration und Rechtevergabe der Akte
TR-> TD(3,0/1/1)->PAR ServiceInformation/Service/Versions  <br>/Version/@TargetNamespace TD(3,1/1/1)->PAR aktueller <br>Namensraumbezeichner gemäß Tab_FM_ePA_005 TD(3,2/1/1)->PAR aktueller Namensraumbezeichner gemäß  Tab_FM_ePA_003
TR-> TD(4,0/1/1)->PAR ServiceInformation/Service/Versions  <br>/Version/@Version TD(4,1/1/1)->PAR aktuelle Versionsnummer gemäß Tab_FM_ePA_005 TD(4,2/1/1)->PAR aktuelle Versionsnummer gemäß Tab_FM_ePA_003 
TR-> TD(5,0/1/1)->PAR ServiceInformation/Service/Versions  <br>/Version/Abstract TD(5,1/1/1)->PAR Initiale Version TD(5,2/1/1)->PAR Initiale Version
TR-> TD(6,0/1/1)->PAR ServiceInformation/Service/Versions  <br>/Version/Endpoint/@Location TD(6,1/1/1)->PAR Absoluter URL des über <br>Hypertext Transfer Protocol <br>(HTTP) erreichbaren Dienstes TD(6,2/1/1)->PAR Absoluter URL des über <br>Hypertext Transfer Protocol <br>(HTTP) erreichbaren Dienstes
TR-> TD(7,0/1/1)->PAR ServiceInformation/Service/Versions  <br>/Version/EndpointTLS/@Location TD(7,1/1/1)->PAR Absoluter URL des über <br>HTTP Secure (HTTPS) <br>erreichbaren Dienstes TD(7,2/1/1)->PAR Absoluter URL des über <br>HTTP Secure (HTTPS) <br>erreichbaren Dienstes
TR-> TD(8,0/1/1)->PAR ServiceInformation/Service/Versions  <br>/Version/WSDL/@Location   TD(8,1/1/1)->PAR <leer> TD(8,2/1/1)->PAR <leer>
PAR ​​
PAR <b>[<=]</b>

PAR -HEADING(ids=6.9)6.9 Protokollierung und Logging
PAR Während die Protokollierung der Zugriffe nach §291a im ePA-Aktensystem erfolgt, legt das Fachmodul ePA Log-Informationen im Konnektor ab, die eine Analyse technischer Vorgänge erlauben. Diese Dateien sind dafür vorgesehen, aufgetretene Fehler zu identifizieren, die Performance zu analysieren und interne Abläufe zu beobachten. Um die Anforderungen an den Datenschutz zu gewährleisten, dürfen weder medizinische noch personenbezogene Daten geloggt werden.
REQ(ids=A_14154)<b>A_14154 - FM ePA: Verbot des Logging von Schlüsselmaterial</b>
PAR Das Fachmodul ePA DARF symmetrisches und privates Schlüsselmaterial NICHT loggen. <b>[<=]</b>

REQ(ids=A_14155)<b>A_14155 - FM ePA: Verbot des Logging von medizinischen und personenbezogenen Daten</b>
PAR Das Fachmodul ePA DARF medizinische und personenbezogene Daten NICHT loggen. <b>[<=]</b>

PAR Die Log-Dateien folgen einem einheitlichen Format, das vom Hersteller festgelegt und dokumentiert wird. Es muss geeignet sein, um automatische Auswertungen mit wenig Aufwand durch Dritte zu ermöglichen. Ein Vorbild ist das Weblog des Apache Webservers. Um mehrere Protokolleinträge korrelieren zu können, soll beim Aufruf einer Operation an den Schnittstellen eine Vorgangsnummer gebildet werden. Diese Vorgangsnummer wird in allen Protokolleinträgen dieses Operationsaufrufs genutzt. Die Vorgangsnummer wird vom Konnektor pseudozufällig gebildet.
REQ(ids=A_14156)<b>A_14156 - FM ePA: Einheitliches Log-Format</b>
PAR Das Fachmodul ePA MUSS Log-Dateien in einem einheitlichen, dokumentierten Format erstellen, das eine automatisierte Auswertung ermöglicht.
PAR <b>[<=]</b>

REQ(ids=A_14157)<b>A_14157 - FM ePA: Korrelation von Log-Einträgen</b>
PAR Das Fachmodul ePA MUSS sicherstellen, dass sich alle zu einem Operationsaufruf zugehörigen Log-Einträge über eine Vorgangsnummer korrelieren lassen. <b>[<=]</b>

PAR Der Zugriff auf Log-Dateien muss auf autorisierte Personen durch angemessene technische oder organisatorische Maßnahmen eingeschränkt werden. Zur besseren Auswertung können die Log-Dateien auf ein separates Speichermedium kopiert werden (siehe [gemSpec_Kon#TIP1-A_4716]).
REQ(ids=A_14711)<b>A_14711 - FM ePA: Fachmodulprotokoll</b>
PAR Das Fachmodul ePA MUSS ein Fachmodulprotokoll gemäß dem Protokollierungsdienst des Konnektors führen. <b>[<=]</b>

REQ(ids=A_14712)<b>A_14712 - FM ePA: Fachmodul-Performance-Protokoll</b>
PAR Das Fachmodul ePA MUSS ein Fachmodul-Performance-Protokoll gemäß dem Protokollierungsdienst des Konnektors führen. <b>[<=]</b>

REQ(ids=A_17228)<b>A_17228 - FM ePA: Fachmodulprotokoll (Fehler)</b>
PAR Das Fachmodul ePA MUSS unabhängig vom ErrorType alle lokal erkannten und Remote-Fehler der Severity „Warning“, „Error“ oder „Fatal“ im Fachmodulprotokoll mit mindestens den folgenden Parametern erfassen:
PAR (ids=Tabelle-10)Tabelle 10: Tab_FM_ePA_014 Parameter des Fehlerprotokolls

TABLE(rows=8,cols=125+320)->
TR-> TH(0,0/1/1)->PAR Feld TH(0,1/1/1)->PAR Beschreibung
TR-> TD(1,0/1/1)->PAR eventType TD(1,1/1/1)->PAR „Op“
TR-> TD(2,0/1/1)->PAR Schwere TD(2,1/1/1)->PAR „Warning“, „Error“, „Fatal“
TR-> TD(3,0/1/1)->PAR Vorgangsnummer TD(3,1/1/1)->PAR Zeichenkette zur Korrelation der zugehörigen Protokolleinträge
TR-> TD(4,0/1/1)->PAR Zeitpunkt TD(4,1/1/1)->PAR Zeitpunkt der Erstellung des Protokolleintrags
TR-> TD(5,0/1/1)->PAR Fehlercode TD(5,1/1/1)->PAR Fehlercode des aufgetretenen Fehlers
TR-> TD(6,0/1/1)->PAR CardHandle TD(6,1/1/1)->PAR CardHandle der betroffenen eGK
TR-> TD(7,0/1/1)->PAR Fehlerdetails TD(7,1/1/1)->PAR Weiterführende Details zum Fehler
PAR <b>[<=]</b>

REQ(ids=A_17229)<b>A_17229 - FM ePA: Fachmodulprotokoll (Debug)</b>
PAR Das Fachmodul ePA MUSS für Testzwecke im Fachmodulprotokoll Debug-Einträge mit mindestens den folgenden Parametern erfassen:
PAR (ids=Tabelle-11)Tabelle 11: Tab_FM_ePA_015 Parameter des Debug-Protokolls

TABLE(rows=3,cols=157+404)->
TR-> TH(0,0/1/1)->PAR Feld TH(0,1/1/1)->PAR Beschreibung
TR-> TD(1,0/1/1)->PAR eventType TD(1,1/1/1)->PAR „Op“
TR-> TD(2,0/1/1)->PAR Schwere TD(2,1/1/1)->PAR „Debug“
PAR <b>[<=]</b>

REQ(ids=A_17230)<b>A_17230 - FM ePA: Sicherheitsprotokoll</b>
PAR Das Fachmodul ePA MUSS sicherheitsrelevante Fehler und Ereignisse über den Protokollierungsdienst des Konnektors im Sicherheitsprotokoll des Konnektors mindestens mit den folgenden Parametern erfassen:
PAR (ids=Tabelle-12)Tabelle 12: Tab_FM_ePA_022 Parameter des Sicherheitsprotokolls

TABLE(rows=7,cols=124+312)->
TR-> TH(0,0/1/1)->PAR Feld TH(0,1/1/1)->PAR Beschreibung
TR-> TD(1,0/1/1)->PAR eventType TD(1,1/1/1)->PAR „Sec“
TR-> TD(2,0/1/1)->PAR Schwere TD(2,1/1/1)->PAR „Info“, „Warning“, „Error“, „Fatal“
TR-> TD(3,0/1/1)->PAR Vorgangsnummer TD(3,1/1/1)->PAR Zeichenkette zur Korrelation der zugehörigen Protokolleinträge
TR-> TD(4,0/1/1)->PAR Name der Operation TD(4,1/1/1)->PAR Name der untersuchten Operation
TR-> TD(5,0/1/1)->PAR Bezeichnung TD(5,1/1/1)->PAR Bezeichnung des sicherheitsrelevanten Fehlers oder Ereignisses
TR-> TD(6,0/1/1)->PAR Beschreibung TD(6,1/1/1)->PAR Details des sicherheitsrelevanten Fehlers oder Ereignisses
PAR <b>[<=]</b>

REQ(ids=A_17231)<b>A_17231 - FM ePA: Performanceprotokoll</b>
PAR Das Fachmodul ePA MUSS alle zur Kontrolle der Performancevorgaben benötigten, mindestens aber die nachfolgenden, Parameter der Operationsaufrufe im Performanceprotokoll erfassen:
PAR (ids=Tabelle-13)Tabelle 13: Tab_FM_ePA_024 Parameter des Performanceprotokolls

TABLE(rows=7,cols=125+320)->
TR-> TH(0,0/1/1)->PAR Feld TH(0,1/1/1)->PAR Beschreibung
TR-> TD(1,0/1/1)->PAR eventType TD(1,1/1/1)->PAR „Perf“
TR-> TD(2,0/1/1)->PAR Vorgangsnummer TD(2,1/1/1)->PAR Zeichenkette zur Korrelation der zugehörigen Protokolleinträge
TR-> TD(3,0/1/1)->PAR Name der Operation TD(3,1/1/1)->PAR Name der untersuchten Operation
TR-> TD(4,0/1/1)->PAR Startzeitpunkt TD(4,1/1/1)->PAR Startzeitpunkt der Operation
TR-> TD(5,0/1/1)->PAR Dauer TD(5,1/1/1)->PAR Dauer der Operation in ms
TR-> TD(6,0/1/1)->PAR Beschreibung TD(6,1/1/1)->PAR Ergänzende Informationen zur gemessenen Aktion
PAR <b>[<=]</b>

PAR Hinweis: Der Parameter „Schwere“ wird für einen Eintrag im Performanceprotokoll nicht verwendet.
PAR -HEADING(ids=6.10)6.10 Konfiguration
REQ(ids=A_17227)<b>A_17227 - FM ePA: Übergreifende Konfigurationsparameter</b>
PAR Das Fachmodul ePA MUSS die in Tabelle Tab_FM_ePA_010 genannten Parameter dem Administrator über die Managementschnittstelle des Konnektors zur Konfiguration anbieten.
PAR (ids=Tabelle-14)Tabelle 14: Tab_FM_ePA_010 Übergreifende Konfigurationsparameter des Fachmodules ePA

TABLE(rows=4,cols=132+85+231)->
TR-> TH(0,0/1/1)->PAR ReferenzID TH(0,1/1/1)->PAR Belegung TH(0,2/1/1)->PAR Bedeutung
TR-> TD(1,0/1/1)->PAR FM_EPA_LOG_LEVEL TD(1,1/1/1)->PAR Debug, Info, Warning, Error, Fatal TD(1,2/1/1)->PAR Kleinster Level der zu schreibenden Einträge im Fachmodulprotokoll (d.h., kleinere Level werden nicht geschrieben)<br>Default-Wert: Warning
TR-> TD(2,0/1/1)->PAR FM_EPA_LOG_DAYS TD(2,1/1/1)->PAR X Tage TD(2,2/1/1)->PAR Anzahl an Tagen, wie lange Protokolleinträge gespeichert werden müssen; Protokolleinträge dürfen nicht länger gespeichert werden.<br>Dabei darf der eingestellte Wert nicht unter der Mindestgröße von 10 Tagen oder über der Maximalgröße von einem Jahr (365 Tage) liegen.<br>Default-Wert: 180
TR-> TD(3,0/1/1)->PAR FM_EPA_LOG_PERF TD(3,1/1/1)->PAR Boolean TD(3,2/1/1)->PAR Gibt an, ob das Performance-Protokoll für das Fachmodul ePA geführt werden soll.<br>Default-Wert: false
PAR <b>[<=]</b>

PAR Die Einsicht von Protokolldateien und Administration der Konfigurationsparameter erfolgen über die Managementschnittstelle des Konnektors (vgl. [gemSpec_Kon#4.3.4]).
PAR -HEADING(ids=6.11)6.11 Fehlerbehandlung und Fehlermeldungen
PAR Fehlerkonzept
PAR Einige Operationen des Fachmoduls müssen möglicherweise mehrere oder sogar alle ePA-Aktensysteme anfragen, um ihre Funktionalität durchführen zu können. GetHomeCommunityID iteriert beispielsweise über alle bekannten ePA-Aktensysteme, bis ein ePA-Aktensystem gefunden wird, dass die Akte zur angefragten KVNR führt. Dabei könnten die ePA-Aktensysteme verschiedene Fehler zurückgeben oder aufgrund eines technischen Problems nicht erreichbar sein. Die einzelnen Operationen reagieren fachlich nicht einheitlich auf diese Situation. Während ein nicht erreichbares ePA-Aktensystem für GetHomeCommunity nicht zwingend ein Problem darstellt, falls etwa ein anderes ePA-Aktensystem die Akte führt, gibt GetAuthorizationList in diesem Falle eine Warnung aus, da möglicherweise nicht alle Berechtigungen der LEI abgerufen werden konnten.
PAR Die Methodik in diesem Dokument sieht in diesem Kapitel eine übergreifende Behandlung der Fehler vor, falls alle Anfragen an das ePA-Aktensystem oder seine Komponenten, die zwingend zur Durchführung einer Operation oder Funktionalität benötigt werden, fehlschlagen. Diese Anforderungen greifen also auch, falls nur die Kommunikation mit einem einzigen ePA-Aktensystem notwendig ist. Alle weiteren Situationen werden jeweils in den Unterkapiteln der Operationen behandelt. Falls unterschiedliche Probleme innerhalb einer Operation auftreten, liefert diese Operation dann ggfs. einen allgemeinen Fehler an das aufrufende System zurück, da eine Differenzierung der Fehlersituationen schnell unübersichtlich und für den Nutzer nicht hilfreich ist. Jeder Fehlercode wird dann aber im Fachmodulprotokoll abgelegt und erlaubt so eine genaue Analyse.
PAR Übergreifende Festlegungen zu Fehlermeldungen
PAR Treten bei der Ausführung einer Operation Fehler auf, die zum Abbruch der Operation führen, so werden diese an das aufrufende System über eine SOAP-Fault-Nachricht gemeldet. Im Erfolgsfalle oder bei Fehlern, die nicht zum Abbruch der Operation führen, wird ein Status-Element gemäß [gemSpec_Kon#3.5.2] zurückgegeben.
PAR Für das Fehlermanagement gelten neben den hier aufgeführten spezifischen Anforderungen die Anforderungen aus Kapitel 3 der übergreifenden Spezifikation [gemSpec_OM#3].
REQ(ids=A_14405)<b>A_14405 - FM ePA: Übergreifende Anforderung - Fehlermeldungen des Webservice PHRManagementService (SOAP-Fault)</b>
PAR Das Fachmodul ePA MUSS Fehler, die bei Operationen des Webservice PHRManagementService auftreten, mittels gematik-SOAP-Fault an das aufrufende System melden. <b>[<=]</b>

PAR Details zu gematik-SOAP-Faults finden sich in [gemSpec_OM#3.2.3]. Der Code 7400 wird für Fehlerfälle verwendet, die technisch bedingt sind und durch den Nutzer nicht behoben werden können. Diese Fehlerfälle erfordern eine Analyse und Behebung durch den Anbieter.
REQ(ids=A_14406)<b>A_14406 - FM ePA: Übergreifende Anforderung - Allgemeine Fehlerbehandlung</b>
PAR Falls nicht durch andere Anforderungen geregelt, MUSS das Fachmodul ePA einen Operationsaufruf im Fehlerfall mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

REQ(ids=A_15675)<b>A_15675 - FM ePA: Übergreifende Anforderung - Syntaxprüfung bei Aufrufen von Webservices - Fehler</b>
PAR Falls bei Aufruf einer Operation der Webservices PHRManagementService oder PHRService die Syntaxprüfung fehlschlägt, MUSS das Fachmodul ePA den Operationsaufruf mit dem Code 4000 gemäß Tab_FM_ePA_050 abbrechen.
PAR <b>[<=]</b>

PAR Hinweis: Die Syntaxprüfung der Operationsaufrufe von PHRService und PHRManagementService ist durch die normative Beschreibung mittels WSDL-Dateien bedingt (Kapitel 7.1 PHRService und 7.2 PHRManagementService).
REQ(ids=A_17724)<b>A_17724 - FM ePA: Übergreifende Anforderung - Verbot der Rückgabe von Implementierungsdetails</b>
PAR Das Fachmodul ePA DARF in Fehlermeldungen KEINE Informationen über die Implementierung schreiben, z.B. Teile des Programm-Stack-Traces. <b>[<=]</b>

PAR Übergreifende Fehlercodes
PAR Die nachfolgenden Tabellen enthalten

LIST->
LITEM->PAR Fehlermeldungen der übergreifenden Festlegungen des Fachmoduls ePA,LITEM->PAR Fehlermeldungen zu Situationen, die in mehreren Operationen auftreten (und in den entsprechenden Unterkapiteln behandelt  werden),LITEM->PAR Fehlermeldungen, die aus anderen Spezifikationen nachgenutzt werden.
PAR (ids=Tabelle-15)Tabelle 15: Tab_FM_ePA_011 Übergreifende Fehlermeldungen des Fachmoduls ePA

TABLE(rows=23,cols=45+63+66+357)->
TR-> TH(0,0/1/1)->PAR Code TH(0,1/1/1)->PAR ErrorType TH(0,2/1/1)->PAR Severity TH(0,3/1/1)->PAR Fehlertext
TR-> TD(1,0/1/1)->PAR 7200 TD(1,1/1/1)->PAR Technical TD(1,2/1/1)->PAR ERROR TD(1,3/1/1)->PAR Lokalisierung des Aktensystems fehlgeschlagen
TR-> TD(2,0/1/1)->PAR 7202 TD(2,1/1/1)->PAR Security TD(2,2/1/1)->PAR ERROR TD(2,3/1/1)->PAR Verbindung zum Aktensystem fehlgeschlagen
TR-> TD(3,0/1/1)->PAR 7203 TD(3,1/1/1)->PAR Security TD(3,2/1/1)->PAR ERROR TD(3,3/1/1)->PAR Die gegenseitige Authentisierung von eGK und SMC-B (Card-to-Card-Authentisierung) ist gescheitert.
TR-> TD(4,0/1/1)->PAR 7205 TD(4,1/1/1)->PAR Technical TD(4,2/1/1)->PAR ERROR TD(4,3/1/1)->PAR Es konnte kein freigeschaltetes SM-B mit einem zulässigen Institutionstyp  gefunden werden.
TR-> TD(5,0/1/1)->PAR 7206 TD(5,1/1/1)->PAR Technical TD(5,2/1/1)->PAR ERROR TD(5,3/1/1)->PAR Prüfung der Zugriffsberechtigung fehlgeschlagen
TR-> TD(6,0/1/1)->PAR 7207 TD(6,1/1/1)->PAR Technical TD(6,2/1/1)->PAR ERROR TD(6,3/1/1)->PAR PIN-Verifikation gescheitert
TR-> TD(7,0/1/1)->PAR 7209 TD(7,1/1/1)->PAR Technical TD(7,2/1/1)->PAR ERROR TD(7,3/1/1)->PAR Keine Berechtigung für das Aktenkonto vorhanden
TR-> TD(8,0/1/1)->PAR 7210 TD(8,1/1/1)->PAR Technical TD(8,2/1/1)->PAR ERROR TD(8,3/1/1)->PAR Die Berechtigung kann nicht hinterlegt werden.
TR-> TD(9,0/1/1)->PAR 7211 TD(9,1/1/1)->PAR Technical TD(9,2/1/1)->PAR ERROR TD(9,3/1/1)->PAR Dokument überschreitet maximal zulässige Größe von 25 MB
TR-> TD(10,0/1/1)->PAR 7212 TD(10,1/1/1)->PAR Technical TD(10,2/1/1)->PAR ERROR TD(10,3/1/1)->PAR Summe der Dokumente überschreitet maximal zulässige Größe von 250 MB
TR-> TD(11,0/1/1)->PAR 7213 TD(11,1/1/1)->PAR Technical TD(11,2/1/1)->PAR ERROR TD(11,3/1/1)->PAR Sperrstatus des Zertifikats der eGK nicht ermittelbar
TR-> TD(12,0/1/1)->PAR 7214 TD(12,1/1/1)->PAR Security TD(12,2/1/1)->PAR ERROR TD(12,3/1/1)->PAR Das Schlüsselmaterial der Akte entspricht nicht den Sicherheitsanforderungen.
TR-> TD(13,0/1/1)->PAR 7215 TD(13,1/1/1)->PAR Technical TD(13,2/1/1)->PAR ERROR TD(13,3/1/1)->PAR Fehler im Aktensystem - Die Operation konnte nicht durchgeführt werden.
TR-> TD(14,0/1/1)->PAR 7217 TD(14,1/1/1)->PAR Technical TD(14,2/1/1)->PAR ERROR TD(14,3/1/1)->PAR Die Operation wurde am Kartenterminal abgebrochen.
TR-> TD(15,0/1/1)->PAR 7220 TD(15,1/1/1)->PAR Infrastructure TD(15,2/1/1)->PAR ERROR TD(15,3/1/1)->PAR Aktensystem nicht erreichbar
TR-> TD(16,0/1/1)->PAR 7221 TD(16,1/1/1)->PAR Security TD(16,2/1/1)->PAR ERROR TD(16,3/1/1)->PAR Zertifikat auf SMC-B ungültig
TR-> TD(17,0/1/1)->PAR 7400 TD(17,1/1/1)->PAR Technical TD(17,2/1/1)->PAR ERROR TD(17,3/1/1)->PAR Fehler - Die Operation konnte nicht durchgeführt werden.
TR-> TD(18,0/1/1)->PAR 7402 TD(18,1/1/1)->PAR  Technical TD(18,2/1/1)->PAR WARNING TD(18,3/1/1)->PAR Das Aktenkonto ist bereits eingerichtet.
TR-> TD(19,0/1/1)->PAR 7403 TD(19,1/1/1)->PAR Technical TD(19,2/1/1)->PAR ERROR TD(19,3/1/1)->PAR Das Aktenkonto kann noch nicht verwendet werden.
TR-> TD(20,0/1/1)->PAR 7404 TD(20,1/1/1)->PAR Technical TD(20,2/1/1)->PAR ERROR TD(20,3/1/1)->PAR Das Aktenkonto existiert nicht (mehr) in diesem ePA-Aktensystem.
TR-> TD(21,0/1/1)->PAR 7405 TD(21,1/1/1)->PAR Technical TD(21,2/1/1)->PAR WARNING TD(21,3/1/1)->PAR Das Aktenkonto wurde bei diesem ePA-Aktensystem gekündigt, kann aber aktuell noch benutzt werden.
TR-> TD(22,0/1/1)->PAR 7406 TD(22,1/1/1)->PAR Technical TD(22,2/1/1)->PAR WARNING TD(22,3/1/1)->PAR Das Aktenkonto wurde bei diesem ePA-Aktensystem gekündigt und ist nur noch für einen Kontowechsel lesend zugreifbar.
PAR (ids=Tabelle-16)Tabelle 16: Tab_FM_ePA_050 Wiederverwendete Fehlermeldungen aus der Konnektorspezifikation

TABLE(rows=6,cols=0+0+0)->
TR-> TH(0,0/1/1)->PAR Code TH(0,1/1/1)->PAR Referenz TH(0,2/1/1)->PAR Bedeutung (informativ)
TR-> TD(1,0/1/1)->PAR 4008 TD(1,1/1/1)->PAR [gemSpec_Kon#TAB_KON_515] TD(1,2/1/1)->PAR Karte nicht gesteckt
TR-> TD(2,0/1/1)->PAR 4063 TD(2,1/1/1)->PAR [gemSpec_Kon#TAB_KON_089] TD(2,2/1/1)->PAR PIN gesperrt
TR-> TD(3,0/1/1)->PAR 4065 TD(3,1/1/1)->PAR [gemSpec_Kon#TAB_KON_089] TD(3,2/1/1)->PAR PIN transportgeschützt
TR-> TD(4,0/1/1)->PAR 4093 TD(4,1/1/1)->PAR [gemSpec_Kon#TAB_KON_824] TD(4,2/1/1)->PAR Karte bereits exklusiv verwendet
TR-> TD(5,0/1/1)->PAR 4000 TD(5,1/1/1)->PAR [gemSpec_Kon#TAB_KON_567] TD(5,2/1/1)->PAR Syntaxfehler beim Aufruf einer Operation
PAR (ids=Tabelle-17)Tabelle 17: Tab_FM_ePA_051 Wiederverwendete Fehlermeldungen aus der Übergreifenden Spezifikation Operations und Maintenance

TABLE(rows=4,cols=0+0+0)->
TR-> TH(0,0/1/1)->PAR Code TH(0,1/1/1)->PAR Referenz TH(0,2/1/1)->PAR Bedeutung (informativ)
TR-> TD(1,0/1/1)->PAR 106 TD(1,1/1/1)->PAR [gemSpec_OM#Tab_Gen_Fehler] TD(1,2/1/1)->PAR Zertifikat auf eGK ungültig
TR-> TD(2,0/1/1)->PAR 114 TD(2,1/1/1)->PAR [gemSpec_OM#Tab_Gen_Fehler] TD(2,2/1/1)->PAR DF.HCA gesperrt
TR-> TD(3,0/1/1)->PAR 115 TD(3,1/1/1)->PAR [gemSpec_OM#Tab_Gen_Fehler] TD(3,2/1/1)->PAR Leseversuch von veralteter eGK
PAR -HEADING(ids=7)7 Funktionsmerkmale
PAR Das Fachmodul ePA wird in zwei Funktionsmerkmale unterteilt, die je über eine Schnittstelle realisiert werden:
PAR (ids=Tabelle-18)Tabelle 18: Tab_FM_ePA_004 Schnittstellenübersicht des Fachmoduls ePA

TABLE(rows=14,cols=127+194+220)->
TR-> TH(0,0/1/1)->PAR Schnittstelle TH(0,1/1/2)->PAR Beschreibung und Operationen
TR-> TD(1,0/7/1)->PAR PHRService TD(1,1/1/2)->PAR IHE-Schnittstelle zur Dokumentenverwaltung
TR-> TD(2,1/1/1)->PAR Logische Operation TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR putDocuments TD(3,2/1/1)->PAR Dokumente einstellen
TR-> TD(4,1/1/1)->PAR find TD(4,2/1/1)->PAR Dokumente suchen
TR-> TD(5,1/1/1)->PAR getDocuments TD(5,2/1/1)->PAR Dokumente herunterladen
TR-> TD(6,1/1/1)->PAR removeDocuments TD(6,2/1/1)->PAR Dokumente löschen
TR-> TD(7,1/1/1)->PAR updateDocumentSet TD(7,2/1/1)->PAR Metadaten von Dokumenten ändern
TR-> TD(8,0/6/1)->PAR PHRManagementService TD(8,1/1/2)->PAR Schnittstelle zur Aktivierung und Rechtevergabe
TR-> TD(9,1/1/1)->PAR Logische Operation TD(9,2/1/1)->PAR Beschreibung
TR-> TD(10,1/1/1)->PAR ActivateAccount TD(10,2/1/1)->PAR Aktivierung eines Aktenkontos
TR-> TD(11,1/1/1)->PAR RequestFacilityAuthorization TD(11,2/1/1)->PAR Berechtigungsvergabe für eine LEI
TR-> TD(12,1/1/1)->PAR GetHomeCommunityID TD(12,2/1/1)->PAR Identifizierung eines ePA-Aktensystems
TR-> TD(13,1/1/1)->PAR GetAuthorizationList TD(13,2/1/1)->PAR Abruf aller Berechtigungen einer LEI
PAR Die Operationen von PHRService erlauben das Einstellen, Suchen, Herunterladen und Löschen von Dokumenten sowie die Aktualisierung von Metadaten. Die zum Aufruf benötigte HomeCommunity als Teil des RecordIdentifiers können Primärsysteme über die Operation GetHomeCommunityID des Webservices PHRManagementService beziehen. Dieser Webservice erlaubt es außerdem einem Versicherten, in der LE-Umgebung sein Aktenkonto zu aktivieren und eine Leistungserbringerinstitution ad-hoc zu berechtigen (Operation RequestFacilityAuthorization). Eine LEI kann ihre Berechtigungen für Aktenkonten abrufen und aktualisieren, sowie die alternativen Versichertenidentitäten der Versicherten berechtigen.
PAR Die Webservices werden vom Fachmodul ePA im Dienstverzeichnis des Konnektors registriert und damit für Primärsysteme auffindbar gemacht (siehe Kapitel 6.8 Verwendung des Dienstverzeichnisdienstes).
PAR -HEADING(ids=7.1)7.1 PHRService
PAR Der Webservice PHRService setzt die logische Schnittstelle I_PHR_Management gemäß [gemSysL_ePA] um.
REQ(ids=A_14373)<b>A_14373 - FM ePA: PHRService</b>
PAR Das Fachmodul ePA MUSS für Primärsysteme den Webservice PHRService gemäß Tabelle Tab_FM_ePA_005 anbieten.
PAR Tabelle 19: Tab_FM_ePA_005 Beschreibung des Webservices PHRService

TABLE(rows=16,cols=128+107+305)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR PHRService
TR-> TD(1,0/1/1)->PAR Version TD(1,1/1/2)->PAR 1.0.0
TR-> TD(2,0/5/1)->PAR SOAP-Header TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Inhalt
TR-> TD(3,1/1/1)->PAR MandantID TD(3,2/1/1)->PAR MandantID gemäß [ConnectorContext.xsd]
TR-> TD(4,1/1/1)->PAR ClientSystemID TD(4,2/1/1)->PAR ClientSystemID gemäß [ConnectorContext.xsd]
TR-> TD(5,1/1/1)->PAR WorkplaceID TD(5,2/1/1)->PAR WorkplaceID gemäß [ConnectorContext.xsd]
TR-> TD(6,1/1/1)->PAR RecordIdentifier TD(6,2/1/1)->PAR RecordIdentifier gemäß [gemSpec_DM_ePA#2.2]
TR-> TD(7,0/1/1)->PAR Namensraum TD(7,1/1/2)->PAR urn:ihe:iti:xds-b:2007
TR-> TD(8,0/1/1)->PAR Abkürzung Namensraum TD(8,1/1/2)->PAR ihe
TR-> TD(9,0/6/1)->PAR Operationen TD(9,1/1/1)->PAR Name (logisch) TD(9,2/1/1)->PAR IHE-Umsetzung der Schnittstelle
TR-> TD(10,1/1/1)->PAR putDocuments TD(10,2/1/1)->PAR [ITI-41] "ProvideAndRegisterDocumentSet-b" als Akteur "Document Recipient" gemäß XDR mit der Option "Transmit Home Community Id"
TR-> TD(11,1/1/1)->PAR find TD(11,2/1/1)->PAR [ITI-18] "Registry Stored Query" als Akteur "Initiating Gateway" gemäß XCA
TR-> TD(12,1/1/1)->PAR getDocuments TD(12,2/1/1)->PAR [ITI-43] "Retrieve Document Set" als Akteur "Initiating Gateway" gemäß XCA
TR-> TD(13,1/1/1)->PAR removeDocuments TD(13,2/1/1)->PAR [ITI-86] "Remove Documents" als Akteur "Document Repository" gemäß RMD
TR-> TD(14,1/1/1)->PAR updateDocumentSet TD(14,2/1/1)->PAR [ITI-92] "Restricted Update Document Set" als Akteur "RMU Update Responder" gemäß RMU mit der Option "Forward"
TR-> TD(15,0/1/1)->PAR WSDL TD(15,1/1/2)->PAR PHRService.wsdl
PAR ​​
PAR <b>[<=]</b>

PAR Der SOAP-Header ermöglicht es dem Webservice, die Zugriffsberechtigungsprüfung durchzuführen (Kapitel 6.4 Aufrufkontext) und einen SM-B für den Zugriff auf die Akte des Versicherten auszuwählen (Kapitel 6.5 Login).
REQ(ids=A_14376)<b>A_14376 - FM ePA: PHRService - Fehlermeldungen gemäß IHE</b>
PAR Falls nicht durch andere Anforderungen geregelt, MUSS der Webservice PHRService die Fehlermeldungen der Profile in Tabelle Tab_FM_ePA_002 zurückgeben.
PAR <b>[<=]</b>

REQ(ids=A_14377)<b>A_14377 - FM ePA: PHRService - Fehlermeldungen gemäß IHE-Mapping</b>
PAR Der Webservice PHRService MUSS alle Fehler aus Tab_FM_ePA_011 als IHE-Fehler nach Tab_FM_ePA_012 abbilden und in der IHE-Response eingebettet an das aufrufende System zurückgeben.
PAR Tabelle 20: Tab_FM_ePA_012 Mapping von gematik-Fehlern nach IHE-Fehlern

TABLE(rows=5,cols=191+356)->
TR-> TH(0,0/1/1)->PAR Fehlerattribut nach gematik-Schema TH(0,1/1/1)->PAR Fehlerattribut gemäß IHE-Profilen
TR-> TD(1,0/1/1)->PAR Code TD(1,1/1/1)->PAR errorCode
TR-> TD(2,0/1/1)->PAR Fehlertext TD(2,1/1/1)->PAR codeContext
TR-> TD(3,0/1/1)->PAR Severity TD(3,1/1/1)->PAR severity
TR-> TD(4,0/1/1)->PAR Keine Entsprechung TD(4,1/1/1)->PAR location
PAR ​​
PAR <b>[<=]</b>

REQ(ids=A_14874)<b>A_14874 - FM ePA: PHRService - Mapping für Fehlerkategorie "Fatal"</b>
PAR Der Webservice PHRService MUSS den gematik-Fehlerwert "Fatal" im Feld "Severity" für IHE auf den Wert "Error" in "severity" abbilden. <b>[<=]</b>

PAR -HEADING(ids=7.1.1)7.1.1 Definition/Signatur
PAR Dieses Unterkapitel beschreibt die in [PHRService.wsdl] definierten Methoden, d.h. Aufruf- und Rückgabeparameter sowie alle möglichen Fehlermeldungen.
PAR -HEADING(ids=7.1.1.1)7.1.1.1 putDocuments
PAR (ids=Tabelle-21)Tabelle 21: Tab_FM_ePA_006 Beschreibung und Parameter der Operation putDocuments

TABLE(rows=6,cols=161+162+215)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR putDocuments
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Diese Operation ermöglicht Primärsystemen das Einstellen von Dokumenten in das ePA-Aktensystem.
TR-> TD(2,0/2/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR ProvideAndRegisterDocumentSetRequest TD(3,2/1/1)->PAR Der Parameter enthält die zu speichernden XDS-Dokumente und SubmissionSets inklusive Metadaten gemäß [PHRService.wsdl].
TR-> TD(4,0/2/1)->PAR Rückgabeparameter TD(4,1/1/1)->PAR Name TD(4,2/1/1)->PAR Beschreibung
TR-> TD(5,1/1/1)->PAR RegistryResponse TD(5,2/1/1)->PAR Der Parameter enthält den Status der aufgerufenen Operation und Informationen über eventuell aufgetretene Fehler gemäß [PHRService.wsdl].
PAR Fehlermeldungen
PAR Die Operation putDocuments kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202, 7205, 7206, 7209, 7211, 7212, 7214, 7215, 7220, 7221, 7400, 7403, 7404, 7406 gemäß Tab_FM_ePA_011LITEM->PAR 4000 gemäß Tab_FM_ePA_050LITEM->PAR reguläre bei IHE für [ITI-41] definierte Fehlermeldungen
PAR -HEADING(ids=7.1.1.2)7.1.1.2 find
PAR Die Operation find ermöglicht einem Primärsystem das Suchen von Inhalten (Dokumenten und SubmissionSets) im ePA-Aktensystem.
PAR (ids=Tabelle-22)Tabelle 22: Tab_FM_ePA_013 Beschreibung und Parameter der Operation find (Semantik)

TABLE(rows=6,cols=161+162+215)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR find
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Diese Operation ermöglicht Primärsystemen das Suchen von Dokumenten und SubmissionSets im ePA-Aktensystem.
TR-> TD(2,0/2/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR AdhocQueryRequest TD(3,2/1/1)->PAR Der Parameter enthält die gewünschte Suchanfrage ("Stored Query") inklusive Parametern gemäß [PHRService.wsdl].
TR-> TD(4,0/2/1)->PAR Rückgabeparameter TD(4,1/1/1)->PAR Name TD(4,2/1/1)->PAR Beschreibung
TR-> TD(5,1/1/1)->PAR AdhocQueryResponse TD(5,2/1/1)->PAR Der Parameter enthält die Suchergebnisse der aufgerufenen Operation und Informationen über eventuell aufgetretene Fehler gemäß [PHRService.wsdl].
PAR Fehlermeldungen
PAR Die Operation find kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202, 7205, 7206, 7209, 7214, 7215, 7220, 7221, 7400, 7403, 7404, 7406 gemäß Tab_FM_ePA_011LITEM->PAR 4000 gemäß Tab_FM_ePA_050LITEM->PAR reguläre bei IHE für [ITI-18] und [ITI-38] definierte Fehlermeldungen
PAR -HEADING(ids=7.1.1.3)7.1.1.3 getDocuments
PAR Die Operation getDocuments ermöglicht Primärsystemen das Herunterladen von Dokumenten aus dem ePA-Aktensystem.
PAR (ids=Tabelle-23)Tabelle 23: Tab_FM_ePA_027 Beschreibung und Parameter der Operation getDocuments (Semantik)

TABLE(rows=6,cols=161+162+215)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR getDocuments
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Diese Operation ermöglicht Primärsystemen das Herunterladen von Dokumenten aus dem ePA-Aktensystem.
TR-> TD(2,0/2/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR RetrieveDocumentSetRequest TD(3,2/1/1)->PAR Der Parameter enthält die gewünschte Download-Anfrage inklusive Parametern gemäß [PHRService.wsdl].
TR-> TD(4,0/2/1)->PAR Rückgabeparameter TD(4,1/1/1)->PAR Name TD(4,2/1/1)->PAR Beschreibung
TR-> TD(5,1/1/1)->PAR RetrieveDocumentSetResponse TD(5,2/1/1)->PAR Der Parameter enthält die angefragten Dokumente oder Fehler, falls ein oder mehrere Dokumente nicht abgerufen werden konnten gemäß [PHRService.wsdl].
PAR Fehlermeldungen
PAR Die Operation getDocuments kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202,7205, 7206, , 7209, 7211, 7212, 7214, 7215, 7220, 7221, 7400, 7403, 7404, 7406 gemäß Tab_FM_ePA_011LITEM->PAR 4000 gemäß Tab_FM_ePA_050LITEM->PAR reguläre bei IHE für [ITI-43] und [ITI-80] definierte Fehlermeldungen
PAR -HEADING(ids=7.1.1.4)7.1.1.4 removeDocuments
PAR Die Operation removeDocuments ermöglicht Primärsystemen das Löschen von Dokumenten aus dem ePA-Aktensystem.
PAR (ids=Tabelle-24)Tabelle 24: Tab_FM_ePA_029 Beschreibung und Parameter der Operation removeDocuments (Semantik)

TABLE(rows=6,cols=161+162+215)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR removeDocuments
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Diese Operation ermöglicht Primärsystemen das Löschen von Dokumenten aus dem ePA-Aktensystem.
TR-> TD(2,0/2/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR RemoveDocumentsRequest TD(3,2/1/1)->PAR Der Parameter enthält Referenzen auf die zu löschenden Dokumente gemäß [PHRService.wsdl].
TR-> TD(4,0/1/1)->PAR Rückgabeparameter TD(4,1/1/1)->PAR Name TD(4,2/1/1)->PAR Beschreibung
TR-> TD(5,0/1/1)-> TD(5,1/1/1)->PAR RegistryResponse TD(5,2/1/1)->PAR Der Parameter enthält den Status der aufgerufenen Operation und Informationen über eventuell aufgetretene Fehler gemäß [PHRService.wsdl].
PAR Die Unterstützung von [ITI-62] "Remove Metadata" ist nicht notwendig. Die Dokumentenverwaltung stellt sicher, dass sowohl Dokument als auch Metadaten gelöscht werden.
PAR Fehlermeldungen
PAR Die Operation removeDocuments kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202, 7205, 7206, 7209, 7214, 7215, 7220, 7221, 7400, 7403, 7404, 7406 gemäß Tab_FM_ePA_011LITEM->PAR 4000 gemäß Tab_FM_ePA_050LITEM->PAR reguläre bei IHE für [ITI-86] definierte Fehlermeldungen
PAR -HEADING(ids=7.1.1.5)7.1.1.5 updateDocumentSet
PAR Die Operation updateDocumentSet ermöglicht Primärsystemen, Metadaten bestehender Dokumente zu ändern.
PAR (ids=Tabelle-25)Tabelle 25: Tab_FM_ePA_031 Beschreibung und Parameter der Operation updateDocumentSet (Semantik)

TABLE(rows=6,cols=97+243+160)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR updateDocumentSet
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Diese Operation ermöglicht Primärsystemen das Ändern von Metadaten von Dokumenten.
TR-> TD(2,0/2/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR SubmitObjectsRequest TD(3,2/1/1)->PAR Der Parameter enthält Metadaten zu den zu aktualisierenden Dokumenten gemäß [PHRService.wsdl].
TR-> TD(4,0/2/1)->PAR Rückgabeparameter TD(4,1/1/1)->PAR Name TD(4,2/1/1)->PAR Beschreibung
TR-> TD(5,1/1/1)->PAR RegistryResponse TD(5,2/1/1)->PAR Der Parameter enthält die angefragten Dokumente oder Fehler, falls ein oder mehrere Dokumente nicht abgerufen werden konnten gemäß [PHRService.wsdl]. 
PAR Fehlermeldungen
PAR Die Operation updateDocumentSet kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202, 7205, 7206, 7209, 7214, 7215, 7220, 7221, 7400, 7403, 7404, 7406 gemäß Tab_FM_ePA_011LITEM->PAR 4000 gemäß Tab_FM_ePA_050LITEM->PAR reguläre bei IHE für [ITI-92] definierte Fehlermeldungen
PAR -HEADING(ids=7.1.2)7.1.2 Umsetzung
PAR Die Operationen des Webservices PHRService sind IHE-basierte Anfragen. Die Verarbeitung durch das Fachmodul ePA läuft im Wesentlichen für alle Operation gleich ab:

ORDERED-LIST->
LITEM->PAR Operationsaufruf vom Primärsystem entgegennehmen und Parameter prüfenLITEM->PAR Login wie in Kapitel 6.5 beschrieben (optional, falls noch nicht geschehen)LITEM->PAR Fachliche Transformation der Parameter (Verschlüsselung der Dokumente, Aktualisierung bestimmter Metadaten, etc.)LITEM->PAR SOAP Security Header setzenLITEM->PAR Weiterleitung der IHE-Transaktion an das ePA-AktensystemLITEM->PAR Antwort oder Fehlermeldung des ePA-Aktensystems entgegennehmenLITEM->PAR Antwort oder Fehlermeldung erstellen und an das aufrufende Primärsystem zurückgeben
PAR Übergreifende Anforderungen bei der Umsetzung des Webservices PHRService
REQ(ids=A_15191)<b>A_15191 - FM ePA: PHRService - Authentisierung mittels SM-B</b>
PAR Der Webservice PHRService MUSS sich zur Durchführung seiner Operationen mit einem über Aufrufkontext ausgewählten SM-B gegenüber dem Aktensystem authentisieren. <b>[<=]</b>

PAR Die Authentisierung mittels SM-B und der weitere Login-Prozess sind in Kapitel 6.5 Login beschrieben. Der Aufrufkontext wird mithilfe der SOAP-Header bestimmt.
REQ(ids=A_13964)<b>A_13964 - FM ePA: PHRService - SOAP Security Header</b>
PAR Vor der Weiterleitung an das ePA-Aktensystem MÜSSEN die Operationen des Webservices PHRService den SOAP Security Header mit der AuthenticationAssertion der authentifizierten LEI gemäß Kapitel 6.5 belegen. <b>[<=]</b>

PAR Der Begriff „Dokument“ bezeichnet im Folgenden das Originaldokument, welches in unverschlüsselter Form vom Primärsystem in einer IHE-Nachricht zur Ablage im Aktensystem übertragen wird.
REQ(ids=A_15626)<b>A_15626 - FM ePA: PHRService - Ver- und Entschlüsselung von Dokumenten - Fehler</b>
PAR Falls die Ver- oder Entschlüsselung von Dokumenten fehlschlägt, MUSS das Fachmodul ePA die ausgeführte Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

REQ(ids=A_16209)<b>A_16209 - FM ePA: PHRService - Maximale Größe eines Dokuments</b>
PAR Der Webservice PHRService MUSS ein Dokument mit einer Größe bis maximal 25 MB in einer Nachricht verarbeiten können. Die Größe eines Dokuments wird ohne Transportkodierung ermittelt. <b>[<=]</b>

REQ(ids=A_16210)<b>A_16210 - FM ePA: PHRService - Maximale Größe eines Dokuments - Fehler</b>
PAR Falls die Größe eines Dokuments die Größe von 25 MB in einer Nachricht übersteigt, dann MUSS der Webservice PHRService die Operation mit dem Code 7211 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

REQ(ids=A_16207)<b>A_16207 - FM ePA: PHRService - Maximale Größe aller Dokumente</b>
PAR Der Webservice PHRService MUSS die Summe der Dokumente mit einer Größe bis maximal 250 MB in einer Nachricht verarbeiten können. Die Größe eines Dokuments wird ohne Transportkodierung ermittelt. <b>[<=]</b>

REQ(ids=A_16208)<b>A_16208 - FM ePA: PHRService - Maximale Größe aller Dokumente - Fehler</b>
PAR Falls die Summe der Dokumente die Größe von 250 MB in einer Nachricht übersteigt, dann MUSS der Webservice PHRService die Operation mit dem Code 7212 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR -HEADING(ids=7.1.2.1)7.1.2.1 putDocuments
PAR Die Weiterleitung der Anfragen an die Komponente Dokumentenverwaltung und der Antworten der Dokumentenverwaltung zurück an das Primärsystem erreicht das Fachmodul ePA durch die Gruppierung von IHE-Akteuren. Dazu nimmt das Fachmodul ePA die Anfrage als XDR „Document Recipient" vom Primärsystem entgegen und leitet sie anschließend an die Komponente Dokumentenverwaltung via [ITI-80] "Cross-Gateway Document Provide" in der Rolle eines XCDR Initiating Gateway an das ePA-Aktensystem weiter (vgl. hierzu[gemSpec_DM_ePA#Abbildung 2]).  Das ePA-Aktensystem setzt dementsprechend ein XCDR Responding Gateway um. Die Antworten nehmen den umgekehrten Weg.
PAR Die Gruppierung von XCDR- und XDR-Akteur wird durch das XCDR-Profil erzwungen.
REQ(ids=A_14353)<b>A_14353 - FM ePA: putDocuments - Gruppierung von IHE-Akteuren</b>
PAR Die Operation putDocuments Webservice PHRService MUSS die IHE-Akteure XDR Document Recipient [IHE-ITI-TF] und XCDR Initiating Gateway [IHE-ITI-XCDR] gruppieren. <b>[<=]</b>

REQ(ids=A_15763)<b>A_15763 - FM ePA: PHR_Service: Weiterleiten einer putDocuments-Anfrage</b>
PAR Das Fachmodul ePA MUSS jede Operation putDocuments an das Dokumentenverwaltungssystem über die Operation I_Document_Management::CrossGatewayDocumentProvide gemäß [ITI-80] „Cross-Gateway Document Provide" als IHE-XCDR-Akteur „Initiating Gateway“ weiterleiten. <b>[<=]</b>

REQ(ids=A_15764)<b>A_15764 - FM ePA: PHR_Service: Weiterleiten von putDocuments-Antwort</b>
PAR Das Fachmodul ePA MUSS die Antwort der Dokumentenverwaltung auf eine Anfrage des Fachmoduls gemäß [ITI-80] „Cross-Gateway Document Provide" als gruppierter IHE XCDR-Akteur „Initiating Gateway" [IHE-ITI-XCDR] / IHE-XDR-Akteur „Document Recipient" [IHE-ITI-TF] an das Primärsystem weiterleiten. <b>[<=]</b>

PAR Die Antwort der Dokumentenverwaltung auf eine Fachmodulanfrage gemäß [ITI-80] „Cross-Gateway Document Provide" enthält keinerlei Metadatenfelder, die vor der Weiterleitung an das anfragende Primärsystem einer Transformation bedürfen.
PAR Dokumentenverschlüsselung
REQ(ids=A_13907)<b>A_13907 - FM ePA: putDocuments - Verschlüsselung der Dokumente</b>
PAR Die Operation putDocuments MUSS jedes in der Nachricht übertragene Dokument vor der Weiterleitung an das ePA-Aktensystem durch eine Datenstruktur gemäß [gemSpec_DM_ePA#2.4] ersetzen. <b>[<=]</b>

REQ(ids=A_18008)<b>A_18008 - FM ePA: putDocuments - Verschlüsselung der Dokumente mit Verschlüsselungsdienst</b>
PAR Bei der Verschlüsselung des Dokuments MUSS die Operation putDocuments das Dokument und den Dokumentenschlüssel wie folgt verschlüsseln:<br><br><b>[<=]</b>

REQ(ids=A_13903)<b>A_13903 - FM ePA: putDocuments - Löschen der Dokumentenschlüssel</b>
PAR Die Operation putDocuments MUSS alle Dokumentenschlüssel nach ihrer Verschlüsselung mit dem Aktenschlüssel löschen. <b>[<=]</b>

PAR -HEADING(ids=7.1.2.2)7.1.2.2 find
PAR Das Fachmodul ePA muss eine find-Anfrage, sofern sie den Anforderungen aus Kapitel 7.1.1.2 genügt, anschließend an das ePA-Aktensystem weiterleiten. Das Fachmodul ePA agiert dabei als XCA "Initiating Gateway", während das ePA-Aktensystem ein XCA-„Responding Gateway“ umsetzt (siehe Operation I_Document_Management::CrossGatewayQuery gemäß [gemSpec_Dokumentenverwaltung]). Die Antworten nehmen den umgekehrten Weg.
REQ(ids=A_15765)<b>A_15765 - FM ePA: PHR_Service: Weiterleiten einer find-Anfrage</b>
PAR Das Fachmodul ePA MUSS jede Operation find an das Dokumentenverwaltungssystem über die Schnittstelle I_Document_Management::CrossGatewayQuery gemäß [ITI-38] "Cross-Gateway Query" als IHE-XCA-Akteur „Initiating Gateway“ weiterleiten. <b>[<=]</b>

REQ(ids=A_15766)<b>A_15766 - FM ePA: PHR_Service: Weiterleiten von find-Antworten</b>
PAR Das Fachmodul ePA MUSS die Antwort der Dokumentenverwaltung auf eine I_PHR_Management::find-Anfrage des Fachmoduls gemäß [ITI-38] "Cross-Gateway Query" als IHE-XCA-Akteur „Initiating Gateway“ an das Primärsystem weiterleiten. <b>[<=]</b>

PAR -HEADING(ids=7.1.2.3)7.1.2.3 getDocuments
PAR Das Fachmodul ePA muss eine eingehende Primärsystemanfrage, sofern sie den Anforderungen aus Kapitel 7.1.1.3 genügt, anschließend an das ePA-Aktensystem weiterleiten. Das Fachmodul ePA agiert dabei als XCA "Initiating Gateway", während das ePA-Aktensystem ein XCA-„Responding Gateway“ umsetzt (siehe Operation I_Document_Management::CrossGatewayRetrieve in [gemSpec_Dokumentenverwaltung]).
REQ(ids=A_15767)<b>A_15767 - Weiterleiten einer getDocuments-Anfrage an das ePA-Aktensystem</b>
PAR Das Fachmodul ePA MUSS jede Operation getDocuments an das Dokumentenverwaltungssystem über die Operation I_Document_Management::CrossGatewayRetrieve gemäß [ITI-39] "Cross-Gateway Retrieve" als IHE-XCA-Akteur „Initiating Gateway“ weiterleiten. <b>[<=]</b>

REQ(ids=A_15768)<b>A_15768 - FM ePA: PHR_Service: Weiterleiten von getDocuments-Antworten</b>
PAR Das Fachmodul ePA MUSS die Antwort der Dokumentenverwaltung auf eine Anfrage des Fachmoduls gemäß [ITI-39] "Cross-Gateway Retrieve" als IHE-XCA-Akteur „Initiating Gateway“ an das Primärsystem weiterleiten. <b>[<=]</b>

PAR Dokumentenentschlüsselung
REQ(ids=A_14700)<b>A_14700 - FM ePA:getDocuments - Entschlüsselung der Dokumente</b>
PAR Die Operation getDocuments MUSS jedes übertragene Dokument (Datenstruktur gemäß A_14977) vor der Weiterleitung an das Primärsystem durch das jeweilige entschlüsselte Dokument (Ergebnis aus A_18009)  ersetzen.<br>​​
PAR <b>[<=]</b>

REQ(ids=A_18009)<b>A_18009 - FM ePA: getDocuments - Entschlüsselung der Dokumente mit Signaturdienst</b>
PAR Bei der Entschlüsselung des Dokuments MUSS die Operation getDocuments das Dokument und den Dokumentenschlüssel wie folgt entschlüsseln:<br><br><br><b>[<=]</b>

REQ(ids=A_14959)<b>A_14959 - FM ePA: getDocuments - Löschen der Dokumentenschlüssel</b>
PAR Die Operation getDocuments MUSS Dokumentenschlüssel nach ihrer Verwendung zur Entschlüsselung eines Dokuments löschen.
PAR <b>[<=]</b>

PAR -HEADING(ids=7.1.2.4)7.1.2.4 removeDocuments
PAR Die Weiterleitung der removeDocument-Anfragen an die Komponente Dokumentenverwaltung und der Antworten der Dokumentenverwaltung zurück an das Primärsystem erreicht das Fachmodul ePA durch die Kombination zweier IHE-Akteure. Dazu nimmt das Fachmodul ePA die Anfrage als IHE-Akteur RMD "Document Repository" vom Primärsystem entgegen und leitet sie anschließend in der Rolle eines RMD "Document Administrator" an das ePA-Aktensystem weiter (vgl. hierzu Abbildung Abb_FM_ePA_001 IHE-Akteure und Transaktionen der Fachanwendung ePA). Das ePA-Aktensystem setzt dementsprechend ein RMD Document Repository über die Schnittstelle removeDocuments um. Die Antworten nehmen den umgekehrten Weg.
PAR Diese Kombination beider Akteure ist deshalb notwendig, da IHE bislang keine explizite "Cross-Community"-Variante für das RMD-Profil spezifiziert hat.
REQ(ids=A_15769)<b>A_15769 - FM ePA: PHR_Service: Weiterleiten einer removeDocuments-Anfrage</b>
PAR Das Fachmodul ePA MUSS jede Operation removeDocuments an das Dokumentenverwaltungssystem über die Operation I_Document_Management::RemoveDocuments gemäß [ITI-86] "Remove Documents" als IHE-RMD-Akteur "Document Administrator“ weiterleiten. <b>[<=]</b>

REQ(ids=A_15770)<b>A_15770 - FM ePA: PHR_Service: Weiterleiten von removeDocuments-Antwort</b>
PAR Das Fachmodul ePA MUSS die Antwort der Dokumentenverwaltung auf eine I_Document_Management::RemoveDocuments-Anfrage des Fachmoduls gemäß [ITI-86] "Remove Documents" als kombinierter IHE RMD-Akteur „Document Administrator“ / IHE RMD-Akteur "Document Repository", beide gemäß [IHE-ITI-RMD], an das Primärsystem weiterleiten. <b>[<=]</b>

PAR Es müssen keine Metadaten in Anfragen oder Antworten der Operation removeDocuments transformiert werden.
PAR -HEADING(ids=7.1.2.5)7.1.2.5 updateDocumentSet
PAR Die Weiterleitung der Anfragen an die Komponente Dokumentenverwaltung und der Antworten der Dokumentenverwaltung zurück an das Primärsystem erreicht das Fachmodul ePA durch die Gruppierung der IHE-Akteure RMU Update Responder und RMU Update Initiator. Dazu nimmt das Fachmodul ePA die Anfrage als Update Responder vom Primärsystem entgegen und leitet sie anschließend an die Komponente Dokumentenverwaltung via [ITI-92] "Restricted Update Document Set" in der Rolle eines RMU Update Initiator an das ePA-Aktensystem weiter (vgl. hierzu Abbildung Abb_FM_ePA_001 IHE-Akteure und Transaktionen der Fachanwendung ePA). Das ePA-Aktensystem setzt dementsprechend ein RMU Update Responder um. Die Antworten nehmen den umgekehrten Weg.
PAR Die Gruppierung von RMU Update Responder und RMU Update Initiator wird auch durch die "Forward Update"-Option des RMU Update Responders gemäß RMU-Profil erzwungen.
REQ(ids=A_15073)<b>A_15073 - FM ePA: PHRService - Gruppierung für updateDocumentSet</b>
PAR Die Operation updateDocumentSet MUSS die IHE-Akteure RMU Update Responder und RMU Update Initiator (beide gemäß [IHE-ITI-RMU]) gruppieren. <b>[<=]</b>

REQ(ids=A_15771)<b>A_15771 - PHR_Service: Weiterleiten einer updateDocumentSet-Anfrage</b>
PAR Das Fachmodul ePA MUSS jede Operation updateDocumentSet an das Dokumentenverwaltungssystem über die Operation I_Document_Management::UpdateDocumentSet gemäß [ITI-92] "Restricted Update Document Set" als IHE-RMU-Akteur „Update Initiator“ weiterleiten. <b>[<=]</b>

REQ(ids=A_15772)<b>A_15772 - FM ePA: PHR_Service: Weiterleiten von updateDocumentSet-Antwort</b>
PAR Das Fachmodul ePA MUSS die Antwort der Dokumentenverwaltung auf eine I_Document_Management::UpdateDocumentSet Anfrage des Fachmoduls gemäß [ITI-92] "Restricted Update Document Set" als gruppierter IHE-RMU-Akteur "Update Initiator" / IHE-RMU-Akteur "Update Responder", beide gemäß [IHE-ITI-RMU], an das Primärsystem weiterleiten. <b>[<=]</b>

PAR Die Antwort der Dokumentenverwaltung auf eine Fachmodulanfrage gemäß [ITI-92] "Cross-Gateway Document Provide" enthält keinerlei Metadatenfelder, die vor der Weiterleitung an das anfragende Primärsystem einer Transformation bedürfen.
PAR -HEADING(ids=7.2)7.2 PHRManagementService
PAR Der Webservice PHRManagementService setzt die logischen Schnittstellen I_Account_Administration und I_Authorization_Administration gemäß [gemSysL_ePA] um.
REQ(ids=A_13818)<b>A_13818 - FM ePA: PHRManagementService</b>
PAR Das Fachmodul ePA MUSS für Primärsysteme den Webservice PHRManagementService gemäß Tabelle Tab_FM_ePA_003 anbieten.
PAR (ids=Tabelle-26)Tabelle 26: Tab_FM_ePA_003 Beschreibung des Webservices PHRManagementService

TABLE(rows=10,cols=92+128+209)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR PHRManagementService
TR-> TD(1,0/1/1)->PAR Version TD(1,1/1/2)->PAR 1.0.0
TR-> TD(2,0/1/1)->PAR Namensraum TD(2,1/1/2)->PAR http://ws.gematik.de/conn/WSDL/PHRManagementService/v1.0http://ws.gematik.de/conn/WSDL/PHRManagementService/v1.0
TR-> TD(3,0/1/1)->PAR Abkürzung Namensraum TD(3,1/1/2)->PAR phr_management
TR-> TD(4,0/5/1)->PAR Operationen TD(4,1/1/1)->PAR Name TD(4,2/1/1)->PAR Beschreibung
TR-> TD(5,1/1/1)->PAR ActivateAccount TD(5,2/1/1)->PAR Aktivierung eines Aktenkontos
TR-> TD(6,1/1/1)->PAR RequestFacilityAuthorization TD(6,2/1/1)->PAR Berechtigungsvergabe für eine LEI
TR-> TD(7,1/1/1)->PAR GetHomeCommunityID TD(7,2/1/1)->PAR Identifizierung eines ePA-Aktensystems
TR-> TD(8,1/1/1)->PAR GetAuthorizationList TD(8,2/1/1)->PAR Abruf aller Berechtigungen einer LEI
TR-> TD(9,0/1/1)->PAR WSDL TD(9,1/1/2)->PAR PHRManagementService.wsdl
PAR Der Dienst wird vom Fachmodul ePA im Dienstverzeichnis des Konnektors registriert und damit für Primärsysteme auffindbar gemacht (siehe Kapitel 6.8 Verwendung des Dienstverzeichnisdienstes).
PAR <b>[<=]</b>

PAR -HEADING(ids=7.2.1)7.2.1 Definition/Signatur
PAR Dieses Unterkapitel beschreibt die in [PHRManagementService.wsdl] definierten Methoden, d.h. Aufruf- und Rückgabeparameter sowie alle möglichen Fehlermeldungen.
PAR -HEADING(ids=7.2.1.1)7.2.1.1 ActivateAccount
PAR (ids=Tabelle-27)Tabelle 27: Tab_FM_ePA_016 Beschreibung und Parameter der Operation ActivateAccount (Semantik)

TABLE(rows=8,cols=161+156+223)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR ActivateAccount
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Mit dieser Operation startet das Primärsystem die Aktivierung des beantragten Aktenkontos des Versicherten bei seinem Anbieter ePA-Aktensystem. Mithilfe des RecordIdentifier und der darin enthaltenen HomeCommunityID des Anbieters ePA-Aktensystem wird das Aktenkonto des Versicherten lokalisiert. Als Ergebnis der Operation wird die Zugriffsberechtigung für den Versicherten im ePA-Aktensystem hinterlegt.
TR-> TD(2,0/4/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR Context TD(3,2/1/1)->PAR Aufrufkontext gemäß [ConnectorContext.xsd]
TR-> TD(4,1/1/1)->PAR EhcHandle TD(4,2/1/1)->PAR eGK der Versicherten gemäß [gemSpec_Kon#4.1.1.1]
TR-> TD(5,1/1/1)->PAR RecordIdentifier TD(5,2/1/1)->PAR Kennung der Akte des Versicherten gemäß [gemSpec_DM_ePA#2.2]
TR-> TD(6,0/2/1)->PAR Rückgabeparameter TD(6,1/1/1)->PAR Name TD(6,2/1/1)->PAR Beschreibung
TR-> TD(7,1/1/1)->PAR Status TD(7,2/1/1)->PAR Status nach [gemSpec_Kon#3.5.2]
PAR Die Operation ActivateAccount kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202, 7203, 7205, 7206, 7207, 7213, 7215, 7220, 7400, 7402, 7403, 7404, 7405, 7406 gemäß Tab_FM_ePA_011LITEM->PAR Fehlermeldungen gemäß Tab_FM_ePA_050LITEM->PAR Fehlermeldungen gemäß Tab_FM_ePA_051
PAR -HEADING(ids=7.2.1.2)7.2.1.2 RequestFacilityAuthorization
PAR (ids=Tabelle-28)Tabelle 28: Tab_FM_ePA_020 Beschreibung und Parameter der Operation RequestFacilityAuthorization (Semantik)

TABLE(rows=11,cols=104+119+317)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR RequestFacilityAuthorization
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Die Operation startet den Autorisierungsprozess zur Berechtigungsvergabe für die Leistungserbringerinstitution in dem über RecordIdentifier referenzierten Aktenkonto des Versicherten. Die Berechtigung der Leistungserbringerinstitution erfolgt für eine vom Primärsystem angegebene AuthorizationConfiguration. Das Fachmodul ePA stellt die AuthorizationConfiguration am Kartenterminal dar und lässt sie vom Versicherten oder einem von ihm berechtigten Vertreter mittels PIN-Eingabe bestätigen. Als Ergebnis der Operation hat der Versicherte einer Leistungserbringerinstitution eine Zugriffsberechtigung auf seine Akte erteilt.
TR-> TD(2,0/7/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR Context TD(3,2/1/1)->PAR Aufrufkontext gemäß [ConnectorContext.xsd]
TR-> TD(4,1/1/1)->PAR EhcHandle TD(4,2/1/1)->PAR eGK des Versicherten oder des von ihm berechtigten Vertreters gemäß [gemSpec_Kon#4.1.1.1]
TR-> TD(5,1/1/1)->PAR AuthorizationConfiguration TD(5,2/1/1)->PAR Konfiguration der Zugriffsberechtigung, die eine konkrete Policy adressiert und das Gültigkeitsdatum bis wann die Zugriffsberechtigung erteilt wird
TR-> TD(6,1/1/1)->PAR RecordIdentifier TD(6,2/1/1)->PAR RecordIdentifier gemäß [gemSpec_DM_ePA#2.2]
TR-> TD(7,1/1/1)->PAR OrganizationName TD(7,2/1/1)->PAR Name der Leistungserbringerinstitution
TR-> TD(8,1/1/1)->PAR InsurantName TD(8,2/1/1)->PAR Name des Versicherten des durch RecordIdentifier referenzierten Aktenkontos
TR-> TD(9,0/2/1)->PAR Rückgabeparameter TD(9,1/1/1)->PAR Name TD(9,2/1/1)->PAR Beschreibung
TR-> TD(10,1/1/1)->PAR Status TD(10,2/1/1)->PAR Status nach [gemSpec_Kon#3.5.2]
PAR Die Operation RequestFacilityAuthorization kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202, 7203, 7205, 7206, 7207, 7213, 7214, 7215, 7217, 7220, 7400, 7403, 7404 gemäß Tab_FM_ePA_011LITEM->PAR Fehlermeldungen gemäß Tab_FM_ePA_050LITEM->PAR Fehlermeldungen gemäß Tab_FM_ePA_051
PAR -HEADING(ids=7.2.1.3)7.2.1.3 GetHomeCommunityID
PAR (ids=Tabelle-29)Tabelle 29: Tab_FM_ePA_039 Beschreibung und Parameter der Operation GetHomeCommunityID (Semantik)

TABLE(rows=8,cols=161+162+215)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR GetHomeCommunityID
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Mit dieser Operation kann ein Primärsystem das ePA-Aktensystem zu einem Aktenkonto anhand der Versicherten-ID lokalisieren. Das Fachmodul ePA iteriert dafür über alle bekannten Anbieter ePA-Aktensystem und ruft dort jeweils die Operation I_Authorization_Management::checkRecordExists auf. Der zurückgegebene Parameter HomeCommunityID enthält die OID des ePA-Aktenanbieters und ist Teil des RecordIdentifiers , den Primärsysteme zum Aufruf weiterer Operationen des Fachmoduls ePA benötigen.
TR-> TD(2,0/3/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR Context TD(3,2/1/1)->PAR Aufrufkontext gemäß [ConnectorContext.xsd]
TR-> TD(4,1/1/1)->PAR InsurantID TD(4,2/1/1)->PAR Unveränderlicher Teil der Krankenversichertennummer nach [gemSpec_DM_ePA#2.2]
TR-> TD(5,0/3/1)->PAR Rückgabeparameter TD(5,1/1/1)->PAR Name TD(5,2/1/1)->PAR Beschreibung
TR-> TD(6,1/1/1)->PAR HomeCommunityID TD(6,2/1/1)->PAR OID des ePA-Aktensystems gemäß [gemSpec_DM_ePA]
TR-> TD(7,1/1/1)->PAR Status TD(7,2/1/1)->PAR Status gemäß [gemSpec_Kon#3.5.2]
PAR Die Operation GetHomeCommunityID kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202, 7206, 7220, 7400 gemäß Tab_FM_ePA_011LITEM->PAR 4000 gemäß Tab_FM_ePA_050LITEM->PAR Fehlermeldungen gemäß Tab_FM_ePA_032
PAR (ids=Tabelle-30)Tabelle 30: Tab_FM_ePA_032 Fehlermeldungen der Operation GetHomeCommunityID

TABLE(rows=3,cols=33+54+51+196)->
TR-> TH(0,0/1/1)->PAR Code TH(0,1/1/1)->PAR ErrorType TH(0,2/1/1)->PAR Severity TH(0,3/1/1)->PAR Fehlertext
TR-> TD(1,0/1/1)->PAR 7290 TD(1,1/1/1)->PAR Technical TD(1,2/1/1)->PAR ERROR TD(1,3/1/1)->PAR Die Patientenakte konnte nicht gefunden werden.
TR-> TD(2,0/1/1)->PAR 7291 TD(2,1/1/1)->PAR Technical TD(2,2/1/1)->PAR ERROR TD(2,3/1/1)->PAR Die Patientenakte konnte nicht eindeutig identifiziert werden.
PAR -HEADING(ids=7.2.1.4)7.2.1.4 GetAuthorizationList
PAR (ids=Tabelle-31)Tabelle 31: Tab_FM_ePA_040 Beschreibung und Parameter der Operation GetAuthorizationList (Semantik)

TABLE(rows=7,cols=161+162+215)->
TR-> TH(0,0/1/1)->PAR Name TH(0,1/1/2)->PAR GetAuthorizationList
TR-> TD(1,0/1/1)->PAR Beschreibung TD(1,1/1/2)->PAR Mit der Operation GetAuthorizationList kann eine LEI alle für sie erteilten Zugriffsberechtigungen auf Akten der ePA-Aktensysteme abfragen. Das Fachmodul ePA iteriert dafür über alle bekannten Anbieter von ePA-Aktensystemen und ruft dort die Operation I_Authorization_Management::getAuthorizationList der jeweiligen Komponente Autorisierung auf. Als Parameter muss dabei eine AuthenticationAssertion übergeben werden.<br>Die Rückgabeparameter umfassen die AuthorizationList, welche eine Liste von Tupeln (RecordIdentifier, Enddatum der Berechtigung) enthält, sowie den Status des Operationsaufrufes gemäß [gemSpec_Kon#3.5.2].
TR-> TD(2,0/2/1)->PAR Aufrufparameter TD(2,1/1/1)->PAR Name TD(2,2/1/1)->PAR Beschreibung
TR-> TD(3,1/1/1)->PAR Context TD(3,2/1/1)->PAR Aufrufkontext gemäß [ConnectorContext.xsd]
TR-> TD(4,0/3/1)->PAR Rückgabeparameter TD(4,1/1/1)->PAR Name TD(4,2/1/1)->PAR Beschreibung
TR-> TD(5,1/1/1)->PAR AuthorizationList TD(5,2/1/1)->PAR Liste aller Zugriffsberechtigungen für die LEI
TR-> TD(6,1/1/1)->PAR Status TD(6,2/1/1)->PAR Status gemäß [gemSpec_Kon#3.5.2]
PAR Die Operation GetAuthorizationList kann folgende Fehlermeldungen zurückliefern:

LIST->
LITEM->PAR 7200, 7202, 7205, 7206, 7214, 7220, 7221, 7400 gemäß Tab_FM_ePA_011LITEM->PAR 4000 gemäß Tab_FM_ePA_050LITEM->PAR Fehlermeldungen gemäß Tab_FM_ePA_041
PAR (ids=Tabelle-32)Tabelle 32: Tab_FM_ePA_041 Fehlermeldungen der Operation GetAuthorizationList

TABLE(rows=2,cols=33+54+51+196)->
TR-> TH(0,0/1/1)->PAR Code TH(0,1/1/1)->PAR ErrorType TH(0,2/1/1)->PAR Severity TH(0,3/1/1)->PAR Fehlertext
TR-> TD(1,0/1/1)->PAR 7230 TD(1,1/1/1)->PAR Technical TD(1,2/1/1)->PAR WARNING TD(1,3/1/1)->PAR Die Liste der Berechtigungen ist möglicherweise unvollständig, da nicht alle bekannten Aktensysteme abgefragt werden konnten.
PAR -HEADING(ids=7.2.2)7.2.2 Umsetzung
PAR Authentisierung gegenüber dem Aktensystem
REQ(ids=A_15192)<b>A_15192 - FM ePA: PHRManagementService - Authentisierung mittels eGK</b>
PAR Der Webservice PHRManagementService MUSS sich zur Durchführung der Operationen ActivateAccount und RequestFacilityAuthorization mit der in den Aufrufparametern referenzierten eGK gegenüber dem Aktensystem authentisieren. <b>[<=]</b>

REQ(ids=A_15193)<b>A_15193 - FM ePA: PHRManagementService - Authentisierung mittels SM-B</b>
PAR Der Webservice PHRManagementService MUSS sich zur Durchführung der Operation GetAuthorizationList mit einem über Aufrufkontext ausgewählten SM-B gegenüber dem Aktensystem authentisieren.
PAR <b>[<=]</b>

PAR Die Authentisierung mittels SM-B bzw. eGK und der weitere Login-Prozess sind in Kapitel 6.5 Login beschrieben. Der Aufrufkontext wird in den Parametern der Operationen übergeben.
PAR Der Aufruf der Operation GetHomeCommunityID erfordert keine Authentisierung gegenüber dem ePA-Aktensystem.
PAR Übergreifende Regelungen für PHRManagementService
REQ(ids=A_14266)<b>A_14266 - FM ePA: PHRManagementService – Befüllung des Rückgabeparameters Status</b>
PAR Das Fachmodul ePA MUSS bei jeder erfolgreich durchlaufenen Operation von PHRManagementService den Parameter Status im Element Status/Result mit „OK“ befüllen (vgl. [ConnectorCommon.xsd]).
PAR <b>[<=]</b>

REQ(ids=A_17121)<b>A_17121 - FM ePA: PHRManagementService - Berechtigung in Komponente Autorisierung - Fehler</b>
PAR Falls die Operation I_Authorization_Management::putAuthorizationKey einen Fehler zurückgibt, MUSS der Webservice PHRManagementService die aufgerufene Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen. <b>[<=]</b>

PAR Fehlerrückgaben der Operation I_Authorization_Management::putAuthorizationKey werden in [gemSpec_Autorisierung] spezifiziert.
PAR -HEADING(ids=7.2.2.1)7.2.2.1 ActivateAccount
PAR Der Ablauf der Operation ActivateAccount ist in [gemSysL_ePA#3.5.1] beschrieben und gliedert sich in die folgenden Schritte:

ORDERED-LIST->
LITEM->PAR Prüfung der Parameter und des Sperrstatus der eGKLITEM->PAR Login des Versicherten mit der eGKLITEM->PAR Schlüsselmaterial erzeugen und verschlüsselnLITEM->PAR Hinterlegen des verschlüsselten Schlüsselmaterials für den Versicherten in der Komponente Autorisierung
PAR Authentisierung des Versicherten gegenüber dem Aktensystem
PAR Die Authentisierung gegenüber einem Aktensystem erfolgt gemäß A_15192 mit der eGK. Der vollständige Login-Prozess ist in Kapitel 6.5 Login beschrieben.
PAR Erzeugung des Schlüsselmaterials für den Zugriff durch die eGK
PAR Übergreifende Festlegungen zur Datensicherheit befinden sich in Kapitel 6.7 Datenschutz und Sicherheitsaspekte. Für die Verschlüsselung von Akten- und Kontextschlüssel gelten die Vorgaben aus [gemSpec_SGD_ePA#8].
PAR Voraussetzung ist die Nutzung einer eGK G2 oder höher, wobei eine eGK G2 die Kryptographie mit RSA unterstützt. Eine eGK ab G2.1 unterstützt die Kryptographie mit RSA und ECC. Die normierenden Organisationen haben das Ende der Zulässigkeit für den RSA-2048 festgelegt. Aus diesem Grund wird bei Nutzung einer eGK G2 die Kryptographie mit RSA und bei eGK einer höheren Generation die Kryptographie mit ECC verwendet.
REQ(ids=A_14742)<b>A_14742 - FM ePA: ActivateAccount - Akten- und Kontextschlüssel erzeugen</b>
PAR Die Operation ActivateAccount MUSS einen Kontext- und einen Aktenschlüssel erzeugen.
PAR <b>[<=]</b>

PAR Schlüsselableitung und Entschlüsselung von Akten- und Kontextschlüssel
PAR Das Chiffrat von Akten- und Kontextschlüssel im Schlüsselkasten wird bei der Aktivierung des Aktenkontos in der Komponente Autorisierung hinterlegt. Hierzu werden Akten- und Kontextschlüssel mit zwei AES-256-Schlüsseln verschlüsselt. Die für die Verschlüsselung des Chiffrats benötigten zwei AES-256-Schlüssel ruft das Fachmodul ePA von den SGDs 1 und 2 ab (siehe Kap. 6.5.6- Schlüsselableitung).
REQ(ids=A_17743)<b>A_17743 - FM ePA: ActivateAccount - Akten- und Kontextschlüssel für den Versicherten verschlüsseln</b>
PAR Die Operation ActivateAccount MUSS gemäß dem in [gemSpec_SGD_ePA#2.4] beschriebenen Algorithmus die zur Verschlüsselung notwendigen AES-Schlüssel abrufen und Akten- und Kontextschlüssel gemäß [gemSpec_Krypt#A_17872] und [gemSpec_SGD_ePA#8] verschlüsseln. <br>​​
PAR <b>[<=]</b>

PAR Hinterlegen des Schlüsselmaterials für den Versicherten in der Komponente Autorisierung
PAR Zur Hinterlegung des Schlüsselmaterials wird eine TLS-Verbindung zur Komponente Autorisierung aufgebaut. Die normativen Festlegungen hierzu befinden sich in Kapitel 6.5.4.
REQ(ids=A_14749)<b>A_14749 - FM ePA: ActivateAccount - Hinterlegen des verschlüsselten Schlüsselmaterials</b>
PAR Die Operation ActivateAccount MUSS zur Hinterlegung der Berechtigung in der Komponente Autorisierung die Operation I_Authorization_Management::putAuthorizationKey gemäß [gemSpec_Autorisierung] mit folgenden Parametern aufrufen:

LIST->
LITEM->PAR AuthenticationAssertion: als SOAP-Header, AuthenticationToken aus dem Login-Prozess zum ePA-AktensystemLITEM->PAR RecordIdentifier: Parameter der aufrufenden OperationLITEM->PAR AuthorizationKey: AuthorizationKey: Berechtigung des Versicherten; doppelt verschlüsseltes Chiffrat und AssociatedData (aus den Antwortnachrichten der SGDs) als EncryptedKeyContainer gemäß [gemSpec_SGD_ePA#8]
LIST->
LITEM->PAR validTo: aktuelles DatumLITEM->PAR actorID: Versicherten-ID der eGKLITEM->PAR AuthorizationType: DOCUMENT_AUTHORIZATION
PAR <b>[<=]</b>

REQ(ids=A_14271)<b>A_14271 - FM ePA: ActivateAccount - Terminalanzeige für PIN-Eingaben der Operation</b>
PAR Die Operation ActivateAccount MUSS für notwendige PIN-Eingaben am Kartenterminal die in Tabelle Tab_FM_ePA_021 definierte Terminalanzeige verwenden.
PAR Tabelle 33: Tab_FM_ePA_021 Terminalanzeigen für PIN-Eingaben - Operation ActivateAccount

TABLE(rows=2,cols=239+310)->
TR-> TH(0,0/1/1)->PAR PIN-Objekt zur Freischaltung (PIN-Referenz) TH(0,1/1/1)->PAR Parameter "Anw" für Terminalanzeigen nach [gemSpec_Kon# TAB_KON_090]
TR-> TD(1,0/1/1)->PAR PIN.CH TD(1,1/1/1)->PAR Aktenkonto•0x0Baktivieren
PAR ​​
PAR <b>[<=]</b>

PAR -HEADING(ids=7.2.2.2)7.2.2.2 RequestFacilityAuthorization
PAR Auswahl eines SM-B
PAR Das Fachmodul ePA sucht ein SM-B aus dem fest konfigurierten Informationsmodell des Konnektors, das dem übertragenen Context zugeordnet ist und zuvor durch PIN-Eingabe freigeschaltet wurde (siehe A_15614). Die Berechtigungsvergabe zum Zugriff auf ein Aktenkonto erfolgt für eine LEI, identifiziert durch die Telematik-ID.
PAR Bestätigung der Berechtigung per PIN-Eingabe
REQ(ids=A_14769)<b>A_14769 - FM ePA: RequestFacilityAuthorization - Bestätigung der Berechtigung</b>
PAR Die Operation RequestFacilityAuthorization MUSS vor dem Einbringen der Berechtigungen in die Komponenten Autorisierung und Dokumentenverwaltung die PIN.CH des Versicherten, identifiziert durch den Parameter EhcHandle, abfragen. <b>[<=]</b>

REQ(ids=A_16216)<b>A_16216 - FM ePA: RequestFacilityAuthorization - Terminalanzeige für PIN-Eingaben der Operation</b>
PAR Die Operation RequestFacilityAuthorization MUSS für notwendige PIN-Eingaben der Operation RequestFacilityAuthorization am Kartenterminal die in Tab_FM_ePA_019 definierte Terminalanzeige verwenden.
PAR Tabelle 34: Tab_FM_ePA_019 Terminalanzeigen für PIN-Eingaben - Operation RequestFacilityAuthorization

TABLE(rows=2,cols=239+310)->
TR-> TH(0,0/1/1)->PAR PIN-Objekt zur Freischaltung (PIN-Referenz) TH(0,1/1/1)->PAR Parameter "Anw" für Terminalanzeigen nach [gemSpec_Kon# TAB_KON_090]
TR-> TD(1,0/1/1)->PAR PIN.CH TD(1,1/1/1)->PAR Schritt 5: Aktenzugriff
PAR ​​
PAR <b>[<=]</b>

REQ(ids=A_16212)<b>A_16212 - FM ePA: RequestFacilityAuthorization - Anzeige am Kartenterminal - Anzeigetext</b>
PAR Im Rahmen der Abfrage der PIN.CH zur Erteilung der Berechtigung MUSS die Operation RequestFacilityAuthorization unmittelbar vor der PIN-Abfrage die Anzeigetexte in der vorgegebenen Reihenfolge gemäß Tab_FM_ePA_025 am Kartenterminal darstellen. 
PAR (ids=Tabelle-35)Tabelle 35: Tab_FM_ePA_025: Operation RequestFacilityAuthorization - Ausgabetexte am Kartenterminal

TABLE(rows=6,cols=347+290+77)->
TR-> TH(0,0/1/1)->PAR Ausgabe am Kartenterminal TH(0,1/1/1)->PAR Quelle TH(0,2/1/1)->PAR Verfügbare<br>Länge für<br>Parameter
TR-> TD(1,0/1/1)->PAR Es•folgen•4•Anzeigen.•0x0B<br>Bitte•mit•[OK]•bestätigen! TD(1,1/1/1)->PAR - TD(1,2/1/1)->PAR -
TR-> TD(2,0/1/1)->PAR 1:Berechtigung•für•0x0B<br><OrganizationName> TD(2,1/1/1)->PAR Parameter OrganizationName* TD(2,2/1/1)->PAR 27
TR-> TD(3,0/1/1)->PAR 2:auf•Akte•von•0x0B<br><Vorname>•<Nachname> TD(3,1/1/1)->PAR Parameter InsurantName*<br>Wenn die Länge <Vorname> + Länge <Nachname> größer ist als 30 Zeichen, dann wird der Vorname nach 9 Zeichen abgeschnitten und mit '.' beendet. TD(3,2/1/1)->PAR 30
TR-> TD(4,0/1/1)->PAR 3:mit•Ende•der•Berechtigung:•0x0B<br><ExpirationDate> TD(4,1/1/1)->PAR Parameter ExpirationDate als tt.mm.jjjj TD(4,2/1/1)->PAR 10
TR-> TD(5,0/1/1)->PAR 4:<br><br>für•Dokumente•von•0x0B<br>Vers.:[<•|x>]•Med.:[<•|x>]•Kasse:[<•|x>] TD(5,1/1/1)->PAR <•|x>:<br>Anzeige <•>, falls keine Berechtigung (false) für den Dokumententopf erteilt wird<br>Anzeige <x>, falls die Berechtigung (true) für den Dokumententopf erteilt wird<br>Vers.: Der Wert entspricht dem Parameter AuthorizationConfiguration.Vers_Docs<br>Med.:  Der Wert entspricht dem Parameter AuthorizationConfiguration.LE_Docs<br>Kasse: Der Wert entspricht dem Parameter AuthorizationConfiguration.KTR_Docs TD(5,2/1/1)->PAR 3 mal 1
PAR Hinweise:
PAR 1. Die Inhalte der mit '*' markierten Parameter werden auf die maximal mögliche Anzahl der verbleibenden Zeichen für den Eingabetext gekürzt. Nicht genutzte Zeichen werden nicht zur Anzeige gebracht.
PAR 2. Leerzeichen werden als "•" dargestellt
PAR 3. 0x0B und 0x0F (Sollbruchstellen bzw. Trennung zwischen Nachricht und PIN-Prompt) sind Trennzeichen gemäß [SICCT#5.6.1]
PAR 4. Die Zeilenumbrüche in der Spalte "Ausgabe am Kartenterminal" sind editorisch bedingt.
PAR <b>[<=]</b>

PAR An folgendem Beispiel wird die Anzeige am Kartenterminal und die Eingabe des Versicherten bei der Operation RequestFacilityAuthorization gezeigt:

TABLE(rows=7,cols=0+0)->
TR-> TH(0,0/1/1)->PAR Anzeige am Kartenterminal TH(0,1/1/1)->PAR Eingabe des Versicherten
TR-> TD(1,0/1/1)->PAR Es folgen 4 Anzeigen.<br>Bitte mit [OK] bestätigen! TD(1,1/1/1)->PAR Taste: OK
TR-> TD(2,0/1/1)->PAR 1:Berechtigung für Praxis Dr. Müller TD(2,1/1/1)->PAR Taste: OK
TR-> TD(3,0/1/1)->PAR 2:auf Akte von Max Mustermann TD(3,1/1/1)->PAR Taste: OK
TR-> TD(4,0/1/1)->PAR 3:mit Ende der Berechtigung: 01.08.2019 TD(4,1/1/1)->PAR Taste: OK
TR-> TD(5,0/1/1)->PAR 4:für Dokumente von<br>Vers.:[x] Med.:[x] Kasse:[ ] TD(5,1/1/1)->PAR Taste: OK
TR-> TD(6,0/1/1)->PAR PIN für Schritt 5: Aktenzugriff<br>PIN.eGK: TD(6,1/1/1)->PAR PIN-Eingabe: 123456
PAR Im Beispiel erteilt Max Mustermann der Praxis Dr. Müller bis 01.08.2019 die Berechtigung, auf die Dokumente des Versicherten und von Leistungserbringern gemäß [gemSpec_Dokumentenverwaltung#5.3] zuzugreifen.
REQ(ids=A_16351)<b>A_16351 - FM ePA: RequestFacilityAuthorization - Anzeige am Kartenterminal - Mapping von InsurantName und OrganizationName</b>
PAR Die Operation RequestFacilityAuthorization MUSS bei der Anzeige von Vorname, Nachname (Parameter InsurantName) und OrganizationName jedes Zeichen auf ein entsprechendes Zeichen des vom verwendeten Kartenterminal adressierten Zeichensatzes abbilden. 
PAR <b>[<=]</b>

REQ(ids=A_16352)<b>A_16352 - FM ePA: RequestFacilityAuthorization - Anzeige am Kartenterminal - nicht darstellbare Zeichen von InsurantName und OrganizationName</b>
PAR Falls in Vorname oder Nachname oder OrganizationName enthaltene Zeichen nicht auf den vom Kartenterminal unterstützten Zeichensatz abbildbar sind KANN die Operation RequestFacilityAuthorization für jedes nicht abbildbare Zeichen ein Zeichen des vom verwendeten Kartenterminal adressierten Zeichensatzes als Platzhalter auf dem Display des Kartenterminals anzeigen. 
PAR <b>[<=]</b>

PAR Im einfachsten Fall ist das vom Primärsystem übergebene Zeichen am Kartenterminal anzeigbar, z.B das Zeichen 'a'. Für nicht abbildbare Zeichen gibt es verschiedene Möglichkeiten. Das Zeichen kann beispielsweise weggelassen werden oder durch ein festes Zeichen als Platzhalter ersetzt werden oder es gibt eine geeignete Abbildung auf ein lesbares Zeichen. Eine geeignete Abbildung für Buchstaben mit diakritischen Zeichen (z.B. 'ñ') ist die Darstellung des Buchstabens ohne das diakritische Zeichen ('n') auf dem Display des Kartenterminals.
PAR Über TUC_KON_058 „Displaygröße ermitteln“ gemäß [gemSpec_Kon] kann das Fachmodul ePA die Größe des durch das Kartenterminal verwendeten Displays abfragen und die Darstellung der Berechtigungen optimieren.
REQ(ids=A_16219)<b>A_16219 - FM ePA: RequestFacilityAuthorization - Anzeige am Kartenterminal - Optimierung</b>
PAR Falls ein Kartenterminal die Mindestanforderung von 48 Zeichen Anzeigetext übersteigt, MUSS  die Operation RequestFacilityAuthorization die Anzeigen gemäß Tab_FM_ePA_025 bündeln. Hierbei ist das Zusammenfassen von 2 oder mehr Zeilen von Tab_FM_ePA_025 zu einer Ausgabeoperation gemeint. Die Nummerierung zu Beginn der Anzeige mit "1:" bis "4:" wird dann angepasst und erfolgt fortlaufend bei "1:" beginnend. Der Ausgabetext "Es folgen 4 Anzeigen ..." wird entsprechend angepasst.Der Parameter "Anw" für Terminalanzeigen gemäß Tab_FM_ePA_019 wird entsprechend angepasst.<br>​​
PAR <b>[<=]</b>

REQ(ids=A_16218)<b>A_16218 - FM ePA: RequestFacilityAuthorization - Anzeige am Kartenterminal - Nutzerinteraktion</b>
PAR Die Operation RequestFacilityAuthorization MUSS eine Ausgabe (entspricht einer Zeile in Tab_FM_ePA_025) am Kartenterminal solange anzeigen bis eine Nutzereingabe die Anzeige bestätigt, abbricht oder ein Timeout  wegen fehlender Nutzereingabe erfolgt.
PAR <b>[<=]</b>

REQ(ids=A_16214)<b>A_16214 - FM ePA: RequestFacilityAuthorization - Anzeige am Kartenterminal - Bestätigung</b>
PAR Falls eine Ausgabe (entspricht einer Zeile in Tab_FM_ePA_025) am Kartenterminal bestätigt wird, MUSS die Operation RequestFacilityAuthorization die nächste Ausgabe am Kartenterminal gemäß Tab_FM_ePA_025 anzeigen.
PAR <b>[<=]</b>

REQ(ids=A_16215)<b>A_16215 - FM ePA: RequestFacilityAuthorization - Anzeige am Kartenterminal - Abbruch</b>
PAR Falls eine Ausgabe Tab_FM_ePA_025 am Kartenterminal abgebrochen wird (Abbruchtaste wurde gedrückt oder Timeout), MUSS die Operation RequestFacilityAuthorization die Operation mit Code 7217 abbrechen.
PAR <b>[<=]</b>

REQ(ids=A_18182)<b>A_18182 - FM ePA: RequestFacilityAuthorization - Anzeige am Kartenterminal - wiederholte PIN-Eingabe</b>
PAR Falls eine erfolgte PIN-Eingabe den Fehler REJECTED zurückliefert, MUSS die Operation RequestFacilityAuthorization unmittelbar daran anschließend eine erneute PIN-Abfrage gemäß  und  durchführen, d.h. die Schritte 1-4 zur Anzeige am Kartenterminal werden hierbei nicht durchgeführt. <b>[<=]</b>

PAR Login am ePA-Aktensystem (Authentisierung und Autorisierung)
PAR Die Authentisierung gegenüber einem Aktensystem erfolgt gemäß A_15192 mit der eGK. Der vollständige Login-Prozess ist in Kapitel 6.5 Login beschrieben. Dabei ist es unerheblich, ob es sich um den Versicherten als Eigentümer der Akte handelt oder ob der Versicherte in der Rolle des Vertreters agiert. In beiden Fällen wird für den Versicherten die Authentisierung und Autorisierung mit seiner eGK durchgeführt.
PAR Verbindung zur Dokumentenverwaltung
PAR Die Verbindung zur Komponente Dokumentenverwaltung verläuft analog zum Login durch eine LEI mit dem Aufruf von Operationen des Webservices PHRService. Die Operation RequestFacilityAuthorization möchte mit der Komponente Dokumentenverwaltung kommunizieren und baut hierzu eine sichere Verbindung gemäß den Festlegungen in Kapitel 6.5.5 auf.
PAR Kontoaktivierung falls erforderlich
PAR Bevor die Berechtigung für die Telematik-ID in der Komponente Autorisierung hinterlegt wird, wird für den Fall, dass das Aktenkonto noch nicht aktiviert wurde, die Operation ActivateAccount implizit aufgerufen und vollständig abgearbeitet.
REQ(ids=A_17213)<b>A_17213 - FM ePA: Bedingte Kontoaktivierung - Aufruf der Operation ActivateAccount</b>
PAR Falls das Aktenkonto noch nicht aktiviert, wurde MUSS die Operation RequestFacilityAuthorization die Operation ActivateAccount implizit aufrufen.
PAR <b>[<=]</b>

PAR Bei der Kontoaktivierung wird die Zustimmung des Versicherten durch PIN-Eingabe verlangt. Es werden Events definiert und zu Beginn und Ende der impliziten Kontoaktivierung erzeugt. Das Primärsystem erhält dadurch die Möglichkeit, den Versicherten auf die zusätzliche Kontoaktivierung hinzuweisen.
REQ(ids=A_17214)<b>A_17214 - FM ePA: Bedingte Kontoaktivierung - Event FM_EPA/ACTIVATE_ACCOUNT/START</b>
PAR Falls die Kontoaktivierung erforderlich ist, MUSS die Operation RequestFacilityAuthorization zu Beginn der Kontoaktivierung unter Verwendung des Systeminformationsdienstes des Konnektors ein Event mit folgendem Inhalt erzeugen:<br><br> <b>[<=]</b>

REQ(ids=A_17215)<b>A_17215 - FM ePA: Bedingte Kontoaktivierung - Event FM_EPA/ACTIVATE_ACCOUNT/FINISHED</b>
PAR Falls die Kontoaktivierung erforderlich ist, MUSS die Operation RequestFacilityAuthorization nach Abschluss der Kontoaktivierung unter Verwendung des Systeminformationsdienstes des Konnektors ein Event mit folgendem Inhalt erzeugen:<br> <b>[<=]</b>

PAR Berechtigung in Komponente Autorisierung für Telematik-ID erstellen
PAR Durch den Login (Authentisierung und Autorisierung) liegt in der Session zur Operation RequestFacilityAuthorization der Aktenschlüssel und der Kontextschlüssel im Klartext vor. Beide Schlüssel werden mit AES-Schlüsseln, die von SGD 1 und 2 abgerufen werden, verschlüsselt und mittels I_Authorization_Management::putAuthorizationKey in die Komponente Autorisierung eingebracht.
REQ(ids=A_17988)<b>A_17988 - FM ePA: RequestFacilityAuthorization - Schlüsselableitung in Abhängigkeit von der Rolle</b>
PAR Für die Verschlüsselung von Akten- und Kontextschlüssel MUSS das Fachmodul ePA bei Durchführung der Schlüsselableitung die Rolle des Berechtigenden bestimmen und die Operation KeyDerivation gemäß Anwendungsfall folgender Tabelle aufrufen:<br><br><br><b>[<=]</b>

REQ(ids=A_17868)<b>A_17868 - FM ePA: RequestFacilityAuthorization - Akten- und Kontextschlüssel mit eGK verschlüsseln</b>
PAR Die Operation RequestFacilityAuthorization MUSS die beiden zur Verschlüsselung notwendigen AES-Schlüssel abrufen und Akten- und Kontextschlüssel gemäß [gemSpec_Krypt#A_17872] und [gemSpec_SGD_ePA#8] verschlüsseln.
PAR <b>[<=]</b>

REQ(ids=A_14829)<b>A_14829 - FM ePA: RequestFacilityAuthorization - Hinterlegen des verschlüsselten Schlüsselmaterials in der Komponente Autorisierung</b>
PAR Die  Operation RequestFacilityAuthorization MUSS zur Hinterlegung der Berechtigung in der Komponente Autorisierung die Operation I_Authorization_Management::putAuthorizationKey mit folgenden Parametern aufrufen:

LIST->
LITEM->PAR AuthenticationAssertion: als SOAP-Header, AuthenticationToken aus dem Login-Prozess zum ePA-AktensystemLITEM->PAR RecordIdentifier: Parameter der aufrufenden OperationLITEM->PAR AuthorizationKey: AuthorizationKey: Berechtigung der Telematik-ID; enthält doppelt verschlüsseltes Chiffrat und AssociatedData (aus den Antwortnachrichten der SGDs) als EncryptedKeyContainer gemäß [gemSpec_SGD_ePA#8]
LIST->
LITEM->PAR validTo: vom Primärsystem übergebenes Gültigkeitsdatum bis wann die Zugriffsberechtigung erteilt wirdLITEM->PAR actorID: Telematik-ID des zum Aufrufkontext ausgewählten SM-BLITEM->PAR AuthorizationType: DOCUMENT_AUTHORIZATION
PAR <b>[<=]</b>

PAR Der RecordIdentifier wird aus den Aufrufparametern von RequestFacilityAuthorization übernommen, die AuthenticationAssertion wurde beim Login über die Komponente Zugangsgateway für Versicherte erzeugt.
PAR Berechtigung der LEI in die Dokumentenverwaltung einbringen
PAR Das Fachmodul erstellt im Kontext der Operation RequestFacilityAuthorization ein Policy Document, sendet dieses an die Komponente Dokumentenverwaltung wodurch die Berechtigung für die LEI in der Dokumentenverwaltung hinterlegt wird.
PAR Die Nutzungsvorgaben für XDS-Metadaten bei Policy Documents sind in [gemSpec_DM_ePA#2.1.4.2] beschrieben.
PAR Die Nutzungsvorgaben zum Inhalt eines Policy Documents zur Berechtigung einer Leistungserbringerinstitution werden durch die Anforderung A_15442 in [gemSpec_Dokumentenverwaltung] geregelt.
REQ(ids=A_15693)<b>A_15693 - FM ePA: RequestFacilityAuthorization - Erstellung von Policy Document</b>
PAR Die Operation RequestFacilityAuthorization MUSS ein Policy Document als eine XACML 2.0 Policy konform zu Advanced Patient Privacy Consent gemäß [IHE-ITI-APPC] unter Berücksichtigung der Anforderungen an deren Inhalt in [gemSpec_Dokumentenverwaltung#Tab_Dokv_300 in Anhang B (Base Policy)] erstellen und die Werte unter Berücksichtigung von Tab_FM_ePA_023 belegen:
PAR (ids=Tabelle-36)Tabelle 36: Tab_FM_ePA_023 Base Policy Belegung

TABLE(rows=10,cols=266+284+284)->
TR-> TH(0,0/1/1)->PAR Element-, Attribut- oder Textknoten gemäß [XACML] von Base Policy TH(0,1/1/2)->PAR Wert
TR-> TD(1,0/1/1)->PAR /PolicySet/Target/Subjects/Subject[1]/SubjectMatch/<br>AttributeValue/InstanceIdentifier/@extension TD(1,1/1/2)->PAR Telematik-ID des zum Aufrufkontext ausgewählten SM-B
TR-> TD(2,0/1/1)->PAR /PolicySet/Target/Subjects/Subject[2]/SubjectMatch/<br>AttributeValue/text() TD(2,1/1/2)->PAR Inhalt des Aufrufparameters <br>AuthorizationConfiguration / OrganizationName
TR-> TD(3,0/1/1)->PAR /PolicySet/Target/Resources/Resource/ResourceMatch/<br>AttributeValue/InstanceIdentifier/@extension TD(3,1/1/2)->PAR KVNR der zum Login benutzen eGK
TR-> TD(4,0/1/1)->PAR /PolicySet/Target/Environments/Environment/<br>EnvironmentMatch[2]/AttributeValue/text() TD(4,1/1/2)->PAR Inhalt von Aufrufparameter AuthorizationConfiguration / ExpirationDate entsprechend der Bildungsvorschrift aus Tab_Dokv_300
TR-> TD(5,0/5/1)->PAR /PolicySet/ ... TD(5,1/1/2)->PAR Es werden je nach Berechtigung zwischen 1 und 3 Elementen PolicySetIdReference unter dem Element PolicySet eingefügt, d.h., falls ein Flag im Aufrufparameter AuthorizationConfiguration gesetzt ist, wird ein Element mit dem Text (Policy Set ID) erstellt.
TR-> TD(6,1/1/1)->PAR Flag TD(6,2/1/1)->PAR Text (Policy Set ID)
TR-> TD(7,1/1/1)->PAR Vers_Docs TD(7,2/1/1)->PAR urn:gematik:policy-set-id:permissions-access-group-hcp-insurant-documents
TR-> TD(8,1/1/1)->PAR LE_Docs TD(8,2/1/1)->PAR urn:gematik:policy-set-id:permissions-access-group-hcp
TR-> TD(9,1/1/1)->PAR KTR_Docs TD(9,2/1/1)->PAR urn:gematik:policy-set-id:permissions-access-group-hcp-insurance-documents
PAR <b>[<=]</b>

REQ(ids=A_14833)<b>A_14833 - FM ePA: RequestFacilityAuthorization - Ablage der Policy-Dokumente in der Dokumentenverwaltung</b>
PAR Die Operation RequestFacilityAuthorization MUSS das Policy-Dokument und seine Metadaten mit der IHE Transaktion [ITI-80] "Cross-Gateway Document Provide" gemäß [gemSpec_Dokumentenverwaltung] für die durch RecordIdentifier adressierte Akte in der Komponente Dokumentenverwaltung hinterlegen. <b>[<=]</b>

REQ(ids=A_17437)<b>A_17437 - FM ePA: RequestFacilityAuthorization - SOAP-Security-Header</b>
PAR Vor der Ablage des Policy-Dokuments im ePA-Aktensystem MUSS die Operation RequestFacilityAuthorization den SOAP Security Header mit der AuthenticationAssertion der zur Authentisierung verwendeten eGK belegen.
PAR <b>[<=]</b>

REQ(ids=A_14834)<b>A_14834 - FM ePA: RequestFacilityAuthorization - Berechtigungen in Dokumentenverwaltung einbringen - Fehler im Aktensystem</b>
PAR Falls bei der Einbringung des Policy-Dokuments in die Komponente Dokumentenverwaltung ein IHE-Fehler auftritt, MUSS der Webservice PHRManagementService die aufgerufene Operation mit dem Code 7215 gemäß Tab_FM_ePA_011 abbrechen.
PAR <b>[<=]</b>

REQ(ids=A_17120)<b>A_17120 - FM ePA: RequestFacilityAuthorization - Berechtigungen in Dokumentenverwaltung einbringen - Fehler</b>
PAR Falls bei der Einbringung des Policy-Dokuments in die Komponente Dokumentenverwaltung ein Fehler außerhalb der IHE-Spezifikation auftritt, MUSS der Webservice PHRManagementService die aufgerufene Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen.<br>​​
PAR <b>[<=]</b>

PAR Bei erfolgreicher Durchführung der Operation RequestFacilityAuthorization wurde die Berechtigung für die LEI im Aktensystem hinterlegt. Ein Akteur der LEI kann jetzt durch Operationen von PHRService auf Dokumente des Versicherten im Aktensystem zugreifen das Login mit SM-B erfolgen.
PAR -HEADING(ids=7.2.2.3)7.2.2.3 GetHomeCommunityID
PAR Der Namensdienst der TI enthält für jedes ePA-Aktensystem die IP-Adressen der einzelnen Komponenten und die HomeCommunityID als fachlichen Identifier. GetHomeCommunityID iteriert über alle Einträge und liefert dann die HomeCommunityID des ePA-Aktensystems zurück, welches die Akte zu der übergebenen Versicherten-ID führt. Als Fehler der Operation werden die Fälle abgefangen, dass kein oder mehr als ein passendes ePA-Aktensystem gefunden wird. Liefert der Aufruf von I_Authorization_Management::checkRecordExists den Statuswert UNKNOWN zurück, geht die Operation GetHomeCommunityID davon aus, dass das ePA-Aktensystem keine Patientenakte zu der übertragenen Versicherten-ID führt. Der Fehlerfall, dass die Lokalisierungsinformationen zum Zeitpunkt des Aufrufs von GetHomeCommunityID nicht zur Verfügung stehen, wird in Kapitel 6.3 behandelt.
PAR Aufbau einer TLS-Verbindung zur Komponente Autorisierung eines ePA-Aktensystems
PAR Gemäß A_14105 muss zur Kommunikation mit der Komponente Autorisierung eines ePA-Aktensystems eine TLS-Verbindung mit serverseitiger Authentisierung aufgebaut werden.
PAR Abfrage der ePA-Aktensysteme
REQ(ids=A_15228)<b>A_15228 - FM ePA: GetHomeCommunityID - Anfrage an alle bekannten ePA-Aktensysteme</b>
PAR Die Operation GetHomeCommunityID MUSS die Existenz eines zur Versicherten-ID passenden Aktenkontos bei den im Namensdienst der TI gelisteten ePA-Aktensystemen anfragen.
PAR <b>[<=]</b>

PAR Da ein Versicherter höchstens ein Aktenkonto bei genau einem ePA-Aktensystem hat, kann Fachmodul ePA die Operation GetHomeCommunityID erfolgreich beenden, sobald das entsprechende ePA-Aktensystem gefunden wurde.
REQ(ids=A_14586)<b>A_14586 - FM ePA: GetHomeCommunityID - Schnittstelle zur Abfrage am ePA-Aktensystem</b>
PAR Die Operation GetHomeCommunityID MUSS die Existenz eines Aktenkontos in einem ePA-Aktensystem mit I_Authorization_Management::checkRecordExists der Komponente Autorisierung abfragen. <b>[<=]</b>

REQ(ids=A_13786)<b>A_13786 - FM ePA: GetHomeCommunityID - Eine Akte</b>
PAR Falls  ein ePA-Aktensystem bestimmt werden konnte, dass zu der  Versicherten-ID eine Akte mit einem Status aus der Menge (ACTIVATED, REGISTERED, DISMISSED, SUSPENDED) führt, MUSS die Operation GetHomeCommunityID die HomeCommunityID dieses ePA-Aktensystems zurückgeben.<br>​​
PAR <b>[<=]</b>

PAR Falls mindestens ein ePA-Aktensystem erreichbar ist und einen Statuswert zurückliefert, wird bei fehlgeschlagenen Aufrufen anderer ePA-Aktensysteme angenommen, dass diese kein passendes Aktenkonto zur der Versicherten-ID führen.
PAR Fehlerbehandlung
REQ(ids=A_17765)<b>A_17765 - FM ePA: GetHomeCommunityID - Abfrage eines Aktenkontos nicht möglich</b>
PAR Falls ein Aufruf von I_Authorization_Management::checkRecordExists nicht durchgeführt werden konnte oder nicht erfolgreich war, MUSS die Operation GetHomeCommunityID die Lokalisierung des ePA-Aktenkontos weiterführen.<br>​​
PAR <b>[<=]</b>

REQ(ids=A_13784)<b>A_13784 - FM ePA: GetHomeCommunityID - Keine Akte - Fehler</b>
PAR Falls kein ePA-Aktensystem bestimmt werden konnte, das zu einer Versicherten-ID eine Akte mit einem Status aus der Menge (ACTIVATED, REGISTERED, DISMISSED, SUSPENDED) führt, MUSS die Operation GetHomeCommunityID mit dem Code 7290 gemäß Tab_FM_ePA_032 abbrechen.<br>​​
PAR <b>[<=]</b>

REQ(ids=A_13785)<b>A_13785 - FM ePA: GetHomeCommunityID - Zwei oder mehr Akten - Fehler</b>
PAR Falls mehr als ein ePA-Aktensystem bestimmt werden konnte, das zu einer Versicherten-ID eine Akte mit einem Status aus der Menge (ACTIVATED, REGISTERED, DISMISSED, SUSPENDED) führt, MUSS die Operation GetHomeCommunityID mit dem Code 7291 gemäß Tab_FM_ePA_032 abbrechen.<br>​​
PAR <b>[<=]</b>

PAR -HEADING(ids=7.2.2.4)7.2.2.4 GetAuthorizationList
PAR Auswahl eines SM-B
PAR Das Fachmodul ePA sucht ein SM-B aus dem fest konfigurierten Informationsmodell des Konnektors, das dem übertragenen Context zugeordnet ist und zuvor durch PIN-Eingabe freigeschaltet wurde (siehe A_15218). Die Berechtigungen werden für die Telematik-ID des ausgewählten SM-B ermittelt.
PAR Aufbau einer TLS-Verbindung zur Komponente Autorisierung eines ePA-Aktensystems
PAR Gemäß A_14105 muss zur Kommunikation mit der Komponente Autorisierung eines ePA-Aktensystems eine TLS-Verbindung mit serverseitiger Authentisierung aufgebaut werden.
PAR Abfrage der ePA-Aktensysteme
REQ(ids=A_17167)<b>A_17167 - FM ePA: GetAuthorizationList - Anfrage an alle bekannten ePA-Aktensysteme</b>
PAR Die Operation GetAuthorizationList MUSS die zum Zugriff durch eine LEI berechtigten Aktenkonten bei allen im Namensdienst der TI gelisteten ePA-Aktensystemen anfragen.
PAR <b>[<=]</b>

PAR Login an den ePA-Aktensystemen (nur Authentisierung)
PAR Der Abruf der Berechtigungen erfordert die Authentisierung gegenüber den ePA-Aktensystemen (A_15193). Der Ablauf verläuft jeweils analog zum Login bei Aufruf einer Operation des Webservices PHRService. Eine Autorisierung und Verbindung zur Komponente Dokumentenverwaltung ist nicht notwendig.
PAR Abfrage der Berechtigungen an den ePA-Aktensystemen
PAR Zur Ermittlung der Berechtigungen wird an allen im Namensdienst der TI gelisteten ePA-Aktensystemen die Operation I_Authorization_Management::getAuthorizationList der jeweiligen Komponente Autorisierung aufgerufen. Die Operation I_Authorization_Management::getAuthorizationList liefert eine Liste von KVNRs, für die im Schlüsselkasten ein AuthorizationKey hinterlegt ist, der die zur übergebenen AuthenticationAssertion gehörende LEI zum Zugriff berechtigt sowie das Enddatum der Zugriffsberechtigung. Die KVNRs werden in vollständige RecordIdentifier transformiert und als Liste, zusammen mit dem jeweiligen Enddatum der Berechtigung, an das aufrufende Clientsystem übergeben. Ein Fehler der Operation I_Authorization_Management::getAuthorizationList führt nicht zum Abbruch der Operation GetAuthorizationList, sondern lediglich zu einer Warnung. Falls alle Aufrufe von I_Authorization_Management::getAuthorizationList zu einem Fehler führen, wird die Operation GetAuthorizationList mit einem Fehler abgebrochen.
REQ(ids=A_17174)<b>A_17174 - FM ePA: GetAuthorizationList - Abfrage berechtigter Aktenkonten</b>
PAR Die Operation GetAuthorizationList MUSS zur Abfrage der zum Zugriff durch eine LEI berechtigten Aktenkonten an einem ePA-Aktensystem die Operation I_Authorization_Management::getAuthorizationList mit folgenden Parametern aufrufen:

LIST->
LITEM->PAR AuthenticationAssertion: als SOAP-Header, AuthenticationToken aus dem Login-Prozess zum ePA-Aktensystem (nur Authentisierung)
PAR <b>[<=]</b>

PAR Fehlerbehandlung
PAR Die Operation GetAuthorizationList muss alle bekannten ePA-Aktensysteme anfragen, die jeweils mit verschiedenen Fehlern antworten können. Das Fachmodul zeigt mit dem Fehlercode 7215 eindeutig ein Problem auf Seite der Aktensysteme an, Fehlercode 7400 hingegeben deutet auf ein Problem im Konnektor hin, bedarf aber einer genaueren Analyse der Log-Dateien.
REQ(ids=A_17767)<b>A_17767 - FM ePA: GetAuthorizationList - Abfrage der Berechtigung einer einzelnen Akte nicht möglich</b>
PAR Falls ein Aufruf von I_Authorization_Management::getAuthorizationList nicht durchgeführt werden konnte oder nicht erfolgreich war, MUSS die Operation GetAuthorizationList die Abfrage der Berechtigungen für die anderen Aktenkonten weiterführen.<br>​​
PAR <b>[<=]</b>

REQ(ids=A_17219)<b>A_17219 - FM ePA: GetAuthorizationList - Abfrage berechtigter Aktenkonten - Warnung</b>
PAR Falls mindestens ein Aufruf von I_Authorization_Management::getAuthorizationList erfolgreich und mindestens ein Aufruf nicht durchgeführt werden konnte oder fehlerhaft war, MUSS die Operation GetAuthorizationList eine Warnung mit dem Code 7230 gemäß Tab_FM_ePA_041 zurückgeben.
PAR <b>[<=]</b>

REQ(ids=A_17175)<b>A_17175 - FM ePA: GetAuthorizationList - Abfrage berechtigter Aktenkonten - Fehler</b>
PAR Falls alle zur Durchführung einer Operation benötigten Aufrufe von I_Authorization_Management::getAuthorizationList einenFehler zurückgeben, MUSS das Fachmodul ePA die aufgerufene Operation mit dem Code 7400 gemäß Tab_FM_ePA_011 abbrechen.<br><b>[<=]</b>

PAR Sind für eine LEI keine Berechtigungen vorhanden, gibt die Operation GetAuthorizationList eine leere Liste in dem Rückgabeparameter AuthorizationList zurück.
PAR Transformation KVNR nach RecordIdentifier
REQ(ids=A_17177)<b>A_17177 - FM ePA: GetAuthorizationList - Erstellung der RecordIdentifier</b>
PAR Die Operation GetAuthorizationList MUSS aus jeder über I_Authorization_Management::getAuthorizationList erhaltenen KVNR einen vollständigen RecordIdentifier gemäß [gemSpec_DM_ePA] bilden. <br>​​
PAR <b>[<=]</b>

PAR -HEADING(ids=8)8 Anhang A – Verzeichnisse
PAR -HEADING(ids=8.1)8.1 Abkürzungen

TABLE(rows=19,cols=118+611)->
TR-> TH(0,0/1/1)->PAR Kürzel TH(0,1/1/1)->PAR Erläuterung
TR-> TD(1,0/1/1)->PAR APPC TD(1,1/1/1)->PAR Advanced Patient Privacy Consents
TR-> TD(2,0/1/1)->PAR ATNA TD(2,1/1/1)->PAR Audit Trail and Node Authentication Profile
TR-> TD(3,0/1/1)->PAR BPPC TD(3,1/1/1)->PAR Basic Patient Privacy Consents
TR-> TD(4,0/1/1)->PAR CDA TD(4,1/1/1)->PAR Clinical Document Architecture
TR-> TD(5,0/1/1)->PAR HL7 TD(5,1/1/1)->PAR Health Level Seven
TR-> TD(6,0/1/1)->PAR IHE TD(6,1/1/1)->PAR Integrating the Healthcare Enterprise
TR-> TD(7,0/1/1)->PAR IHE ITI TF TD(7,1/1/1)->PAR IHE IT Infrastructure Technical Framework
TR-> TD(8,0/1/1)->PAR PHR TD(8,1/1/1)->PAR Personal Health Record
TR-> TD(9,0/1/1)->PAR SAML TD(9,1/1/1)->PAR Security Assertion Markup Language
TR-> TD(10,0/1/1)->PAR SGD TD(10,1/1/1)->PAR Schlüsselgenerierungsdienst
TR-> TD(11,0/1/1)->PAR VAU TD(11,1/1/1)->PAR Vertrauenswürdige Ausführungsumgebung
TR-> TD(12,0/1/1)->PAR WS-I TD(12,1/1/1)->PAR Web Services Interoperability Organization
TR-> TD(13,0/1/1)->PAR XCA TD(13,1/1/1)->PAR Cross-Community Access Profile
TR-> TD(14,0/1/1)->PAR XDR TD(14,1/1/1)->PAR Cross-Enterprise Document Reliable Interchange Profile
TR-> TD(15,0/1/1)->PAR XDS TD(15,1/1/1)->PAR Cross-Enterprise Document Sharing Profile
TR-> TD(16,0/1/1)->PAR XCDR TD(16,1/1/1)->PAR Cross-Community Document Reliable Interchange Profile
TR-> TD(17,0/1/1)->PAR XACML TD(17,1/1/1)->PAR eXtensible Access Control Markup Language
TR-> TD(18,0/1/1)->PAR XUA TD(18,1/1/1)->PAR Cross-Enterprise User Assertion Profile
PAR -HEADING(ids=8.2)8.2 Glossar

TABLE(rows=7,cols=158+571)->
TR-> TH(0,0/1/1)->PAR Begriff TH(0,1/1/1)->PAR Erläuterung
TR-> TD(1,0/1/1)->PAR Anbieter-ID TD(1,1/1/1)->PAR siehe HomeCommunityID
TR-> TD(2,0/1/1)->PAR AuthenticationAssertion TD(2,1/1/1)->PAR Authentifizierungsbestätigung, die entweder LEI oder Versicherten identifiziert. Im Falle der LEI stellt das Fachmodul ePA die AuthenticationAssertion aus, im Falle des Versicherten die Komponente Zugangsgateway für Versicherte des ePA-Aktensystems.
TR-> TD(3,0/1/1)->PAR AuthorizationAssertion TD(3,1/1/1)->PAR Autorisierungsbestätigung, ausgestellt durch die Komponente Autorisierung, mit der das Fachmodul ePA einen Berechtigten bei der Dokumentenverwaltung autorisieren kann.
TR-> TD(4,0/1/1)->PAR Funktionsmerkmal TD(4,1/1/1)->PAR Der Begriff beschreibt eine Funktion oder auch einzelne, eine logische Einheit bildende Teilfunktionen der TI im Rahmen der funktionalen Zerlegung des Systems.
TR-> TD(5,0/1/1)->PAR HomeCommunityID TD(5,1/1/1)->PAR Eindeutige Kennung für einen Anbieter eines ePA-Aktensystems, Aufbau gemäß [gemSpec_DM_ePA]
TR-> TD(6,0/1/1)->PAR RecordIdentifier TD(6,1/1/1)->PAR Eindeutige Kennung für die Akte eines Versicherten; Aufbau gemäß [gemSpec_DM_ePA]
PAR Weitere Begriffserklärungen befinden sich in [gemGlossar].
PAR -HEADING(ids=8.3)8.3 Abbildungsverzeichnis

<PLACEHOLDER>

PAR -HEADING(ids=8.4)8.4 Tabellenverzeichnis

<PLACEHOLDER>

PAR -HEADING(ids=8.5)8.5 Referenzierte Dokumente
PAR -HEADING(ids=8.5.1)8.5.1 Dokumente der gematik
PAR Die nachfolgende Tabelle enthält die Bezeichnung der in dem vorliegenden Dokument referenzierten Dokumente der gematik zur Telematikinfrastruktur. Der mit der vorliegenden Version korrelierende Entwicklungsstand dieser Konzepte und Spezifikationen wird pro Release in einer Dokumentenlandkarte definiert; Version und Stand der referenzierten Dokumente sind daher in der nachfolgenden Tabelle nicht aufgeführt. Deren zu diesem Dokument jeweils gültige Versionsnummern sind in der aktuellen, von der gematik veröffentlichten Dokumentenlandkarte enthalten, in der die vorliegende Version aufgeführt wird.

TABLE(rows=13,cols=246+483)->
TR-> TH(0,0/1/1)->PAR [Quelle] TH(0,1/1/1)->PAR Herausgeber: Titel
TR-> TD(1,0/1/1)->PAR [gemGlossar] TD(1,1/1/1)->PAR gematik: Einführung der Gesundheitskarte - Glossar
TR-> TD(2,0/1/1)->PAR [gemSpec_Aktensystem] TD(2,1/1/1)->PAR gematik: Spezifikation ePA-Aktensystem
TR-> TD(3,0/1/1)->PAR [gemSpec_Authentisierung_Vers] TD(3,1/1/1)->PAR gematik: Spezifikation Authentisierung des Versicherten ePA
TR-> TD(4,0/1/1)->PAR [gemSpec_Autorisierung] TD(4,1/1/1)->PAR gematik: Spezifikation Autorisierung ePA
TR-> TD(5,0/1/1)->PAR [gemSpec_DM_ePA] TD(5,1/1/1)->PAR gematik: Datenmodell ePA
TR-> TD(6,0/1/1)->PAR [gemSpec_FM_ePA] TD(6,1/1/1)->PAR gematik: Spezifikation Fachmodul ePA
TR-> TD(7,0/1/1)->PAR [gemSpec_eGK_ObjSys]<br>[gemSpec_eGK_ObjSys_G2_1] TD(7,1/1/1)->PAR gematik: Spezifikation der elektronischen Gesundheitskarte<br>eGK-Objektsystem
TR-> TD(8,0/1/1)->PAR [gemSpec_OID] TD(8,1/1/1)->PAR gematik: Spezifikation Festlegung von OIDs
TR-> TD(9,0/1/1)->PAR [gemSpec_OM] TD(9,1/1/1)->PAR gematik: Übergreifende Spezifikation Operations und Maintenance
TR-> TD(10,0/1/1)->PAR [gemSysL_ePA] TD(10,1/1/1)->PAR gematik: Systemspezifisches Konzept ePA
TR-> TD(11,0/1/1)->PAR [gemSpec_Krypt] TD(11,1/1/1)->PAR gematik: Übergreifende Spezifikation - Verwendung kryptographischer Algorithmen in der Telematikinfrastruktur
TR-> TD(12,0/1/1)->PAR [gemSpec_SGD_ePA] TD(12,1/1/1)->PAR gematik: SpezifikationSchlüsselgenerierungsdienst ePA
PAR -HEADING(ids=8.5.2)8.5.2 Weitere Dokumente

TABLE(rows=20,cols=100+629)->
TR-> TH(0,0/1/1)->PAR [Quelle] TH(0,1/1/1)->PAR Herausgeber (Erscheinungsdatum): Titel
TR-> TD(1,0/1/1)->PAR [IHE-ITI-ACWP] TD(1,1/1/1)->PAR IHE International (2009): IHE IT Infrastructure White Paper Access Control Revision 1.3, <br>http://www.ihe.net/Technical_Framework/upload/IHE_ITI_TF_WhitePaper_AccessControl_2009-09-28.pdfhttp://www.ihe.net/Technical_Framework/upload/IHE_ITI_TF_WhitePaper_AccessControl_2009-09-28.pdf
TR-> TD(2,0/1/1)->PAR [IHE-ITI-APPC] TD(2,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework Supplement, Advanced Patient Privacy Consents (APPC), Revision 1.2 – Trial Implementation,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_APPC.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_APPC.pdf
TR-> TD(3,0/1/1)->PAR [IHE-ITI-DEN] TD(3,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework Supplement, Document Encryption (DEN), Revision 1.3 – Trial Implementation,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_DEN.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_DEN.pdf
TR-> TD(4,0/1/1)->PAR [IHE-ITI-RMD] TD(4,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework Supplement, Remove Metadata and Documents (RMD), Revision 1.2 – Trial Implementation,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RMD.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RMD.pdf
TR-> TD(5,0/1/1)->PAR [IHE-ITI-SeR] TD(5,1/1/1)->PAR IHE International (2016): IHE IT Infrastructure (ITI) Technical Framework Supplement, Secure Retrieve (SeR), Trial Implementation Revision 1.3, <br>http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_SeR.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_SeR.pdf
TR-> TD(6,0/1/1)->PAR [IHE_SHRD_GL] TD(6,1/1/1)->PAR IHE International (2018): IHE Technical Frameworks, General Introduction, Appendix D: Glossary, Revision 2.0,  https://www.ihe.net/uploadedFiles/Documents/Templates/IHE_TF_GenIntro_AppD_Glossary_Rev2.0_2018-03-09.pdfhttps://www.ihe.net/uploadedFiles/Documents/Templates/IHE_TF_GenIntro_AppD_Glossary_Rev2.0_2018-03-09.pdf 
TR-> TD(7,0/1/1)->PAR [IHE-ITI-TF] TD(7,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework, Revision 15.0
TR-> TD(8,0/1/1)->PAR [IHE-ITI-TF1] TD(8,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework, Volume 1 (ITI TF-1) – Integration Profiles, Revision 15.0,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol1.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol1.pdf
TR-> TD(9,0/1/1)->PAR [IHE-ITI-TF2a] TD(9,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework, Volume 2a (ITI TF-2a) – Transactions Part A, Revision 15.0,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol2a.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol2a.pdf
TR-> TD(10,0/1/1)->PAR [IHE-ITI-TF2b] TD(10,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework, Volume 2b (ITI TF-2b) – Transactions Part B, Revision 15.0,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol2b.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol2b.pdf
TR-> TD(11,0/1/1)->PAR [IHE-ITI-TF2x] TD(11,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework, Volume 2x (ITI TF-2b) – Volume 2 Appendices, Revision 15.1,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol2x.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol2x.pdf
TR-> TD(12,0/1/1)->PAR [IHE-ITI-TF3] TD(12,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework, Volume 3 (ITI TF-3) – Cross-Transaction Specifications and Content Specifications, Revision 15.0,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol3.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_TF_Vol3.pdf
TR-> TD(13,0/1/1)->PAR [IHE-ITI-VS]  TD(13,1/1/1)->PAR IHE Deutschland (2018): Value Sets für Aktenprojekte im deutschen Gesundheitswesen, Implementierungsleitfaden, Version 2.0,  http://www.ihe-d.de/download/ihe-valuesets-v2-0/http://www.ihe-d.de/download/ihe-valuesets-v2-0/ 
TR-> TD(14,0/1/1)->PAR [IHE-ITI-XCDR] TD(14,1/1/1)->PAR IHE International (2017): IHE IT Infrastructure (ITI) Technical Framework Supplement, Cross-Community Document Reliable Interchange (XCDR), Revision 1.4 – Trial Implementation,  http://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_XCDR.pdfhttp://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_XCDR.pdf
TR-> TD(15,0/1/1)->PAR [IHE-ITI-RMU] TD(15,1/1/1)->PAR IHE International (2018): IHE IT Infrastructure (ITI) Technical Framework Supplement, Restricted Metadata Update (RMU), Revision 1.1 – Trial Implementation,  https://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RMU.pdfhttps://www.ihe.net/uploadedFiles/Documents/ITI/IHE_ITI_Suppl_RMU.pdf 
TR-> TD(16,0/1/1)->PAR [KVNR] TD(16,1/1/1)->PAR Vertrauensstelle Krankenversichertennummer<br>https://www.itsg.de/gkv-interne-services/vertrauensstelle-kvnr/https://www.itsg.de/gkv-interne-services/vertrauensstelle-kvnr/
TR-> TD(17,0/1/1)->PAR [RFC2119] TD(17,1/1/1)->PAR IETF (1997): Key words for use in RFCs to Indicate Requirement Levels, RFC 2119, http://tools.ietf.org/html/rfc2119http://tools.ietf.org/html/rfc2119
TR-> TD(18,0/1/1)->PAR [SOAP1.2]  TD(18,1/1/1)->PAR W3C (2007): SOAP Version 1.2 Part 1: Messaging Framework (Second Edition),  https://www.w3.org/TR/soap12-part1/https://www.w3.org/TR/soap12-part1/ 
TR-> TD(19,0/1/1)->PAR [WSS-SAML] TD(19,1/1/1)->PAR OASIS (2006): Web Services Security: SAML Token Profile 1.1,  https://www.oasis-open.org/committees/download.php/16768/wss-v1.1-spec-os-SAMLTokenProfile.pdfhttps://www.oasis-open.org/committees/download.php/16768/wss-v1.1-spec-os-SAMLTokenProfile.pdf 
